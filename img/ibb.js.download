var PF={fn:{},str:{},obj:{}},width=(PF.obj.config={base_url:"",json_api:"/json/",listing:{items_per_page:24},animation:{easingFn:"ease",normal:400,fast:250}},PF.obj.l10n={},PF.fn._s=function(e,t){return e=void 0!==e&&(e=(e=void 0!==PF.obj.l10n&&void 0!==PF.obj.l10n[e]?PF.obj.l10n[e][0]:e).toString(),void 0!==t)?sprintf(e,t):e},PF.fn._n=function(e,t,o){t=void 0!==PF.obj.l10n&&void 0!==PF.obj.l10n[e]?PF.obj.l10n[e][1==o?0:1]:1==o?e:t;return t=void 0===t?e:t.toString(),t=void 0!==o?sprintf(t,o):t},PF.fn.extend_lang=function(o){$.each(PF.obj.lang_strings,function(e,t){void 0!==o[e]&&$.extend(PF.obj.lang_strings[e],o[e])})},PF.fn.get_url_vars=function(){function e(e){return decodeURIComponent(escape(e.replace(o," ")))}for(var t,o=/\+/g,i=/([^&=]+)=?([^&]*)/g,n=window.location.search.substring(1),a={};t=i.exec(n);)a[e(t[1])]=e(t[2]);return a},PF.fn.get_url_var=function(e){return PF.fn.get_url_vars()[e]},PF.fn.is_user_logged=function(){return $("#top-bar-user").exists()},PF.fn.generate_random_string=function(e){void 0===e&&(e=5);for(var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<e;i++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},PF.fn.getDateTime=function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1,i=e.getDate(),n=e.getHours(),a=e.getMinutes(),e=e.getSeconds();return t+"-"+(o=1==o.toString().length?"0"+o:o)+"-"+(i=1==i.toString().length?"0"+i:i)+" "+(n=1==n.toString().length?"0"+n:n)+":"+(a=1==a.toString().length?"0"+a:a)+":"+(e=1==e.toString().length?"0"+e:e)},PF.fn.htmlEncode=function(e){return $("<div/>").text($.trim(e)).html()},PF.fn.htmlDecode=function(e){return $("<div/>").html($.trim(e)).text()},PF.fn.nl2br=function(e){return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2")},PF.fn.baseName=function(e){e=new String(e).substring(e.lastIndexOf("/")+1);return e=-1!=e.lastIndexOf(".")?e.substring(0,e.lastIndexOf(".")):e},PF.fn.ext=function(e){e=new String(e).substring(e.lastIndexOf("/")+1);return(e=-1!=e.lastIndexOf(".")?e.substring(e.lastIndexOf(".")+1):e).toLowerCase()},PF.fn.guid=function(){var o=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(o+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(o+16*Math.random())%16|0;return o=Math.floor(o/16),("x"===e?t:3&t|8).toString(16)})},PF.fn.md5=function(e){for(var t=0,o=0,i=e.length;o<i;)t=(t<<5)-t+e.charCodeAt(o++)<<0;return t},PF.fn.dataURItoBlob=function(e){for(var t=(0<=e.split(",")[0].indexOf("base64")?atob:unescape)(e.split(",")[1]),e=e.split(",")[0].split(":")[1].split(";")[0],o=new Uint8Array(t.length),i=0;i<t.length;i++)o[i]=t.charCodeAt(i);return new Blob([o],{type:e})},PF.fn.clean_facebook_hash=function(){"#_=_"==window.location.hash&&(window.location.hash="")},PF.fn.clean_facebook_hash(),Object.size=function(e){var t,o=0;for(t in e)e.hasOwnProperty(t)&&o++;return o},Object.flatten=function(e,o){void 0===o&&(o="");var i={};return $.each(e,function(e,t){t&&("object"==typeof t?i=$.extend({},i,Object.flatten(t,o+e+"_")):i[o+e]=t)}),i},String.prototype.isNumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)},String.prototype.repeat=function(e){return new Array(e+1).join(this)},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.isEmail=function(){return/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this)},String.prototype.match_image_urls=function(){return this.match(/\b(?:(http[s]?|ftp[s]):\/\/)?([^:\/\s]+)(:[0-9]+)?((?:\/\w+)*\/)([\w\-\.]+[^#?\s]+)([^#\s]*)?(#[\w\-]+)?\.(?:jpe?g|gif|png|bmp|webp|heic|heif|avif|pdf|tif?f)\b/gim)},String.prototype.match_urls=function(){return this.match(/\b(?:(http[s]?|ftp[s]):\/\/)?([^:\/\s]+)(:[0-9]+)?((?:\/\w+)*\/)([\w\-\.]+[^#?\s]+)([^#\s\b]*)?(#[\w\-]+)?/gim)},"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,t){(t=void 0===t?0:t)<0&&(t+=this.length),t<0&&(t=0);for(var o=this.length;t<o;t++)if(t in this&&this[t]===e)return t;return-1}),Array.prototype.array_unique=function(){var o=[];return $.each(this,function(e,t){-1==$.inArray(t,o)&&o.push(t)}),o},PF.fn.deparam=function(e){if(void 0!==e&&e){for(var t={},o=(e=e.substring(e.indexOf("?")+1)).replace(/^[\?|&]*/,"").replace(/[&|\?]*$/,"").split("&"),i=0;i<o.length;i++){var n=o[i].split("="),a=decodeURIComponent(n[0]),n=n[1]?decodeURIComponent(n[1]):null;t.hasOwnProperty(a)&&!n||(t[a]=n)}return t}},String.prototype.removeURLParameter=function(e){var t=PF.fn.deparam(this);return void 0!==t[e]&&delete t[e],decodeURIComponent($.param(t))},String.prototype.changeURLParameterValue=function(e,t){var o=this.substring(0,this.indexOf("?")),i=PF.fn.deparam(this);return void 0!==i[e]&&(i[e]=t),o+"?"+decodeURIComponent($.param(i))},String.prototype.truncate_middle=function(e){var t=(e=void 0!==e?e:40)/2,o=this.replace(/https?:\/\//g,"");return o.length<=e?o:i(o,t,!1)+"..."+i(o,t,!0);function i(e,t,o){for(var i=[" ","/","&"],n=.8*t,e=(o=void 0!==o&&o)?e.split("").reverse().join(""):e,a="",s=0;s<t-1&&(a+=e[s],!(n<=s&&0<=i.indexOf(e[s])));s++);return o?a.split("").reverse().join(""):a}},jQuery.fn.exists=function(){return 0<this.length},jQuery.fn.replace_svg=function(){this.attr("src")&&$(this).each(function(){$(this).attr("src",$(this).attr("src").replace(".svg",".png"))})},jQuery.fn.is_fluid=function(){return!0},jQuery.fn.bindFormData=function(){return $(":input",this).each(function(){var e,t,o=PF.fn.htmlEncode($(this).val());$(this).is("input")&&(this.setAttribute("value",this.value),this.checked?this.setAttribute("checked","checked"):this.removeAttribute("checked")),$(this).is("textarea")&&$(this).html(o),$(this).is("select")&&(e=this.selectedIndex,t=0,$(this).children("option").each(function(){t++!=e?this.removeAttribute("selected"):this.setAttribute("selected","selected")}))}),this},jQuery.fn.formValues=function(e){var t=$(":input",this);return"object"!=typeof e?(e={},$.each(t,function(){this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/color|date|datetime|datetime-local|email|month|range|search|tel|time|url|week|text|number|hidden|password/i.test(this.type))&&(this.name.match(/^.*\[\]$/)&&this.checked?(void 0===e[this.name]&&(e[this.name]=[]),e[this.name].push($(this).val())):e[this.name]=$(this).val())}),e):($.each(t,function(){this.name.match(/^.*\[\]$/)&&"object"==typeof e[this.name]?$(this).prop("checked",-1!==e[this.name].indexOf($(this).val())):this.name&&e[this.name]?/checkbox|radio/i.test(this.type)?$(this).prop("checked",e[this.name]==$(this).val()):$(this).val(e[this.name]):/checkbox|radio/i.test(this.type)&&$(this).removeProp("checked")}),$(this))},jQuery.Event.prototype.keydown_numeric=function(){var e,t,o=this;return o.shiftKey?(o.preventDefault(),!1):(e=o.charCode||o.keyCode,t=o.target,""==$(t).val()||parseInt($(t).val()),13==e||46==e||8==e||9==e||27==e||65==e&&!0===o.ctrlKey||35<=e&&e<=40||void((e<48||57<e)&&(e<96||105<e)&&o.preventDefault()))},PF.fn.getScrollBarWidth=function(){var e=document.createElement("p"),t=(e.style.width="100%",e.style.height="200px",document.createElement("div")),o=(t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t),e.offsetWidth),e=(t.style.overflow="scroll",e.offsetWidth);return o==e&&(e=t.clientWidth),document.body.removeChild(t),o-e},PF.str.ScrollBarWidth=PF.fn.getScrollBarWidth(),PF.fn.top_notifications_viewed=function(){var e=$("[data-action=top-bar-notifications]"),t=($(".top-bar-notifications-list",e),$(".top-btn-number",e));$(".persistent",e).exists()?t.text($(".persistent",e).length).addClass("on"):t.removeClass("on")},PF.fn.bindtipTip=function(e,t){(e=void 0===e?$("body"):e)instanceof jQuery==0&&(e=$(e));var o={delay:0,content:!1,fadeIn:0};void 0!==t&&(void 0!==t.delay&&(o.delay=t.delay),void 0!==t.content&&(o.content=t.content),void 0!==t.content)&&(o.fadeIn=t.fadeIn),(e="tooltip"!==e.attr("rel")?$("[rel=tooltip]",e):e).each(function(){if((void 0!==$(this).attr("href")||void 0!==$(this).data("href"))&&PF.fn.isDevice(["phone","phablet","tablet"]))return!0;var e=void 0===$(this).data("tiptip")?"bottom":$(this).data("tiptip");PF.fn.isDevice(["phone","phablet"])&&(e="top"),$(this).tipTip({delay:o.delay,defaultPosition:e,content:o.content,fadeIn:o.fadeIn,fadeOut:0})})},PF.fn.form_modal_has_changed=function(){if(!$(PF.obj.modal.selectors.root).is(":hidden")&&void 0!==$("html").data("modal-form-values")){var e,t=$("html").data("modal-form-values"),o=PF.fn.deparam($(":input:visible",PF.obj.modal.selectors.root).serialize()),i=!1;for(e in $.extend({},t,o))if(t[e]!==o[e]){i=!0;break}return i}},PF.fn.is_listing=function(){return $(PF.obj.listing.selectors.content_listing).exists()},PF.fn.is_tabs=function(){return $(".content-tabs").exists()},jQuery.fn.shake=function(e){return this.each(function(e){var t=$(this);t.addClass("animate shake").promise().done(function(){setTimeout(function(){t.removeClass("shake")},820)})}),"function"==typeof e&&e(),this},jQuery.fn.highlight=function(e){if(!this.is(":animated")&&this.exists()){var t=e=void 0===e?"yellow":e;switch(e){case"yellow":t="#FFFBA2";break;case"red":t="#FF7F7F";break;default:t=e}var o=$(this).css("background-color");$(this).css("background");$(this).css({background:"",backgroundColor:t}).animate({backgroundColor:o},800,function(){$(this).css("background","")})}return this},jQuery.fn.pf_slideDown=function(o,i){var n,a,s,r=$(this).length;return"function"==typeof o&&(i=o,o="normal"),void 0===o&&(o="normal"),$(this).each(function(e){var t=parseInt($(this).css("top")),t=0<t?t:0;s=(0==o?(n={display:"block",opacity:0},a={opacity:1},jQuery.speed("fast")):(n={top:-$(this).outerHeight(!0),opacity:1,display:"block"},a={top:t},jQuery.speed(o))).duration,$(this).data("originalTop",$(this).css("top")),$(this).css(n).animate(a,s,function(){e==r-1&&"function"==typeof i&&i()})}),this},jQuery.fn.is_in_viewport=function(){var e=$(this)[0].getBoundingClientRect();return 0<=e.top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},jQuery.fn.is_within_viewport=function(e){var t=$(this)[0].getBoundingClientRect();return void 0===e&&(e=0),0<=t.top&&0<=t.left&&t.top+e<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},jQuery.fn.getWindowCutoff=function(){var e,t={top:$(this).offset().top,left:$(this).offset().left,width:$(this).outerWidth(),height:$(this).outerHeight()},o=(t.right=t.left+t.width,t.bottom=t.top+t.height,!1),i={top:0<t.top?0:t.top,right:document.body.clientWidth-t.right,bottom:document.body.clientHeight-t.bottom,left:0<t.left?0:t.left};for(e in i)i[e]<0?o=!0:i[e]=0;return o?i:null},PF.fn.scroll=function(e,t){"function"==typeof e&&(t=e,e="");var o=parseInt($("body").css("margin-top"));0==o&&$(".top-bar-placeholder").exists()&&(o=$(".top-bar-placeholder").height()),$(e).exists()||(e="html"),$("body,html").animate({scrollTop:$(e).offset().top-o},"normal",function(){"function"==typeof t&&t()})},PF.fn.close_pops=function(e){$(".pop-box:visible").each(function(){$(this).closest(".pop-btn").click()})},PF.fn.growl={selectors:{root:"#growl"},str:{timeout:null,timeoutcall:!1},call:function(e){if(void 0!==e&&void 0!==(e="string"==typeof e?{message:e}:e).message){var t,o,i,n={message:e.message,insertTo:"body",where:"before",color:"default",css:{},classes:"",expires:0,callback:function(){}};for(key in n)void 0===e[key]||key.match("/^(callback)$/")&&"function"!=typeof e[key]||(n[key]=e[key]);if($(n.insertTo).exists()||(n.insertTo="body"),$(PF.fn.growl.selectors.root).exists()){if($(PF.fn.growl.selectors.root).text()==n.message)return void $(PF.fn.growl.selectors.root).shake();$(PF.fn.growl.selectors.root).remove()}t=$('<div id="'+PF.fn.growl.selectors.root.replace("#","")+'" class="growl animated">'+n.message+'<span class="icon icon-xmark" data-action="close"></span></div>').css(n.css).addClass(n.classes),o="body"!==n.insertTo?"static":"",i="dark"===n.color?"dark":"",t.addClass(o+" "+i),"before"==n.where?$(n.insertTo).prepend(t.hide()):$(n.insertTo).append(t.hide()),$(".fullscreen").is(":visible")&&t.css({"z-index":parseInt($(".fullscreen").css("z-index"))+1}),t.pf_slideDown("static"==o?0:200,function(){"function"==typeof n.callback&&n.callback()}),$(document).on("click",".growl",function(e){(PF.fn.isDevice(["phone","phablet"])||$(e.target).is("[data-action=close]"))&&PF.fn.growl.close(!0)}),0<n.expires&&("number"==typeof this.str.timeout&&clearTimeout(this.str.timeout),this.str.timeout=setTimeout(function(){PF.fn.growl.str.timeoutcall=!0,PF.fn.growl.close()},n.expires))}},expirable:function(e,t){void 0!==e&&PF.fn.growl.call({message:e,expires:t=void 0===t?5e3:t})},close:function(e,t){var o=$(PF.fn.growl.selectors.root);e&&(this.str.timeout=null,this.str.timeoutcall=!1,clearTimeout(this.str.timeout)),o.exists()&&("number"!=typeof this.str.timeout||this.str.timeoutcall)&&o.fadeOut("fast",function(){$(this).remove(),"function"==typeof t&&t()})}},PF.obj.modal={type:"",selectors:{root:"#fullscreen-modal",box:"#fullscreen-modal-box",body:"#fullscreen-modal-body",login:"[data-modal=login]",changes_confirm:"#fullscreen-changes-confirm",btn_container:".btn-container",close_buttons:".close-modal,.cancel-modal,[data-action=cancel],[data-action-close]",submit_button:"[data-action=submit]",growl_placeholder:"#fullscreen-growl-placeholder"},ajax:{url:"",deferred:{}},locked:!1,form_data:{},XHR:{},prevented:!1},PF.obj.modal.$close_buttons=$(PF.obj.modal.selectors.close_buttons,PF.obj.modal.selectors.root),PF.obj.modal.$submit_button=$(PF.obj.modal.selectors.submit_button,PF.obj.modal.selectors.root),PF.fn.modal={str:{transition:"all "+PF.obj.config.animation.fast+"ms ease"},call:function(t){var n,e;if(void 0!==t&&(void 0!==t.template&&void 0===t.type&&(t.type="html"),void 0!==t.title&&void 0!==t.message||"login"===t.type||"html"===t.type)){for(key in PF.fn.growl.close(),n={forced:!1,type:"confirm",title:t.title,message:t.message,html:!1,template:t.template,buttons:!0,button_submit:PF.fn._s("Submit"),txt_or:PF.fn._s("or"),button_cancel:PF.fn._s("cancel"),ajax:{url:null,data:null,deferred:{}},confirm:function(){},cancel:function(){PF.fn.modal.close()},load:function(){},callback:function(){}})void 0===t[key]||/^cancel|confirm|callback$/.test(key)&&"function"!=typeof t[key]||(n[key]=t[key]);void 0!==t.ajax&&!t.ajax.url&&t.ajax.deferred&&(n.ajax.url=PF.obj.config.json_api),"login"==n.type&&(n.buttons=!1),"confirm"==n.type&&(n.button_submit=PF.fn._s("Confirm"));var o,i=['<div id="',PF.obj.modal.selectors.root.replace("#",""),'"class="fullscreen black"><div id="',PF.obj.modal.selectors.box.replace("#",""),'"class="clickable"><div id="',PF.obj.modal.selectors.body.replace("#",""),'">%MODAL_BODY%</div>%MODAL_BUTTONS%<span class="close-modal icon--close icon-xmark" data-action="close-modal"></span></div></div>'].join(""),a=n.buttons?['<div class="',PF.obj.modal.selectors.btn_container.replace(".",""),'"><button class="btn btn-input default" data-action="submit" type="submit">',n.button_submit,"</button></div>"].join(""):"";switch("login"==n.type&&(n.template=void 0===n.template?$(PF.obj.modal.selectors.login).html():n.template),n.type){case"html":case"login":o=n.template;break;default:e=n.message,n.html||(e="<p>"+e+"</p>"),o="<h1>"+n.title+"</h1>"+e}void 0===o?console.log("PF Error: Modal content is empty"):(i=i.replace("%MODAL_BODY%",o).replace("%MODAL_BUTTONS%",a).replace(/template-tooltip/g,"tooltip"),$(PF.obj.modal.selectors.root).remove(),$("body").data("hasOverflowHidden",$("body").hasClass("overflow-hidden")&&!$("body").hasClass("pop-box-show")),$("body").prepend(i).addClass("overflow-hidden"),this.fixScrollbars(),$("[rel=tooltip]",PF.obj.modal.selectors.root).each(function(){PF.fn.bindtipTip(this,{content:$(this).data("title")})}),0<$(":button, input[type=submit], input[type=reset]",PF.obj.modal.selectors.root).length&&((a=$("form",PF.obj.modal.selectors.root)).exists()?(a.append($($(PF.obj.modal.selectors.btn_container,PF.obj.modal.selectors.root).html()).wrapInner(PF.obj.modal.selectors.btn_container.replace(".",""))),$(PF.obj.modal.selectors.btn_container,PF.obj.modal.selectors.root).each(function(){$(this).closest("form").exists()||$(this).remove()})):$(PF.obj.modal.selectors.box,PF.obj.modal.selectors.root).wrapInner("<form />")),n.callback(),$(PF.obj.modal.selectors.box).css({transform:"scale(0.7)",opacity:0,transition:PF.fn.modal.str.transition}),$(PF.obj.modal.selectors.root).addClass("--show"),setTimeout(function(){$(PF.obj.modal.selectors.root).css({opacity:1}),$(PF.obj.modal.selectors.box).css({transform:"scale(1)",opacity:1}),"undefined"!=typeof PFrecaptchaCallback&&PFrecaptchaCallback(),setTimeout(function(){$("html").data("modal-form-values",PF.fn.deparam($(":input:visible",PF.obj.modal.selectors.root).serialize())),"function"==typeof n.load&&n.load()},PF.obj.config.animation.fast)},1),$(PF.obj.modal.selectors.root).click(function(e){var i,e=$(e.target);PF.obj.modal.locked||(e.closest(PF.obj.modal.selectors.changes_confirm).exists()&&(e.is(PF.obj.modal.selectors.close_buttons)||e.is(PF.obj.modal.selectors.submit_button))?($(PF.obj.modal.selectors.changes_confirm).remove(),e.is(PF.obj.modal.selectors.close_buttons)?$(PF.obj.modal.selectors.box,this).fadeIn("fast",function(){$(this).css("transition",PF.fn.modal.str.transition)}):PF.fn.modal.close()):(e.closest(".clickable").exists()&&!e.is(PF.obj.modal.selectors.close_buttons)||(PF.fn.growl.close(),n.cancel()),e.is(PF.obj.modal.selectors.submit_button)&&!1!==n.confirm()&&(e=!0,e=!(0<$("input, textarea, select",PF.obj.modal.selectors.root).not(":input[type=button], :input[type=submit], :input[type=reset]").length&&!PF.fn.form_modal_has_changed()&&!n.forced)&&e)&&(n.ajax.url?(i=$(PF.obj.modal.selectors.btn_container,PF.obj.modal.selectors.root),PF.obj.modal.locked=!0,i.first().clone().height(i.height()).html("").addClass("loading").appendTo(PF.obj.modal.selectors.root+" form"),i.hide(),PF.obj.modal.$close_buttons.hide(),e="edit"===PF.obj.modal.type?PF.fn._s("Saving"):PF.fn._s("Sending"),PF.fn.loading.inline($(PF.obj.modal.selectors.btn_container+".loading",PF.obj.modal.selectors.root),{size:"small",message:e,valign:"center"}),$(PF.obj.modal.selectors.root).disableForm(),$.isEmptyObject(PF.obj.modal.form_data)&&(void 0===t.ajax||void 0!==t.ajax.data)||(n.ajax.data=PF.obj.modal.form_data),PF.obj.modal.XHR=$.ajax({url:n.ajax.url,type:"POST",data:n.ajax.data}).complete(function(e){var t,o;PF.obj.modal.locked=!1,200==e.status?"function"==typeof(t=void 0!==n.ajax.deferred&&void 0!==n.ajax.deferred.success?n.ajax.deferred.success:null)?PF.fn.modal.close(function(){"function"==typeof t&&t(e)}):"object"==typeof t&&("function"==typeof t.before&&t.before(e),"function"==typeof t.done)&&t.done(e):($(PF.obj.modal.selectors.root).enableForm(),$(PF.obj.modal.selectors.btn_container+".loading",PF.obj.modal.selectors.root).remove(),i.css("display",""),void 0!==n.ajax.deferred&&"function"==typeof n.ajax.deferred.error?n.ajax.deferred.error(e):(o=PF.fn._s("An error occurred. Please try again later."),e.responseJSON.error.message&&(o=e.responseJSON.error.message),PF.fn.growl.call(o)))})):PF.fn.modal.close(n.callback()))))}))}},confirm:function(e){e.type="confirm",void 0===e.title&&(e.title=PF.fn._s("Confirm action")),PF.fn.modal.call(e)},simple:function(e){void 0===(e="string"==typeof e?{message:e}:e).buttons&&(e.buttons=!1),void 0===e.title&&(e.title=PF.fn._s("information")),PF.fn.modal.call(e)},fixScrollbars:function(){var e,t;$(PF.obj.modal.selectors.root).exists()&&(e={padding:$(".fixed, .position-fixed"),margin:$("html")},t={},0<PF.str.ScrollBarWidth&&$("html").hasScrollBar().vertical&&!$("body").data("hasOverflowHidden")?(t.padding=PF.str.ScrollBarWidth+"px",t.margin=PF.str.ScrollBarWidth+"px"):(t.padding="",t.margin=""),e.padding.css({paddingRight:t.padding}),e.margin.css({marginRight:t.margin}))},close:function(e){$(PF.obj.modal.selectors.root).exists()&&(PF.fn.growl.close(!0),$("[rel=tooltip]",PF.obj.modal.selectors.root).tipTip("hide"),$(PF.obj.modal.selectors.box).css({transform:"scale(0.5)",opacity:0}),$(PF.obj.modal.selectors.root).css({opacity:0}),setTimeout(function(){0<PF.str.ScrollBarWidth&&$("html").hasScrollBar().vertical&&$(".fixed, .position-fixed").css({paddingRight:""}),$("html").css({marginRight:""}),$("body").data("hasOverflowHidden")||$("body").removeClass("overflow-hidden"),$("body").removeData("hasOverflowHidden"),$(PF.obj.modal.selectors.root).remove(),"function"==typeof e&&e()},PF.obj.config.animation.normal))}},PF.fn.popup=function(e){var t,o={height:e.height||500,width:e.width||650,scrollTo:0,resizable:0,scrollbars:0,location:0},i=(o.top=screen.height/2-o.height/2,o.left=screen.width/2-o.width/2,"");for(t in o)i+=t+"="+o[t]+",";i=i.slice(0,-1),window.open(e.href,"Popup",i)},PF.fn.list_fluid_width=function(){var e,t,o,i,n;$("body").is_fluid()&&(e=$(PF.obj.listing.selectors.content_listing_visible),t=$(PF.obj.listing.selectors.pad_content,e),i=(o=$(PF.obj.listing.selectors.list_item,e)).outerWidth(!0),n=o.outerWidth(!0)-o.width(),PF.obj.listing.content_listing_ratio=parseInt((e.width()+n)/i),o.length<PF.obj.listing.content_listing_ratio)&&t.css("width","100%")},PF.obj.tabs={hashdata:{}},PF.fn.show_tab=function(e){var t;void 0!==e&&(e=$("a[data-tab="+e+"]",".content-tabs"),$("li",e.closest("ul")).removeClass("current"),e.closest("li").addClass("current"),t=$("#tabbed-content-group"),$target=$("#"+e.data("tab")),$(".tabbed-content",t).removeClass("visible").hide(),$($target,t).addClass("visible").show(),$("[data-content=list-selection]").addClass("hidden"),$("[data-content=list-selection][data-tab="+e.data("tab")+"]").removeClass("hidden"),t.exists()&&(e=$(PF.obj.listing.selectors.list_item+":not(.jsly)",$target),t=!$target.hasClass("jsly"),"ajax"!=$target.data("load")||"true"===$target.data("empty")||$(PF.obj.listing.selectors.list_item,$target).exists()?(PF.fn.listing.queryString.stock_current(),PF.fn.listing.columnizer(!1,0,!1),e[t?"fadeIn":"show"]()):(PF.fn.listing.queryString.stock_load(),$target.html(PF.obj.listing.template.fill),PF.fn.loading.inline($(PF.obj.listing.selectors.content_listing_loading,$target)),PF.fn.listing.queryString.stock_new(),PF.fn.listing.ajax())),PF.fn.listing.columnizerQueue(),1==$(PF.obj.listing.selectors.content_listing_visible).data("queued"))&&PF.fn.listing.columnizer(!0,0)},PF.obj.listing={columns:"",columns_number:1,current_column:"",XHR:{},query_string:PF.fn.get_url_vars(),calling:!1,content_listing_ratio:1,selectors:{sort:".sort-listing .current [data-sort]",content_listing:".content-listing",content_listing_visible:".content-listing:visible",content_listing_loading:".content-listing-loading",content_listing_load_more:".content-listing-more",content_listing_pagination:".content-listing-pagination",empty_icon:".icon.icon-inbox",pad_content:".pad-content-listing",list_item:".list-item"},template:{fill:$("[data-template=content-listing]").html(),empty:$("[data-template=content-listing-empty]").html(),loading:$("[data-template=content-listing-loading]").html()}},PF.fn.listing={},PF.fn.listing.show=function(e,t){$content_listing=$("#content-listing-tabs").exists()?$(PF.obj.listing.selectors.content_listing_visible,"#content-listing-tabs"):$(PF.obj.listing.selectors.content_listing),PF.fn.loading.inline(PF.obj.listing.selectors.content_listing_loading);var o=$(PF.obj.listing.selectors.list_item,$content_listing),e=((void 0!==e&&$(e.html).length<PF.obj.config.listing.items_per_page||$(PF.obj.listing.selectors.list_item,$content_listing).length<PF.obj.config.listing.items_per_page)&&PF.fn.listing.removeLoader($content_listing),!$(PF.obj.listing.selectors.content_listing_pagination,$content_listing).is("[data-type=classic]")&&$("[data-action=load-more]",$content_listing).exists()||$(PF.obj.listing.selectors.content_listing_loading,$content_listing).remove(),PF.fn.listing.columnizer(!1,0),o.show(),PF.fn.listing.columnizer(!0,0),o.addClass("--show"),PF.obj.listing.calling=!1,$(PF.obj.listing.selectors.content_listing_loading,$content_listing).exists()&&$(PF.obj.listing.selectors.content_listing_loading,$content_listing).is_in_viewport());PF.obj.listing.show_load_more,PF.obj.listing.show_load_more=e,$(PF.obj.listing.selectors.content_listing_loading,$content_listing)[(e?"add":"remove")+"Class"]("hidden"),$(PF.obj.listing.selectors.content_listing_load_more,$content_listing)[PF.obj.listing.show_load_more?"show":"hide"](),PF.obj.listing.lockClickMore&&(PF.obj.listing.lockClickMore=!1),"function"==typeof t&&t()},PF.fn.listing.removeLoader=function(o){var e=[PF.obj.listing.selectors.content_listing_load_more,PF.obj.listing.selectors.content_listing_loading];$(PF.obj.listing.selectors.content_listing_pagination,$content_listing).is("[data-type=endless]")&&e.push(PF.obj.listing.selectors.content_listing_pagination),$.each(e,function(e,t){$(t,o).remove()})},PF.fn.listing.queryString={stock_load:function(){var e,t=$(PF.obj.listing.selectors.content_listing_visible),o=PF.fn.deparam(t.data("params"));for(e in void 0===PF.obj.listing.query_string.action&&(PF.obj.listing.query_string.action=t.data("action")||"list"),void 0===PF.obj.listing.query_string.list&&(PF.obj.listing.query_string.list=t.data("list")),void 0===PF.obj.listing.query_string.sort&&(void 0!==o&&void 0!==o.sort?PF.obj.listing.query_string.sort=o.sort:PF.obj.listing.query_string.sort=$(":visible"+PF.obj.listing.selectors.sort).data("sort")),void 0===PF.obj.listing.query_string.page&&(PF.obj.listing.query_string.page=1),t.data("page",PF.obj.listing.query_string.page),$(PF.obj.listing.selectors.content_listing+"[data-load=ajax]").each(function(){var e,t=$("[data-tab="+$(this).attr("id")+"]"+PF.obj.listing.selectors.sort),o=PF.fn.deparam($(this).data("params")),i={q:o&&o.q?o.q:null,list:$(this).data("list"),sort:t.exists()?t.data("sort"):o&&o.sort?o.sort:null,page:o&&o.page?o.page:1};for(e in"images"==$(this).data("list")&&delete i.list,i)i[e]||delete i[e]}),o)0==/action|list|sort|page/.test(e)&&(PF.obj.listing.query_string[e]=o[e])},stock_new:function(){var e=$(PF.obj.listing.selectors.content_listing_visible),t=PF.fn.deparam(e.data("params"));PF.obj.listing.query_string.action=e.data("action")||"list",PF.obj.listing.query_string.list=e.data("list"),"images"==e.data("list")&&delete PF.obj.listing.query_string.list,void 0!==t&&void 0!==t.sort?PF.obj.listing.query_string.sort=t.sort:PF.obj.listing.query_string.sort=$(":visible"+PF.obj.listing.selectors.sort).data("sort"),PF.obj.listing.query_string.page=1},stock_current:function(){this.stock_new(),PF.obj.listing.query_string.page=$(PF.obj.listing.selectors.content_listing_visible).data("page")}},PF.fn.listing.queryString.stock_load(),PF.fn.listing.ajax=function(){var r,l,d;1!=PF.obj.listing.calling&&(PF.obj.listing.calling=!0,r=$(PF.obj.listing.selectors.content_listing_visible),l=$(PF.obj.listing.selectors.pad_content,r),(d=$(PF.obj.listing.selectors.content_listing_load_more,r)).hide(),$(PF.obj.listing.selectors.content_listing_loading,r).removeClass("visibility-hidden").show(),PF.obj.listing.XHR=$.ajax({type:"POST",data:$.param($.extend({},PF.obj.listing.query_string,$.ajaxSettings.data))}).complete(function(e){function t(){$(PF.obj.listing.selectors.content_listing_loading+","+PF.obj.listing.selectors.content_listing_pagination+":not([data-visibility=visible])",r).remove()}function o(){r.data("empty","true").html(PF.obj.listing.template.empty),$("[data-content=list-selection][data-tab="+r.attr("id")+"]").addClass("disabled")}var i=e.responseJSON;if(4==e.readyState&&void 0!==i){if($("[data-content=list-selection][data-tab="+r.attr("id")+"]").removeClass("disabled"),200!==e.status&&(a=void 0!==i.error&&void 0!==i.error.message?i.error.message:"Bad request",PF.fn.growl.call("Error: "+a),r.data("load","")),void 0!==i.html&&""!=i.html||0!=$(PF.obj.listing.selectors.list_item,r).length||o(),void 0===i.html||""==i.html)return t(),PF.obj.listing.calling=!1,void("function"==typeof PF.fn.listing_end&&PF.fn.listing_end());r.data({load:"",page:PF.obj.listing.query_string.page});var n,a,s=$.extend({},PF.obj.listing.query_string);for(n in delete s.action,s)s[n]||delete s[n];-1==document.URL.indexOf("?"+$.param(s))&&(a=(a=window.location.href).split("?")[0].replace(/\/$/,"")+"?"+$.param(s),window.location.hash&&(a=a.replace(window.location.hash,"")),History.pushState({pushed:"pagination",scrollTop:$(window).scrollTop()},document.title,a)),$("a[data-tab="+r.attr("id")+"]").attr("href",document.URL),l.append(i.html),$("[data-action=load-more]",d).attr("data-seek",i.seekEnd),PF.fn.listing.show(i,function(){$(PF.obj.listing.selectors.content_listing_loading,r).addClass("visibility-hidden")})}else PF.obj.listing.calling=!1,r.data("load",""),t(),0==$(PF.obj.listing.selectors.list_item,r).length&&o(),0!==e.readyState&&PF.fn.growl.call(PF.fn._s("An error occurred. Please try again later."));"function"==typeof PF.fn.listing.ajax.callback&&PF.fn.listing.ajax.callback(e)}))},PF.fn.listing.columnizerQueue=function(){$(PF.obj.listing.selectors.content_listing+":hidden").data("queued",!0)},PF.fn.listing.refresh=function(e){PF.fn.listing.columnizer(!0,e,!1)},$(window).width());function sprintf(){function $(e,t,o,i,n,a,s){var r=e>>>0;return e=(o=o&&r&&{2:"0b",8:"0",16:"0x"}[t]||"")+P(r.toString(t),a||0,"0",!1),F(e,o,i,n,s)}function w(e,t,o,i,n,a){return null!=i&&(e=e.slice(0,i)),F(e,"",t,o,n,a)}var y=arguments,_=0,e=y[_++],P=function(e,t,o,i){o=o||" ";t=e.length>=t?"":new Array(1+t-e.length>>>0).join(o);return i?e+t:t+e},F=function(e,t,o,i,n,a){var s=i-e.length;return e=0<s?o||!n?P(e,i,a,o):e.slice(0,t.length)+P("",s,"0",!0)+e.slice(t.length):e};return e.replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,function(e,t,o,i,n,a,s){var r,l,d,c,u;if("%%"===e)return"%";for(var f=!1,p="",h=!1,m=!1,g=" ",b=o.length,v=0;o&&v<b;v++)switch(o.charAt(v)){case" ":p=" ";break;case"+":p="+";break;case"-":f=!0;break;case"'":g=o.charAt(v+1);break;case"0":h=!0,g="0";break;case"#":m=!0}if((i=i?"*"===i?+y[_++]:"*"==i.charAt(0)?+y[i.slice(1,-1)]:+i:0)<0&&(i=-i,f=!0),!isFinite(i))throw new Error("sprintf: (minimum-)width must be finite");switch(a=a?"*"===a?+y[_++]:"*"==a.charAt(0)?+y[a.slice(1,-1)]:+a:-1<"fFeE".indexOf(s)?6:"d"===s?0:void 0,u=t?y[t.slice(0,-1)]:y[_++],s){case"s":return w(String(u),f,i,a,h,g);case"c":return w(String.fromCharCode(+u),f,i,a,h);case"b":return $(u,2,m,f,i,a,h);case"o":return $(u,8,m,f,i,a,h);case"x":return $(u,16,m,f,i,a,h);case"X":return $(u,16,m,f,i,a,h).toUpperCase();case"u":return $(u,10,m,f,i,a,h);case"i":case"d":return r=+u||0,u=(l=(r=Math.round(r-r%1))<0?"-":p)+P(String(Math.abs(r)),a,"0",!1),F(u,l,f,i,h);case"e":case"E":case"f":case"F":case"g":case"G":return l=(r=+u)<0?"-":p,d=["toExponential","toFixed","toPrecision"]["efg".indexOf(s.toLowerCase())],c=["toString","toUpperCase"]["eEfFgG".indexOf(s)%2],u=l+Math.abs(r)[d](a),F(u,l,f,i,h)[c]();default:return e}})}function testPassword(e){var t=0,o="weak",i="";return e.length<5?(t+=3,i=i+"3 points for length ("+e.length+")\n"):4<e.length&&e.length<8?(t+=6,i=i+"6 points for length ("+e.length+")\n"):7<e.length&&e.length<16?(t+=12,i=i+"12 points for length ("+e.length+")\n"):15<e.length&&(t+=18,i=i+"18 point for length ("+e.length+")\n"),e.match(/[a-z]/)&&(t+=1,i+="1 point for at least one lower case char\n"),e.match(/[A-Z]/)&&(t+=5,i+="5 points for at least one upper case char\n"),e.match(/\d+/)&&(t+=5,i+="5 points for at least one number\n"),e.match(/(.*[0-9].*[0-9].*[0-9])/)&&(t+=5,i+="5 points for at least three numbers\n"),e.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(t+=5,i+="5 points for at least one special char\n"),e.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(t+=5,i+="5 points for at least two special chars\n"),e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(t+=2,i+="2 combo points for upper and lower letters\n"),e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(t+=2,i+="2 combo points for letters and numbers\n"),e.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(t+=2,i+="2 combo points for letters, numbers and special chars\n"),o=(t=0==e.length?0:t)<16?"very weak":15<t&&t<25?"weak":24<t&&t<35?"average":34<t&&t<45?"strong":"stronger",{score:t,ratio:e=Math.round(Math.min(100,100*t/45))/100,percent:100*e+"%",verdict:o,log:i}}function ibb(){var t,e={url:PF.obj.config.json_api,cache:!1,dataType:"json",data:{auth_token:PF.obj.config.auth_token,pathname:window.location.pathname}};void 0!==PF.obj.config.session_id&&(e.data.session_id=PF.obj.config.session_id),$.ajaxSetup(e),$(window).bind("beforeunload",function(){return"continue"!=$("form",PF.obj.modal.selectors.root).data("beforeunload")&&$(PF.obj.modal.selectors.root).is(":visible")&&PF.fn.form_modal_has_changed()?PF.fn._s("All the changes that you have made will be lost if you continue."):void 0});let o=0;const i=void 0!==window.pageXOffset,n="CSS1Compat"===(document.compatMode||"");window.addEventListener("scroll",function(){t||(t=!0,setTimeout(function(){var e=function(){var e=i?window.pageYOffset:(n?document.documentElement:document.body).scrollTop;let t;return t=e>o,o=e,t}();$("#top-bar, .follow-scroll").each(function(){"1"!==$(this).attr("data-scroll-lock")&&$(this).addClass(e?"scroll-down":"scroll-up").removeClass(e?"scroll-up":"scroll-down")}),t=!1},250))}),$(window).bind("hashchange",function(){"#edit"!=window.location.hash||$(PF.obj.modal.selectors.root).exists()||$("[data-modal=edit]").first().click()}),PF.fn.bindtipTip();var a,s=$(window).width();$(window).on("resize",function(){PF.fn.close_pops(),clearTimeout(a),a=setTimeout(function(){PF.fn.modal.fixScrollbars();var e=PF.fn.getDeviceName(),t=["phone","phablet"],o=["tablet","laptop","desktop"],i=PF.fn.getDeviceName();(i!==e&&0<=$.inArray(e,t)&&-1==$.inArray(i,t)||0<=$.inArray(e,o)&&-1==$.inArray(i,o))&&PF.fn.close_pops(),$(".top-bar").css("top",""),$(PF.fn.topMenu.vars.menu).css("height",$(window).height()),$("body").css({position:"",height:""}),$(".antiscroll").removeClass("jsly").data("antiscroll",""),$(".antiscroll-inner").css({height:"",width:"",maxheight:""}),PF.fn.list_fluid_width(),s!==$(window).width()&&($(PF.obj.listing.selectors.list_item,PF.obj.listing.selectors.content_listing_visible).css("opacity",0),$("[data-action=top-bar-menu-full]","#top-bar").hasClass("current")&&PF.fn.topMenu.hide(0),PF.fn.listing.columnizer(!0,0,!0),$(PF.obj.listing.selectors.list_item,PF.obj.listing.selectors.content_listing_visible).css("opacity",1)),s=$(window).width()},250)}),$(document).on("click","html",function(){PF.fn.close_pops()}),$(document).on("keydown",".numeric-input",function(e){e.keydown_numeric()}),$(document).on("click","[data-scrollto]",function(e){var t=$(this).data("scrollto"),t=$(t.match(/^\#|\./)?t:"#"+t);t.exists()?PF.fn.scroll(t):console.log("PF scrollto error: target doesn't exists",t)}),$(document).on("click focus","[data-login-needed], [data-user-logged=must]",function(e){if(!PF.fn.is_user_logged())return e.preventDefault(),e.stopPropagation(),!(window.location.href="https://imgbb.com/login")}),$(document).on("click","[data-trigger]",function(e){if(e.isPropagationStopped())return!1;var t=$(this).data("trigger"),t=$(t.match(/^\#|\./)?t:"#"+t);t.exists()?(e.stopPropagation(),e.preventDefault(),t.closest(PF.obj.modal.selectors.root).length||PF.fn.modal.close(),t.click()):console.log("PF trigger error: target doesn't exists",t)}),$("form[method=post]").each(function(){$("input[name=auth_token]",this).exists()||$(this).append($("<input>",{type:"hidden",name:"auth_token",value:PF.obj.config.auth_token}))}),$(document).on("click",".clear-form",function(){$(this).closest("form")[0].reset()}),$(document).on("submit","form[data-action=validate]",function(e){$(this).data("type");var n=!1;if($(this).find("[required], [data-validate]").each(function(){function e(e){$(e).highlight(),n=!0}var t,o=$(this).attr("type"),i=$(this).attr("pattern");if($(this).is("[required]")&&""==$(this).val()&&($(this).is(":hidden")&&(t=$($($(this).data("highlight")).exists()?$(this).data("highlight"):"#"+$(this).data("highlight")),$(t).highlight()),e(this)),void 0===i&&0==/mail|url/.test(o))return!0;i&&!(i=new RegExp(i)).test($(this).val())&&e(this),"email"!=o||$(this).val().isEmail()||e(this)}),n)return PF.fn.growl.expirable(PF.fn._s("Check the errors in the form to continue.")),!1}),$(document).on("change","select[data-combo]",function(){var e=$("#"+$(this).data("combo")),e=(e.exists()&&e.children(".switch-combo").hide(),$("#"+$(this).closest("select").data("combo"))),t=$("[data-combo-value~="+$("option:selected",this).attr("value")+"]",e);t.exists()&&t.show().find("[data-required]").each(function(){$(this).attr("required","required")}),$(".switch-combo",e).each(function(){$(this).is(":visible")||$("[required]",this).attr("data-required",!0).removeAttr("required")})}),$(document).on("keyup",function(e){$this=$(e.target),27==e.keyCode&&$(PF.obj.modal.selectors.root).is(":visible")&&!$this.is(":input")&&$("[data-action=cancel],[data-action=close-modal]",PF.obj.modal.selectors.root).first().click()}),$(document).on("change",":input",function(e){PF.fn.growl.close()}),$(document).on("keyup",":input",function(e){$(".input-warning",$(this).closest(".input-label")).html("")}),$(document).on("blur",":input",function(){var e=$.trim($(this).prop("value"));$(this).prop("value",e)}),$(document).on("click",":input[data-focus=select-all]",function(){this.select()}),$(document).on("keyup change blur",":input[type=password]",function(){var e=testPassword($(this).val()),t=$(this).closest("div");""==$(this).val()&&(e.percent=0,e.verdict=""),$("[data-content=password-meter-bar]",t).attr("data-veredict",e.verdict.replace(/ /g,"-")).width(e.percent),$("[data-text=password-meter-message]",t).removeClass("red-warning").text(""!==e.verdict?PF.fn._s(e.verdict):"")}),$(document).on("click","[rel=popup-link], .popup-link",function(e){e.preventDefault();e=$(this)[void 0!==$(this).attr("href")?"attr":"data"]("href");if(void 0!==e)return"mailto"==e.substring(0,6)&&PF.fn.isDevice(["phone","phablet"])?(window.location=e,!1):void PF.fn.popup({href:e})}),$(document).on("click","[data-modal=simple],[data-modal=html]",function(){var e=$("[data-modal="+$(this).data("target")+"], #"+$(this).data("target")).first();PF.fn.modal.call({template:e.html(),buttons:!1})}),$(document).on("submit",PF.obj.modal.selectors.root+" form",function(e){return!$(this).data("prevented")&&void 0!==$(this).attr("method")&&void 0}),$(document).on("click","[data-modal=edit],[data-modal=form],[data-confirm]",function(e){e.preventDefault();var o,i=$(this),n=(i.is("[data-confirm]")?(o=i,PF.obj.modal.type="confirm"):(0==(o=0==(o=$("[data-modal="+i.data("target")+"], #"+i.data("target")).first()).length?$("[data-modal=form-modal], #form-modal").first():o).length&&console.log("PF Error: Modal target doesn't exists."),PF.obj.modal.type=i.data("modal")),i.data("args")),a=window[o.data("submit-fn")],s=(window[o.data("load-fn")],o.data("submit-done")),r={url:o.data("ajax-url")||(void 0!==o.data("is-xhr")?PF.obj.config.json_api:null),deferred:window[o.data("ajax-deferred")]};if("function"!=typeof a&&o.data("submit-fn")){var t=o.data("submit-fn").split(".");a=window;for(var l=0;l<t.length;l++)a=a[t[l]]}if("function"!=typeof load_function&&o.data("load-fn")){var d=o.data("load-fn").split(".");load_function=window;for(l=0;l<d.length;l++)load_function=load_function[d[l]]}if("object"!=typeof r.deferred&&o.data("ajax-deferred")){var c=o.data("ajax-deferred").split(".");r.deferred=window;for(l=0;l<c.length;l++)r.deferred=r.deferred[c[l]]}if("function"!=typeof(f=window[o.data("before-fn")])&&o.data("before-fn"))for(var u=o.data("before-fn").split("."),f=window,l=0;l<u.length;l++)f=f[u[l]];"function"==typeof f&&f(e);var p,h=$(this).data("options")||{};i.is("[data-confirm]")?(p={message:i.data("confirm"),confirm:"function"==typeof a?a(n):"",cancel:"",ajax:r},i.attr("href")&&""==p.confirm&&(p.confirm=function(){return window.location.replace(i.attr("href"))}),PF.fn.modal.confirm($.extend(p,h))):(o.find('textarea[placeholder][name="urls"]').each(function(e,t){$(t).text()!==$(t).val()&&$(t).html("")}),p={template:o.html(),button_submit:$(this).is("[data-modal=edit]")?PF.fn._s("Save changes"):PF.fn._s("Submit"),confirm:function(){var e=PF.fn.form_modal_has_changed(),t=$("form",PF.obj.modal.selectors.root);if(void 0===t.attr("action"))return $(":input[name]",t).each(function(){var e;$(this).is(":visible")?"required"==$(this).attr("data-required")&&$(this).prop("required",!0):void 0!==(e=$(this).attr("required"))&&!1!==e&&$(this).prop("required",!1).attr("data-required","required")}),!!t[0].checkValidity()&&(e||h.forced?(void 0===(submit_fn="function"==typeof a?a(n):submit_fn)||0!=submit_fn)&&($(":input",PF.obj.modal.selectors.root).each(function(){$(this).val($.trim($(this).val()))}),i.is("[data-modal=edit]")&&o.html($(PF.obj.modal.selectors.body,$(PF.obj.modal.selectors.root).bindFormData()).html().replace(/rel=[\'"]tooltip[\'"]/g,'rel="template-tooltip"')),void 0!==r.url||void PF.fn.modal.close(function(){void 0!==s&&PF.fn.growl.expirable(""!==s?s:PF.fn._s("Changes saved successfully."))})):void PF.fn.modal.close());t.data("prevented",!e),PF.fn.modal.close()},cancel:function(){"skip"!=o.data("prompt")&&PF.fn.form_modal_has_changed()?$(PF.obj.modal.selectors.changes_confirm).exists()||($(PF.obj.modal.selectors.box,PF.obj.modal.selectors.root).css({transition:"none"}).hide(),$(PF.obj.modal.selectors.root).append('<div id="'+PF.obj.modal.selectors.changes_confirm.replace("#","")+'"><div class="content-width"><h2>'+PF.fn._s("All the changes that you have made will be lost if you continue.")+'</h2><div class="'+PF.obj.modal.selectors.btn_container.replace(".","")+' margin-bottom-0"><button class="btn btn-input default" data-action="cancel">'+PF.fn._s("Go back to the form")+'</button> <span class="btn-alt">'+PF.fn._s("or")+' <a data-action="submit">'+PF.fn._s("continue anyway")+"</a></span></div></div>"),$(PF.obj.modal.selectors.changes_confirm).css("margin-top",-$(PF.obj.modal.selectors.changes_confirm).outerHeight(!0)/2).hide().fadeIn("fast")):(PF.fn.modal.close(),"#edit"==window.location.hash&&(window.location.hash=""))},load:function(){"function"==typeof load_function&&load_function()},callback:function(){},ajax:r},PF.fn.modal.call($.extend(p,h)))}),PF.fn.is_user_logged()||$("[data-login-needed]:input, [data-user-logged=must]:input").each(function(){$(this).attr("readonly",!0)}),$(document).on("keydown",PF.obj.modal.selectors.root+" input",function(e){var t=$(e.target),e=e.charCode||e.keyCode;13!==e?PF.fn.growl.close():13==e&&$("[data-action=submit]",PF.obj.modal.selectors.root).exists()&&!t.is(".prevent-submit")&&$("[data-action=submit]",PF.obj.modal.selectors.root).click()}),window.location.hash&&"#edit"==window.location.hash&&$("[data-modal=edit]").first().click(),$(document).on("click","#menu-fullscreen .fullscreen, [data-action=top-bar-menu-full]",function(e){$(e.target).is("#pop-box-mask")||(e=$("[data-action=top-bar-menu-full]","#top-bar").hasClass("current"),PF.fn.topMenu[e?"hide":"show"]())}),$(document).on("click","[data-action=top-bar-search]",function(){$("[data-action=top-bar-search-input]",".top-bar").removeClass("hidden").show(),$("[data-action=top-bar-search-input]:visible input").first().focus(),is_ios()&&!$(this).closest(PF.fn.topMenu.vars.menu).exists()&&$(".top-bar").css("position","absolute"),$("[data-action=top-bar-search]",".top-bar").hide()}),$(document).on("click",".input-search .icon--search",function(e){$("input",e.currentTarget.offsetParent).focus()}),$(document).on("click",".input-search .icon--close, .input-search [data-action=clear-search]",function(e){e=$("input",e.currentTarget.offsetParent);""==e.val()?$(this).closest("[data-action=top-bar-search-input]").exists()&&($("[data-action=top-bar-search-input]",".top-bar").hide(),$("[data-action=top-bar-search]",".top-bar").removeClass("opened").show()):($(this).closest("[data-action=top-bar-search-input]").exists()||$(this).hide(),e.val("").change())}),$(document).on("keyup change","input.search",function(e){var t=$(this),o=$(this).closest(".input-search");$(this).closest("[data-action=top-bar-search-input]").exists()||(t=""==t.val()?"hide":"show",$(".icon--close, [data-action=clear-search]",o)[t]())}),$(document).on("click mouseenter",".pop-btn",function(e){var t,o,i,a,n,s,r,l,d;PF.fn.isDevice(["phone","phablet"])&&("mouseenter"==e.type||$(this).hasClass("pop-btn-desktop"))||(t=$(e.target),a=$.makeArray(["phone","phablet"]),s=$(this),"mouseenter"==e.type&&!$(this).hasClass("pop-btn-auto"))||$(this).hasClass("disabled")||t.closest(".current").exists()&&!PF.fn.isDevice("phone")&&!t.closest(".pop-btn-show").exists()||(PF.fn.growl.close(),e.stopPropagation(),o=$(this),i=$(".pop-box",o),o.addClass("opened"),$(".pop-box-inner",i).css("max-height",""),PF.fn.isDevice(a)?(void 0!==(n=$(".btn-text,.text,.pop-btn-text",o).first().text())&&""!=n||(n=PF.fn._s("Select")),$(".pop-box-header",i).exists()||i.prepend($("<div/>",{class:"pop-box-header",html:n+'<span class="btn-icon icon--close icon-xmark"></span></span>'}))):($(".pop-box-header",i).remove(),i.css({bottom:""})),i.hasClass("anchor-center")&&void 0===i.data("guidstr")&&(PF.fn.isDevice(a)?i.css("margin-left",""):i.css("margin-left",-i.width()/2)),t.is("[data-change]")&&($("li",i).removeClass("current"),t.closest("li").addClass("current"),$("[data-text-change]",o).text($("li.current a",i).text()),e.preventDefault()),i.exists()&&(s=e.istriggered?$(e.target):$(this),i.is(":visible")&&$(e.target).closest(".pop-box-inner").exists()&&s.hasClass("pop-keep-click")||($(".pop-box:visible").not(i).hide().closest(".pop-btn").removeClass("opened"),r=function(e){var t,o,i,n;e.is(":visible")?PF.fn.isDevice(a)?$(".antiscroll-inner",e).height("100%"):(void 0!==(t=e.css("marginLeft"))&&(t=parseFloat(t),e.css("marginLeft","")),(o=e.getWindowCutoff())&&(o.left||o.right)&&o.right<t?(n="guid-"+PF.fn.guid(),e.css("marginLeft",o.right+"px").addClass(n).attr("data-guidstr",n),o=s.outerWidth()/2+s.offset().left-e.offset().left,i=[],$.each(["top","bottom"],function(e,o){$.each(["after","before"],function(e,t){i.push("."+n+".arrow-box-"+o+":"+t)})}),$('<style id="'+n+'">'+i.join()+" { left: "+o+"px; }</style>").appendTo("head")):e.css("marginLeft",t+"px"),$(".antiscroll-wrap:not(.jsly):visible",e).addClass("jsly").antiscroll()):(n=e.attr("data-guidstr"),e.css("marginLeft","").removeClass(n).removeAttr("data-guidstr").closest(".pop-btn").removeClass("opened"),void 0!==n&&$("style#"+n).remove())},PF.fn.isDevice(a)?($(this).is("[data-action=top-bar-notifications]")&&i.css({height:$(window).height()}),l=i.height()+"px",d=parseInt($(".top-bar").outerHeight())+parseInt($(".top-bar").css("top"))+parseInt($(".top-bar").css("margin-top"))+parseInt($(".top-bar").css("margin-bottom"))+"px",i.is(":visible")?($("#pop-box-mask").css({opacity:0}),i.css({transform:"none"}),s.closest(PF.fn.topMenu.vars.menu).exists()&&($(".top-bar").css({transform:"none"}),$(PF.fn.topMenu.vars.menu).css({height:$(window).height()+parseInt(d)})),setTimeout(function(){var e;i.hide().attr("style",""),$("#pop-box-mask").remove(),r(i),s.closest(PF.fn.topMenu.vars.menu).exists()&&($(PF.fn.topMenu.vars.menu).css({height:""}),$(PF.fn.topMenu.vars.menu).animate({scrollTop:PF.fn.topMenu.vars.scrollTop},PF.obj.config.animation.normal/2)),$("body").data("hasOverflowHidden")||(e="pop-box-show pop-box-show--top",$("#fullscreen-modal").exists()||(e+=" overflow-hidden"),$("body").removeClass(e)),i.find(".pop-box-inner").css("height","")},PF.obj.config.animation.normal)):($("#pop-box-mask").remove(),i.parent().prepend($("<div/>",{id:"pop-box-mask",class:"fullscreen black"}).css({zIndex:400,display:"block"})),PF.fn.topMenu.vars.scrollTop=$(PF.fn.topMenu.vars.menu).scrollTop(),setTimeout(function(){$("#pop-box-mask").css({opacity:1}),setTimeout(function(){i.show().css({bottom:"-"+l,maxHeight:$(window).height(),zIndex:1e3,transform:"translate(0,0)"}),setTimeout(function(){i.css({transform:"translate(0,-"+l+")"})},1),setTimeout(function(){r(i)},PF.obj.config.animation.normal),$("body").hasClass("overflow-hidden")?$("body").data("hasOverflowHidden",1):$("body").addClass("overflow-hidden "+(s.closest(".top-bar").exists()?"pop-box-show--top":"pop-box-show")),s.closest(PF.fn.topMenu.vars.menu).exists()&&$(PF.fn.topMenu.vars.menu).css({height:$(window).height()+parseInt(d)}),$(".pop-box-inner",i).css("height",i.height()-$(".pop-box-header",i).outerHeight(!0))},1)},1))):i[i.is(":visible")?"hide":"show"](0,function(){r(i)}))))}).on("mouseleave",".pop-btn",function(){var e,t;PF.fn.isDevice(["laptop","desktop"])&&(e=$(this),t=$(".pop-box",e),!e.hasClass("pop-btn-auto")||PF.fn.isDevice(["phone","phablet"])&&e.hasClass("pop-btn-auto")||t.hide().closest(".pop-btn").removeClass("opened"))}),window.location.hash,$(".content-tabs").exists()&&(e=$("a",".content-tabs .current"),History.replaceState({href:e.attr("href"),"data-tab":e.data("tab"),pushed:"tabs",statenum:0},null,null));void 0===History.getState().data&&History.replaceState({scrollTop:0},document.title,window.location.href),History.Adapter.bind(window,"popstate",function(){var e=History.getState();e.data&&void 0!==e.data.scrollTop&&$(window).scrollTop()!==e.data.scrollTop&&$(window).scrollTop(e.data.scrollTop)}),$("a",".content-tabs").click(function(e){var t,o;1==$(this).data("link")&&$(this).data("tab",!1),$(this).closest(".current,.disabled").exists()?e.preventDefault():void 0!==$(this).data("tab")&&(t={},$.each(this.attributes,function(){t[this.name]=this.value}),t.pushed="tabs","classic"!=$("#"+t["data-tab"]).data("load")&&(window.location.hash&&(o=(o=window.location.href).replace(window.location.hash,"")),History.pushState(t,document.title,void 0!==o?o:$(this).attr("href")),e.preventDefault()),(o=$("[data-action=tab-menu]",$(this).closest(".header"))).find("[data-content=current-tab-label]").text($(this).text()),o.find('[data-content="tab-icon"]').attr("class","").addClass($(this).find(".btn-icon").attr("class")),$(this).is(":visible"))&&o.is(":visible")&&o.click()}),$(document).on("click","[data-action=tab-menu]",function(){var e=$(this).closest(".header").find(".content-tabs"),t=e.is(":visible"),o=$(this);if(2==e.find("li a").length){var i=e.find("li:not(.current) a");if(1==i.length)return void i.click()}t||(e.data("classes",e.attr("class")),e.removeClass(function(e,t){return(t.match(/\b\w+-hide/g)||[]).join(" ")}),e.hide()),t||o.removeClass("current"),e[t?"hide":"show"](),t&&(e.css("display","").addClass(e.data("classes")),o.addClass("current"))}),$(window).bind("statechange",function(e){var t;PF.fn.growl.close(),(t=History.getState().data)&&"tabs"==t.pushed&&PF.fn.show_tab(t["data-tab"])}),$(document).on("click",PF.obj.listing.selectors.list_item+" a",function(e){""!=$(this).attr("src")&&History.replaceState({scrollTop:$(window).scrollTop()},document.title,window.location.href)}),$(document).on("click","[data-action=load-more]",function(e){PF.obj.listing.lockClickMore||(PF.obj.listing.lockClickMore=!0,$(this).closest(".content-listing-more").hide(),!PF.fn.is_listing())||$(this).closest(PF.obj.listing.selectors.content_listing).is(":hidden")||$(this).closest("#content-listing-template").exists()||PF.obj.listing.calling||!$(this).attr("data-seek")||(PF.fn.listing.queryString.stock_new(),PF.obj.listing.query_string.seek=$(this).attr("data-seek"),$(this).attr("data-seek",""),PF.obj.listing.query_string.page=$(PF.obj.listing.selectors.content_listing_visible).data("page"),PF.obj.listing.query_string.page++,PF.fn.listing.ajax(),e.preventDefault())}),0<$(PF.obj.listing.selectors.list_item).length&&(PF.fn.listing.show(),$(window).scroll(function(){var e=$(PF.obj.listing.selectors.content_listing_load_more,PF.obj.listing.selectors.content_listing_visible).find("button[data-action=load-more]"),t=$(document).height()-$(window).height()-1.5*document.documentElement.clientHeight;0<e.length&&$(window).scrollTop()>t&&0==PF.obj.listing.calling&&e.click()})),$(document).on("click",PF.obj.modal.selectors.root+" [data-switch]",function(){var e=$(this).closest(PF.obj.modal.selectors.root);$("[data-view=switchable]",e).hide(),$("#"+$(this).attr("data-switch"),e).show()}),$(document).on("click","[data-toggle]",function(){var e=$("[data-content="+$(this).data("toggle")+"]"),t=!e.is(":visible");$(this).html($(this).data("html-"+(t?"on":"off"))),e.toggle()}),(Clipboard=new ClipboardJS("[data-action=copy]",{text:function(e){e=$(e.getAttribute("data-action-target"));return(e.is(":input")?e.val():e.text()).trim()}})).on("success",function(e){$(e.trigger.getAttribute("data-action-target")).highlight(),e.clearSelection()});var r,l=$(window).width(),e=($(window).height(),$(window).resize(function(e){clearTimeout(r),r=setTimeout(function(){$("body#image").exists()&&l!=$(window).width()&&CHV.fn.image_viewer_full_fix(),CHV.fn.uploader.boxSizer(),CHV.fn.bindSelectableItems(),CHV.fn.listingViewer.placeholderSizing(),l=$(window).width(),$(window).height()},100)}),window.opener&&"/upload"==window.location.pathname&&""==window.location.search.substr(1)&&($(window).on("load",function(e){window.opener.postMessage({id:window.name,requestAction:"postSettings"},"*")}),$(window).on("message",function(e){e=e.originalEvent.data;void 0!==e.id&&void 0!==e.settings&&window.name===e.id&&(CHV.obj.opener.uploadPlugin[e.id]=e.settings)})),CHV.fn.uploader.selectors.root),d=CHV.fn.uploader.selectors.queue,c=$(e),u=$(d),f=($(document).on("click","[data-action=top-bar-upload]",function(e){$("body").is("#upload")||1==$(this).data("link")||CHV.fn.uploader.toggle()}),{tones:{light:{html:"tone-light top-bar-white",top:"white"},dark:{html:"tone-dark top-bar-black",top:"black"}},isDark:function(){return $("html").hasClass("tone-dark")},toggle:function(){var e=this.isDark()?"light":"dark",t=this.isDark()?"dark":"light";$("html").removeClass(this.tones[t].html).addClass(this.tones[e].html)},save:function(){$.ajax({type:"POST",data:{action:"toggleTone"},cache:!1}),f.aux=f.isDark()},timeout:{},aux:{}});function p(e){var t=!1;if((e=e.originalEvent).dataTransfer.types)for(var o=0;o<e.dataTransfer.types.length;o++)if("Files"==e.dataTransfer.types[o]){t=!0;break}return t}function h(e){var t,o,i,n=e.closest(PF.obj.listing.selectors.list_item);void 0!==n.data("object")&&(e.addClass("list-item-play-gif--loading"),t=$(".image-container",n),(o=$("img",t)).attr("src"),i=JSON.parse(decodeURIComponent(n.data("object"))),t.append(t.html()),($load=n.find(".image-container img").eq(1).attr("src",i.image.url).addClass("hidden")).imagesLoaded(function(){e.remove(),o.remove(),$("img",t).show(),$(this.elements).removeClass("hidden")}))}f.aux=f.isDark(),$(document).on("click","[data-action=top-bar-tone]",function(e){e.isPropagationStopped()||($("[data-action=top-bar-menu-full]").is(":visible")&&PF.fn.topMenu.hide(),clearTimeout(f.timeout),f.toggle(),f.timeout=setTimeout(function(){f.aux!==f.isDark()&&f.save()},750))}),$("[data-action=close-upload]",c).click(function(){c.is(":animated")||$("[data-action=top-bar-upload]","#top-bar").click()}),$("[data-action=reset-upload]",c).click(function(){CHV.fn.uploader.isUploading&&$("[data-action=cancel-upload-remaining], [data-action=cancel-upload]",c).trigger("click"),CHV.fn.uploader.reset()}),$("[data-action=cancel-upload-remaining], [data-action=cancel-upload]",c).click(function(){CHV.fn.uploader.isUploading=!1,$("[data-action=cancel]",u).click(),0<Object.size(CHV.fn.uploader.results.success)?CHV.fn.uploader.displayResults():CHV.fn.uploader.reset()}),$(CHV.fn.uploader.selectors.file+", "+CHV.fn.uploader.selectors.camera).on("change",function(e){$(CHV.fn.uploader.selectors.root).data("shown")?CHV.fn.uploader.add(e):CHV.fn.uploader.toggle({callback:function(e){CHV.fn.uploader.add(e)}},e)}).on("click",function(e){$(this).data("login-needed")&&PF.fn.is_user_logged()}),$(CHV.fn.uploader.selectors.root).exists()&&($("body").on({dragenter:function(e){if(e.preventDefault(),!p(e))return!1;$(CHV.fn.uploader.selectors.dropzone).exists()||$("body").append($('<div id="'+CHV.fn.uploader.selectors.dropzone.replace("#","")+'"/>').css({width:"100%",height:"100%",position:"fixed",zIndex:1e3,left:0,top:0}))}}),$(document).on({dragover:function(e){if(e.preventDefault(),!p(e))return!1;$(CHV.fn.uploader.selectors.root).data("shown")||CHV.fn.uploader.toggle({reset:!1})},dragleave:function(e){$(CHV.fn.uploader.selectors.dropzone).remove(),$.isEmptyObject(CHV.fn.uploader.files)&&CHV.fn.uploader.toggle()},drop:function(e){e.preventDefault(),CHV.fn.uploader.add(e),$(CHV.fn.uploader.selectors.dropzone).remove()}},CHV.fn.uploader.selectors.dropzone)),$(document).on("keyup change","[data-action=resize-combo-input]",function(e){var t=$(this).closest("[data-action=resize-combo-input]"),o=$("[name=form-width]",t),t=$("[name=form-height]",t),i=o.data("initial")/t.data("initial"),i={width:Math.round(o.prop("value")/i),height:Math.round(t.prop("value")*i)};$(e.target).is(o)?t.prop("value",Math.round(i.width)):o.prop("value",Math.round(i.height))}),$(document).on("click",d+" [data-action=edit]",function(){for(var e=$(this).closest("li"),o=(e.closest("ul"),e.data("id")),a=CHV.fn.uploader.files[o],s=PF.obj.modal.selectors.root,i=$.extend({},a.formValues||a.parsedMeta),t=["album_id"],n=0;n<t.length;n++){var r,l,d=t[n];void 0===i[d]&&(l=(r=$("[name=upload-"+d.replace("_","-")+"]",CHV.fn.uploader.selectors.root)).prop(r.is(":checkbox")?"checked":"value"),i[d]=r.is(":checkbox")?l?"1":null:l)}PF.fn.modal.call({type:"html",template:$("#anywhere-upload-edit-item").html(),callback:function(){var e,t;$.each(i,function(e,t){var o,i="[name=form-"+e.replace(/_/g,"-")+"]",i=$(i,s);if(!i.exists())return!0;i.is(":checkbox")?i.prop("checked",i.attr("value")==t):i.is("select")?(o=(o=i.find('[value="'+t+'"]')).exists()?o:i.find("option:first")).prop("selected",!0):i.prop("value",t),"width"!=e&&"height"!=e||i.prop("max",a.parsedMeta[e]).data("initial",a.parsedMeta[e])}),"image/gif"!==a.parsedMeta.mimetype&&$("[ data-content=animated-gif-warning]",s).remove(),$(".image-preview",s).length&&-1===(e=$(".queue-item[data-id="+o+"] .preview .canvas")[0]).className.indexOf("icon")&&($(".image-preview",s).append($("<canvas/>",{class:"canvas"})),(t=$(".image-preview .canvas",s)[0]).width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0))},confirm:function(){var n;if(PF.fn.form_modal_has_changed())return n=!1,$.each(["width","height"],function(e,t){var t=$("[name=form-"+t+"]",s),o=parseInt(t.val()),i=parseInt(t.attr("min"));if(parseInt(t.attr("max"))<o||o<i)return t.highlight(),n=!0}),n?(PF.fn.growl.expirable(PF.fn._s("Check the errors in the form to continue.")),!1):(void 0===a.formValues&&(a.formValues={title:null,width:null,height:null,expiration:null,description:null,album_id:null}),$(":input[name]",s).each(function(e,t){var o=$(this).attr("name").replace("form-","").replace(/-/g,"_");if(void 0===a.formValues[o])return!0;a.formValues[o]=!$(this).is(":checkbox")||$(this).is(":checked")?$(this).prop("value"):null}),CHV.fn.uploader.files[o].formValues=a.formValues,!0);PF.fn.modal.close()}})}),$(document).on("click",d+" [data-action=cancel]",function(){var e=$(this).closest("li"),t=e.closest("ul"),o=e.data("id"),i=t.height(),n=!1;e.hasClass("completed")||e.hasClass("failed")||($("#tiptip_holder").hide(),e.tipTip("destroy").remove(),i!==t.height()&&CHV.fn.uploader.boxSizer(),$("li",u).exists()||$("[data-group=upload-queue-ready], [data-group=upload-queue], [data-group=upload-queue-ready]",c).css("display",""),CHV.fn.uploader.files[o]&&void 0!==CHV.fn.uploader.files[o].xhr&&(CHV.fn.uploader.files[o].xhr.abort(),n=!0),void 0!==CHV.fn.uploader.files[o]&&void 0!==CHV.fn.uploader.files[o].fromClipboard&&(e=CHV.fn.uploader.files[o].md5,-1<(i=CHV.fn.uploader.clipboardImages.indexOf(e)))&&CHV.fn.uploader.clipboardImages.splice(i,1),delete CHV.fn.uploader.files[o],CHV.fn.uploader.queueSize(),0==Object.size(CHV.fn.uploader.files)?"success"in CHV.fn.uploader&&"results"in CHV.fn.uploader&&(0!=Object.size(CHV.fn.uploader.results.success)||0!=Object.size(CHV.fn.uploader.results.error))||CHV.fn.uploader.reset():n&&0!==$("li.waiting",t).first().length&&CHV.fn.uploader.upload($("li.waiting",t).first()))}),$(document).on("click","[data-action=upload]",function(){$("[data-group=upload], [data-group=upload-queue-ready]",c).hide(),c.removeClass("queueReady").addClass("queueUploading").find("[data-group=uploading]").show(),CHV.fn.uploader.queueSize(),CHV.fn.uploader.canAdd=!1,($queue_items=$("li",u)).addClass("uploading waiting"),CHV.fn.uploader.timestamp=(new Date).getTime(),CHV.fn.uploader.upload($queue_items.first("li"))}),$("body#user").exists()&&1<PF.obj.listing.query_string.page&&((e=History.getState()).data&&void 0!==e.data.scrollTop?$(window).scrollTop()!==e.data.scrollTop&&$(window).scrollTop(e.data.scrollTop):(d=$("#background-cover").height()-160,$("html, body").animate({scrollTop:d},0))),$("#top-bar-shade").exists()&&$("#top-bar-shade").css("opacity")&&$("#top-bar-shade").data("initial-opacity",Number($("#top-bar-shade").css("opacity"))),CHV.fn.bindSelectableItems(),$("body#image").exists()&&(0<$(CHV.obj.image_viewer.selector+" [data-load=full]").length&&($(document).on("click",CHV.obj.image_viewer.loader,function(e){CHV.fn.viewerLoadImage()}),$(CHV.obj.image_viewer.loader).data("size")>CHV.obj.config.image.load_max_filesize?$(CHV.obj.image_viewer.loader).css("display","block"):CHV.fn.viewerLoadImage()),new MutationObserver(function(){$("html").height()>$(window).innerHeight()&&!$("html").hasClass("scrollbar-y")&&($("html").addClass("scrollbar-y"),$(document).data({width:$(this).width(),height:$(this).height()}))}).observe(document,{childList:!0}),$(document).on("keyup",function(e){var t=$(e.target),e=e.charCode||e.keyCode;t.is(":input")||!CHV.obj.image_viewer.$navigation.exists()||37!=e&&39!=e&&65!=e&&68!=e||void 0!==(t=$("[data-action="+(37==e||65==e?"prev":"next")+"]",CHV.obj.image_viewer.$navigation).attr("href"))&&""!==t&&(window.location=$("[data-action="+(37==e||65==e?"prev":"next")+"]",CHV.obj.image_viewer.$navigation).attr("href"))})),$(document).on("click",CHV.obj.image_viewer.container+" img",function(e){var t,o,i;($(this).hasClass("cursor-zoom-in")||$(this).hasClass("cursor-zoom-out"))&&(t=$(this).hasClass("cursor-zoom-in"),$(this).removeClass("cursor-zoom-in cursor-zoom-out"),t?(o=(t=$(this).attr("width"))/$(this).attr("height"),t>$(window).width()?($(this).css("width","100%"),i=$(this).width(),$(this).css("width",t)):i=$(this).attr("width"),$(this).addClass("cursor-zoom-out").css({width:i,height:i/o+"px"}),$("#image-viewer-container").css("height",""),CHV.fn.viewerLoadImage()):($(this).addClass("cursor-zoom-in"),image_viewer_full_fix()),e.preventDefault())}),$(document).on("contextmenu","html.device-mobile a.image-container",function(e){return e.preventDefault(),!1}),$(document).on("click","[data-action=openerPostMessage]",function(e){window.opener&&(e.preventDefault(),e="data-action-target",e=(e=$($(this).is("["+e+"]")?$(this).attr(e):this))[e.is(":input")?"val":"html"](),window.opener.postMessage({id:window.name,message:e},"*"))}),$(document).on("click","[data-action=list-tools] [data-action]",function(e){var t=$(e.target).closest("[data-id]");t&&t.find("[data-action=select]").exists()&&(e.ctrlKey||e.metaKey)&&e.altKey&&(CHV.fn.list_editor.toggleSelectItem(t,!t.hasClass("selected")),e.preventDefault(),e.stopPropagation())}),PF.fn.listing.ajax.callback=function(e){200===e.status&&CHV.fn.list_editor.listMassActionSet("select")},$(document).on("click","[data-action=list-select-all]",function(){CHV.fn.list_editor.selectItem($(PF.obj.listing.selectors.list_item+":visible:not(.selected)")),CHV.fn.list_editor.listMassActionSet("clear")}),$(document).on("click","[data-action=list-clear-all]",function(){PF.fn.close_pops(),CHV.fn.list_editor.clearSelection()}),$(document).on("click","[data-action=share]",function(e){var t,o,i,n=($(".viewer:visible").exists()?$(PF.obj.listing.selectors.list_item+"[data-id="+$(".viewer").attr("data-id")+"]",".content-listing"):$(this).closest(PF.obj.listing.selectors.list_item)).first(),a="#modal-share";if(n.exists()){if(i=CHV.fn.modal.getTemplateWithPreview(a,n),void 0===n.attr("data-type"))return void console.log("Error: data-type not defined");s=n.find(".list-item-desc-title-link").first(),o=n.find(".image-container img").first().attr("src"),t=n.find(".image-container").first().attr("href")}else i=$(a).html(),dealing_with=CHV.obj.resource.type,t=$("a[data-text=album-name]").exists()?$("a[data-text=album-name]").attr("href"):window.location.href,o=$("#image-viewer-container").find("img").first().attr("src"),s=$(".header > h1 > a");var a=PF.fn.htmlEncode(s.text()),s=n.data("privacy")||CHV.obj.resource.privacy,r="";switch(s){case"private_but_link":r=PF.fn._s("Note: This content is private but anyone with the link will be able to see it.");break;case"password":r=PF.fn._s("Note: This content is password protected. Remember to provide the content password to share.");break;case"private":r=PF.fn._s('Note: This content is private. Change the privacy to "public" to share.')}i=i.replaceAll("__url__",t).replaceAll("__image__",o).replaceAll("__title__",a).replaceAll("__privacy__",s).replaceAll("__privacy_notes__",r),PF.fn.modal.call({type:"html",buttons:!1,template:i})}),$(document).on("click","[data-action=list-tools] [data-action]",function(e){if(e.isPropagationStopped())return!1;var t=($(".viewer:visible").exists()?$(PF.obj.listing.selectors.list_item+"[data-id="+$(".viewer").attr("data-id")+"]",".content-listing"):$(this).closest(PF.obj.listing.selectors.list_item)).first(),o=t.attr("data-id");if(void 0===t.attr("data-type"))console.log("Error: data-type not defined");else{var i,i=t.attr("data-type"),n=$("[data-type="+i+"][data-id="+o+"]");switch($(this).data("action")){case"select":CHV.fn.list_editor.toggleSelectItem(t,!t.hasClass("selected"));break;case"codes":var a="[data-modal=form-embed-codes]",s=[];$("textarea",a).html(""),s.push({image:JSON.parse(decodeURIComponent(t.data("object")))}),CHV.fn.fillEmbedCodes(s,a,"html"),PF.fn.modal.call({type:"html",template:CHV.fn.modal.getTemplateWithPreview(a,t),buttons:!1});break;case"edit":var r="[data-modal=form-edit-single]";switch(i){case"image":$("[name=form-image-title]",r).attr("value",t.attr("data-title")),$("[name=form-image-description]",r).html(PF.fn.htmlEncode(t.attr("data-description"))),$("[name=form-album-id]",r).find("option").removeAttr("selected"),$("[name=form-album-id]",r).find('[value="'+t.attr("image"==i?"data-album-id":"data-id")+'"]').attr("selected",!0),$("[name=form-album-name]",r).attr("value",""),$("[name=form-album-description]",r).html(""),$("[name=form-privacy]",r).find("option").removeAttr("selected"),$("[data-action=replace]",r).attr("href","https://imgbb.com/replace/"+t.attr("data-id"));break;case"album":$("[data-action=album-switch]",r).remove(),$("[name=form-album-name]",r).attr("value",t.attr("data-name")),$("[name=form-album-description]",r).html(PF.fn.htmlEncode(t.attr("data-description"))),$("[name=form-privacy]",r).find("option").removeAttr("selected"),$("[name=form-privacy]",r).find('[value="'+t.attr("data-privacy")+'"]').attr("selected",!0),"password"==t.attr("data-privacy")?($("[data-combo-value=password]").show(),$("[name=form-album-password]",r).attr("value",t.attr("data-password"))):($("[data-combo-value=password]").hide(),$("[name=form-album-password]",r).attr("value",""))}PF.fn.modal.call({type:"html",template:CHV.fn.modal.getTemplateWithPreview(r,t),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){CHV.fn.list_editor.updateItem("[data-type="+i+"][data-id="+o+"]",e.responseJSON[i],"edit")}}},confirm:function(){var e=$(PF.obj.modal.selectors.root);if(("image"==i||"album"==i)&&$("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val())return PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1;if(PF.fn.form_modal_has_changed()){switch(PF.obj.modal.form_data={action:"edit",edit:t.attr("data-type"),single:!0,owner:CHV.obj.resource.user.id,editing:{id:o,description:$("[name=form-"+i+"-description]",e).val()}},i){case"image":PF.obj.modal.form_data.editing.title=$("[name=form-image-title]",e).val();break;case"album":PF.obj.modal.form_data.editing.name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.privacy&&(PF.obj.modal.form_data.editing.password=$("[name=form-album-password]",e).val())}return PF.obj.modal.form_data.editing.new_album=$("[data-content=form-new-album]",e).is(":visible"),PF.obj.modal.form_data.editing.new_album?(PF.obj.modal.form_data.editing.album_name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.album_privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.album_privacy&&(PF.obj.modal.form_data.editing.album_password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.editing.album_description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.editing.album_id=$("[name=form-album-id]",e).val(),!0}PF.fn.modal.close()}});break;case"move":r="[data-modal=form-move-single]";$("[name=form-album-id]",r).find("option").removeAttr("selected"),$("[name=form-album-id]",r).find('[value="'+t.attr("image"==i?"data-album-id":"data-id")+'"]').attr("selected",!0),$("[name=form-album-name]",r).attr("value",""),$("[name=form-album-description]",r).html(""),$("[name=form-privacy]",r).find("option").removeAttr("selected"),PF.fn.modal.call({type:"html",template:CHV.fn.modal.getTemplateWithPreview(r,n),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){CHV.fn.list_editor.updateMoveItemLists(e.responseJSON,i,n)}}},load:function(){},confirm:function(){var e=$(PF.obj.modal.selectors.root);return $("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):PF.fn.form_modal_has_changed()?(PF.obj.modal.form_data={action:"edit",edit:t.attr("data-type"),single:!0,owner:CHV.obj.resource.user.id,editing:{id:o}},PF.obj.modal.form_data.editing.new_album=$("[data-content=form-new-album]",e).is(":visible"),PF.obj.modal.form_data.editing.new_album?(PF.obj.modal.form_data.editing.album_name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.album_privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.album_privacy&&(PF.obj.modal.form_data.editing.album_password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.editing.album_description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.editing.album_id=$("[name=form-album-id]",e).val(),!0):void PF.fn.modal.close()}});break;case"delete":PF.fn.modal.call({type:"html",template:CHV.fn.modal.getTemplateWithPreview("[data-modal=form-delete-single]",t),button_submit:PF.fn._s("Confirm"),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){"album"==i&&($("[name=form-album-id]","[data-modal]").find('[value="'+o+'"]').remove(),CHV.fn.list_editor.updateUserCounters("image",e.responseJSON.success.affected,"-")),CHV.fn.list_editor.deleteFromList(t),CHV.fn.listingViewer.close()}}},confirm:function(){return PF.obj.modal.form_data={action:"delete",single:!0,delete:t.attr("data-type"),deleting:{id:o}},!0}})}}}),$(".pop-box-menu a","[data-content=list-selection]").click(function(e){var t=$(PF.obj.listing.selectors.content_listing_visible);if(void 0!==t.data("list")){dealing_with=t.data("list");var o=$(PF.obj.listing.selectors.list_item+".selected",t),i=$.map(o,function(e,t){return $(e).data("id")});switch($(this).closest(".pop-btn").click(),$(this).data("action")){case"get-embed-codes":var n="[data-modal=form-embed-codes]",a=[];$("textarea",n).html(""),o.each(function(){a.push({image:JSON.parse(decodeURIComponent($(this).data("object")))})}),CHV.fn.fillEmbedCodes(a,n,"html"),PF.fn.modal.call({type:"html",template:CHV.fn.modal.getTemplateWithPreviews(n,o),buttons:!1});break;case"clear":CHV.fn.list_editor.clearSelection(),e.stopPropagation();break;case"move":case"create-album":var s="[data-modal="+(n="move"==$(this).data("action")?"form-move-multiple":"form-create-album")+"]",r=/image/.test(dealing_with)?"album-id":"id",l=($("[name=form-album-id]",s).find("[value=null]").remove(),$("[name=form-album-id]",s).find("option").removeAttr("selected"),$("[name=form-album-name]",s).attr("value",""),$("[name=form-album-description]",s).html(""),$("[name=form-privacy]",s).find("option").removeAttr("selected"),o.first().data(r)),d=!0;o.each(function(){if($(this).data(r)!==l)return d=!1}),d||$("[name=form-album-id]",s).prepend('<option value="null">'+PF.fn._s("Select existing album")+"</option>"),$("[name=form-album-id]",s).find('[value="'+(d?o.first().data(r):"null")+'"]').attr("selected",!0),PF.fn.modal.call({type:"html",template:CHV.fn.modal.getTemplateWithPreviews(s,o),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){CHV.fn.list_editor.updateMoveItemLists(e.responseJSON,dealing_with,o)}}},load:function(){},confirm:function(){var e=$(PF.obj.modal.selectors.root),t=!1;return $("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):($("[data-content=form-new-album]",e).is(":visible")&&(t=!0),PF.fn.form_modal_has_changed()?(PF.obj.modal.form_data={action:t?"create-album":"move",type:dealing_with,owner:CHV.obj.resource.user.id,multiple:!0,album:{ids:i,new:t}},t?(PF.obj.modal.form_data.album.name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.album.privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.album.privacy&&(PF.obj.modal.form_data.album.password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.album.description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.album.id=$("[name=form-album-id]",e).val(),!0):void PF.fn.modal.close())}});break;case"delete":PF.fn.modal.call({template:CHV.fn.modal.getTemplateWithPreviews("[data-modal=form-delete-multiple]",o),button_submit:PF.fn._s("Confirm"),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){"albums"==dealing_with&&(o.each(function(){$("[name=form-album-id]","[data-modal]").find('[value="'+$(this).data("id")+'"]').remove()}),CHV.fn.list_editor.updateUserCounters("image",e.responseJSON.success.affected,"-")),CHV.fn.list_editor.deleteFromList(o)}}},confirm:function(){return PF.obj.modal.form_data={action:"delete",from:"list",delete:dealing_with,multiple:!0,deleting:{ids:i}},!0}})}return!PF.fn.isDevice(["phone","phablet"])&&void 0}console.log("Error: data-list not defined")}),$(document).on("click","[data-action=disconnect]",function(){var e=$(this),o=e.data("connection");PF.fn.modal.confirm({message:e.data("confirm-message"),ajax:{data:{action:"disconnect",disconnect:o,user_id:CHV.obj.resource.user.id},deferred:{success:function(e){var t=e.responseJSON;$("[data-connection="+o+"]").fadeOut(function(){$($("[data-connect="+o+"]")).fadeIn(),$(this).remove(),0==$("[data-connection]").length&&$("[data-content=empty-message]").show(),PF.fn.growl.expirable(t.success.message)})},error:function(e){e=e.responseJSON;PF.fn.growl.call(e.error.message)}}}})}),$(document).on("click","[data-action=delete-avatar]",function(){var t=$(".user-settings-avatar"),o=$(".loading-placeholder",t),i=$("#top-bar");o.removeClass("hidden"),PF.fn.loading.inline(o,{center:!0}),$.ajax({type:"POST",data:{action:"delete",delete:"avatar",owner:CHV.obj.resource.user.id}}).complete(function(e){o.addClass("hidden").empty(),200==e.status?(CHV.obj.logged_user.id==CHV.obj.resource.user.id&&($("img.user-image",i).hide(),$(".default-user-image",i).removeClass("hidden")),$(".default-user-image",t).removeClass("hidden").css({opacity:0}),$('[data-action="delete-avatar"]',t).parent().addClass("soft-hidden"),$("img.user-image",t).fadeOut(function(){$(".default-user-image",t).animate({opacity:1})})):PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later."))})}),$(document).on("change","[data-content=user-avatar-upload-input]",function(e){e.preventDefault(),e.stopPropagation();var o,t,i=$(this),n=$(".user-settings-avatar"),a=$(".loading-placeholder",".user-settings-avatar"),s=$("#top-bar"),e=$(this)[0].files[0];i.data("uploading")||(0==/^image\/.*$/.test(e.type)?PF.fn.growl.call(PF.fn._s("Please select a valid image file type.")):e.size>CHV.obj.config.user.avatar_max_filesize?PF.fn.growl.call(PF.fn._s("Please select a picture no larger than %s.",CHV.obj.config.user.avatar_max_filesize)):(o=$('[data-action="delete-avatar"]'),a.removeClass("hidden"),PF.fn.loading.inline(a,{center:!0}),i.data("uploading",!0),(t=new FormData).append("source",e),t.append("action","upload"),t.append("type","file"),t.append("what","avatar"),t.append("owner",CHV.obj.resource.user.id),t.append("auth_token",PF.obj.config.auth_token),(avatarXHR=new XMLHttpRequest).open("POST",PF.obj.config.json_api,!0),avatarXHR.send(t),avatarXHR.onreadystatechange=function(){var t;4==this.readyState&&(t=("json"!==this.responseType?JSON.parse(this.response):this.response).success.image,a.addClass("hidden").empty(),200==this.status?(change_avatar=function(e){o.parent().removeClass("soft-hidden"),$("img.user-image",e).attr("src",t.url).removeClass("hidden").show()},(hide_default=function(e){$(".default-user-image",e).addClass("hidden")})(n),$(".btn-alt",n).closest("div").show(),change_avatar(n),CHV.obj.logged_user.id==CHV.obj.resource.user.id&&(change_avatar(s),hide_default(s)),PF.fn.growl.expirable(PF.fn._s("Profile image updated."))):PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later.")),i.data("uploading",!1))}))}),$(document).on("change","[data-content=user-background-upload-input]",function(e){e.preventDefault(),e.stopPropagation();var t,o=$(this),i=$("[data-content=user-background-cover]"),n=$("[data-content=user-background-cover-src]"),a=$(".loading-placeholder",i),e=($("#top-bar"),$(this)[0].files[0]);o.data("uploading")||(0==/^image\/.*$/.test(e.type)?PF.fn.growl.call(PF.fn._s("Please select a valid image file type.")):e.size>CHV.obj.config.user.background_max_filesize?PF.fn.growl.call(PF.fn._s("Please select a picture no larger than %s.",CHV.obj.config.user.background_max_filesize)):(a.removeClass("hidden"),PF.fn.loading.inline(a,{center:!0,size:"big",color:"#FFF"}),o.data("uploading",!0),(t=new FormData).append("source",e),t.append("action","upload"),t.append("type","file"),t.append("what","background"),t.append("owner",CHV.obj.resource.user.id),t.append("auth_token",PF.obj.config.auth_token),(avatarXHR=new XMLHttpRequest).open("POST",PF.obj.config.json_api,!0),avatarXHR.send(t),avatarXHR.onreadystatechange=function(){var e,t;4==this.readyState&&(e=("json"!==this.responseType?JSON.parse(this.response):this.response).success.image,200==this.status?(t=$("<img/>")).attr("src",e.url).imagesLoaded(function(){a.addClass("hidden").empty(),n.css("background-image","url("+e.url+")").hide().fadeIn(),$("[data-content=user-change-background]",i).removeClass("hidden"),$(i).removeClass("no-background"),$(".top-user").removeClass("no-background"),$("[data-content=user-upload-background]").hide(),$("[data-content=user-change-background]").show(),PF.fn.growl.expirable(PF.fn._s("Profile background image updated.")),t.remove()}):(a.addClass("hidden").empty(),PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later."))),o.data("uploading",!1))}))}),CHV.fn.user_background={delete:{submit:function(){return PF.obj.modal.form_data={action:"delete",delete:"background",owner:CHV.obj.resource.user.id},!0},deferred:{success:{before:function(e){$("[data-content=user-background-cover-src]").css("background-image","none"),$("[data-content=user-background-cover], .top-user").addClass("no-background"),$("[data-content=user-background-cover]").height(""),$("[data-content=user-upload-background]").removeClass("hidden").show(),$("[data-content=user-change-background]").hide()},done:function(e){PF.fn.modal.close(function(){PF.fn.growl.expirable(PF.fn._s("Profile background image deleted."))})}},error:function(e){PF.fn.growl.expirable(PF.fn._s("Error deleting profile background image."))}}}},CHV.str.mainform="[data-content=main-form]",CHV.obj.timezone={selector:"[data-content=timezone]",input:"#timezone-region"},$(document).on("keyup change",CHV.str.mainform+" :input",function(){$(this).is("[name=username]")&&$("[data-text=username]").text($(this).val())}),$(document).on("change",CHV.obj.timezone.input,function(){var e=$(this).val(),e=$("#timezone-combo-"+e);e.find("option:first").prop("selected",!0),$(CHV.obj.timezone.selector).val(e.val()).change()}),$(document).on("change","[id^=timezone-combo-]",function(){var e=$(this).val();$(CHV.obj.timezone.selector).val(e).change()}),$(document).on("keyup change blur","[name^=new-password]",function(){var e=$("[name=new-password]"),t=$("[name=new-password-confirm]"),e=e.val()==t.val(),o=t.closest(".input-password").find(".input-warning");0==o.exists()&&(o=$("[data-message=new-password-confirm]")),$(this).is(t)&&t.data("touched",!0),t.data("touched")&&o.text(e?"":o.data("text"))[e?"addClass":"removeClass"]("hidden-visibility")}),$(document).on("submit",CHV.obj.mainform,function(){switch($(this).data("type")){case"password":var e=$("[name=new-password]",this),t=$("[name=new-password-confirm]",this);if(""===e.val()&&""===t.val()||e.val()===t.val())break;return e.highlight(),t.highlight(),PF.fn.growl.expirable(PF.fn._s("Passwords don't match")),!1}}),$(CHV.fn.uploader.selectors.root).exists()&&(CHV.fn.uploader.$pasteCatcher=$("<div />",{contenteditable:"true",id:CHV.fn.uploader.selectors.paste.replace(/#/,"")}),$("body").append(CHV.fn.uploader.$pasteCatcher),$(document).keydown(function(e){var t=e.keyCode;!e.ctrlKey&&!e.metaKey||86!=t||$(e.target).is(":input")||CHV.fn.uploader.$pasteCatcher.focus(e)}),window.addEventListener("paste",CHV.fn.uploader.pasteImageHandler)),$(document).on("click","[data-action=like]",function(){var t,o,i,e,n,a,s;PF.fn.is_user_logged()?(t=$(this)).data("XHR")||(t.data("XHR",!0),e=$(this).is("[data-liked]")?$(this):$(this).closest("[data-liked]"),o=!e.closest("[data-list], .viewer").exists()&&void 0!==CHV.obj.resource,e=(i=e.is("[data-liked=1]"))?"dislike":"like",n={id:o?CHV.obj.resource.id:$(this).closest("[data-id]").attr("data-id"),type:o?CHV.obj.resource.type:$(this).closest("[data-type]").attr("data-type")},a=o?t:$("[data-type="+n.type+"][data-id="+n.id+"]"),(s={type:"POST",data:{action:e},cache:!1}).data[e]={object:n.type,id:n.id},$.ajax(s).complete(function(e){e=e.responseJSON;t.data("XHR",!1),200!==e.status_code?PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later.")):(o&&void 0!==e.content&&$("[data-text=likes-count]").html(e.content.likes),a.attr("data-liked",i?0:1))})):window.location.href="https://imgbb.com/login"}),$(document).on("click","[data-action=album-cover]",function(){var t,o,e,i,n;PF.fn.is_user_logged()?(t=$(this)).data("XHR")||(t.data("XHR",!0),e=(o=($(this).is("[data-cover]")?$(this):$(this).closest("[data-cover]")).is("[data-cover=1]"))?"album-cover-unset":"album-cover-set",CHV.obj.resource.id,i=t,(n={type:"POST",data:{action:e},cache:!1}).data[e]={album_id:t.data("album-id"),image_id:t.data("id")},$.ajax(n).complete(function(e){e=e.responseJSON;t.data("XHR",!1),200!==e.status_code?PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later.")):i.attr("data-cover",o?0:1)})):window.location.href=CHV.obj.vars.urls.login}),$(document).on("click","[data-action=follow]",function(){var i,n,a,s,e,t,o;PF.fn.is_user_logged()?(i=$(this)).data("XHR")||(i.data("XHR",!0),n=$(this).is("[data-followed]")?$(this):$(this).closest("[data-followed]"),a=void 0!==CHV.obj.resource,(o={type:"POST",data:{action:e=(s=n.is("[data-followed=1]"))?"unfollow":"follow"},cache:!(t={id:a?CHV.obj.resource.id:$(this).closest("[data-id]").data("id"),type:a?CHV.obj.resource.type:$(this).closest("[data-type]").data("type")})}).data[e]={object:t.type,id:t.id},$.ajax(o).complete(function(e){var t,o,e=e.responseJSON;i.data("XHR",!1),200!==e.status_code?PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later.")):(a&&void 0!==e.user_followed&&(o={single:(t=$("[data-text=followers-label]")).data("label-single"),plural:t.data("label-plural")},$("[data-text=followers-count]").html(e.user_followed.followers),t.html(PF.fn._n(o.single,o.plural,e.user_followed.followers))),n.attr("data-followed",s?0:1))})):PF.fn.modal.call({type:"login"})}),$(document).on("click","[data-action=top-bar-notifications]",function(e){var i=this,n=$(this),a=$(".top-bar-notifications-container",n),s=$(".top-bar-notifications-list",n),r=$("ul",s),l=$(".loading",a);n.data("XHR")||(l.removeClass("hidden"),PF.fn.loading.inline(l,{size:"small",message:PF.fn._s("loading")}),$.ajax({type:"POST",data:{action:"notifications"},cache:!1}).complete(function(e){var t,o,e=e.responseJSON;200!==e.status_code?(PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later.")),n.data("XHR",!1),l.addClass("hidden").html("")):(n.data("XHR",!0),l.remove(),e.html?(s.removeClass("hidden"),r.html(e.html),PF.fn.isDevice(["phone","phablet"])||((e=$(".top-bar-notifications-list ul",".top-bar:visible")).css("height",""),t=e.height(),e.data("height",t).css("height","auto"),t<e.height()&&(e.height(t),e.closest(".antiscroll-wrap").antiscroll())),(o=$("li.new",r)).addClass("transition"),setTimeout(function(){o.removeClass("new"),$("[data-content=notifications-counter]",i).removeClass("on").html("0"),setTimeout(function(){o.removeClass("transition")},150)},1500)):$(".empty",a).removeClass("hidden"))}))}),void 0!==CHV.obj.config.mode&&"code"==CHV.obj.config.mode&&(e="",-1===window.name.indexOf("imgbb_")?e=window.name:"undefined"!=typeof localStorage&&(e=localStorage.getItem("code")),""!=e)&&-1===e.indexOf("imgbb_")&&(d="[data-modal=form-embed-code]",$("textarea",d).html(decodeURIComponent(e)),PF.fn.modal.call({type:"html",template:$(d).html(),buttons:!1})),void 0!==CHV.obj.config.recaptcha&&$("#g-recaptcha").is(":empty")&&CHV.obj.config.recaptcha.enabled&&CHV.obj.config.recaptcha.sitekey&&(reCaptchaCallback=function(){0!=$("#g-recaptcha").is(":empty")&&grecaptcha.render("g-recaptcha",{sitekey:CHV.obj.config.recaptcha.sitekey})},$.getScript("https://www.recaptcha.net/recaptcha/api.js?onload=reCaptchaCallback&render=explicit")),$(document).on("click",PF.obj.listing.selectors.list_item+" [data-action=load-image]",function(e){h($(this)),e.preventDefault(),e.stopPropagation()}),$(document).on("click","#album [data-tab=tab-embeds]",function(e){e.preventDefault,CHV.fn.album.showEmbedCodes()}),$("body").is("#upload")&&CHV.fn.uploader.toggle({show:!0}),$(document).on("keyup",function(e){var t;!$(PF.obj.modal.selectors.root).exists()&&$(".viewer").exists()&&e.which in CHV.fn.listingViewer.keys&&(t=CHV.fn.listingViewer.keys[e.which],-1==[88,27,37,39,65,68].indexOf(e.which)?$("[data-action="+t+"]",CHV.fn.listingViewer.selectors.root).click():t in CHV.fn.listingViewer&&CHV.fn.listingViewer[t]())}),$(document).on("click",CHV.fn.listingViewer.selectors.root+" [data-action^=viewer-]",function(){var e=$(this).data("action").substring("viewer-".length);e in CHV.fn.listingViewer&&CHV.fn.listingViewer[e]()}),$(document).on("click","a[data-href]:not([rel=popup-link]):not(.popup-link)",function(){var e=$(this).attr("data-href"),t=$(this).attr("href");(e||t)&&(location.href=t||e)}),void 0!==CHV.obj.config&&CHV.obj.config.listing.viewer&&$(document).on("click",PF.obj.listing.selectors.list_item+"[data-type=image] a.image-container",function(e){e.preventDefault(),e.stopPropagation();e=$(this).closest(PF.obj.listing.selectors.list_item);e.exists()&&CHV.fn.listingViewer.open(e)}),$(document).on("contextmenu","html.device-mobile "+CHV.fn.listingViewer.selectors.src,function(e){return e.preventDefault(),!1});var m,e=PF.fn.deparam(window.location.search);e&&"viewer"in e&&"images"==(d=$(PF.obj.listing.selectors.content_listing_visible)).data("list")&&(d=$(PF.obj.listing.selectors.list_item,d)["next"==e.viewer?"first":"last"](),CHV.fn.listingViewer.open(d)),$(window).on("DOMContentLoaded load resize scroll",function(){clearTimeout(m),m=setTimeout(function(){$(PF.obj.listing.selectors.list_item+":visible").each(function(){var e=$(this).find('[data-action="load-image"]').first(),t=PF.fn.deparam($(PF.obj.listing.selectors.list_item+"[data-id="+$(this).attr("data-id")+"]").closest(".content-listing").data("params-hidden")),t=t&&"is_animated"in t?t.is_animated:$(this).data("size")<=CHV.obj.config.image.load_max_filesize;e.exists()&&t&&$(this).is_within_viewport(50)&&h(e)})},500)}),$(document).on("contextmenu",".list-item .image-container",function(e){var t=$(this).closest(".list-item");CHV.fn.list_editor.blink(t),CHV.fn.list_editor.toggleSelectItem(t),e.preventDefault()})}function changeEmbed(e){setCookie("USER_SELECTED_EMBED",e,2592e3)}function changeLanguage(e){setCookie("USER_SELECTED_LANG",e,2592e3)}function setCookie(e,t,o){var i=new Date;i.setTime(i.getTime()+1e3*o),document.cookie=e+"="+t+"; expires="+i.toGMTString()+"; path=/; domain=imgbb.com"}function getCookie(e){e=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}PF.fn.listing.columnizer=function(e,c,u){var t={phone:2,phablet:3,tablet:4,laptop:5,desktop:6,largescreen:6},f=("boolean"!=typeof e&&(e=!1),void 0===PF.obj.listing.mode&&(e=!0),s="boolean"!=typeof u&&!(u=!1),u||!s||width===$(window).width()&&!e||(u=!0),void 0===c&&(c=PF.obj.config.animation.normal),$("#content-listing-tabs").exists()?$(PF.obj.listing.selectors.content_listing_visible,"#content-listing-tabs"):$(PF.obj.listing.selectors.content_listing)),o=$(PF.obj.listing.selectors.pad_content,f),p=$(e||u?PF.obj.listing.selectors.list_item:PF.obj.listing.selectors.list_item+":not(.jsly)",f);if(void 0!==PF.obj.config.listing.device_to_columns&&(t=$.extend({},t,PF.obj.config.listing.device_to_columns)),f.data("device-columns")&&(t=$.extend({},t,f.data("device-columns"))),PF.obj.listing.mode="responsive",PF.obj.listing.device=PF.fn.getDeviceName(),p.exists()){if(void 0===f.data("columns")||e||u){for(p.first().css("width",""),PF.obj.listing.columns=new Array,PF.obj.listing.columns_number=t[PF.fn.getDeviceName()],i=0;i<PF.obj.listing.columns_number;i++)PF.obj.listing.columns[i+1]=0;PF.obj.listing.current_column=1}else PF.obj.listing.columns=f.data("columns"),PF.obj.listing.columns_number=f.data("columns").length-1,PF.obj.listing.current_column=f.data("current_column");f.removeClass("small-cols").addClass(6<PF.obj.listing.columns_number?"small-cols":""),o.css("width","100%");var n,h=0,a=(p.each(function(e){$(this).addClass("jsly");var t,o=$(".list-item-image",this),i=$(".list-item-image img",this),n=$(".list-item-thumbs",this),a=(i.hasClass("jsly-loaded"),i.show(),u&&($(this).css({top:"",left:"",height:"",position:""}),o.css({maxHeight:"",height:""}),i.removeClass("jsly").css({width:"",height:""}).parent().css({marginLeft:"",marginTop:""}),$("li",n).css({width:"",height:""})),1==PF.obj.listing.columns_number?"100%":parseFloat(1/PF.obj.listing.columns_number*f.width()+"px")),a=($(this).css("width",a),PF.obj.listing.current_column>PF.obj.listing.columns_number&&(PF.obj.listing.current_column=1),$(this).attr("data-col",PF.obj.listing.current_column),i.exists()||(l=!0,i=$(".image-container .empty",this)),$(this).is(":visible")),s=(p.show(),o.hasClass("fixed-size")),r={w:parseFloat(i.attr("width")),h:parseFloat(i.attr("height"))},s=(r.ratio=r.w/r.h,(l||o.css("min-height")&&!i.hasClass("jsly"))&&(d={w:$(this).width(),h:s?$(this).width():null},t=Math.min(r.w,(r.w<d.w?r:d).w),s?(o.css({height:d.w}),r.ratio<=3&&(1<r.ratio||1==r.ratio)?(r.h=Math.min(r.h,(r.w<d.w?r:d).w),r.w=r.h*r.ratio):(r.w=t,r.h=r.w/r.ratio),o.css("min-height",0)):(r.w=t,3<=r.ratio||r.ratio<1||1==r.ratio?r.h=r.w/r.ratio:(r.h=Math.min(r.h,r.w),r.w=r.h*r.ratio),l&&(r.h=d.w),o.css({height:r.h})),0==i.width()&&i.css({width:t,height:t/r.ratio}),$(".image-container",this).is(".list-item-avatar-cover")&&i.css(s?{width:"auto",height:"100%"}:{width:"100%",height:"auto"}),l=Math.max(2*i.position().left,0),d=Math.max(2*i.position().top,0),t=l/o.width(),r=d/o.height(),(0<l||0<d)&&(t<=.25||r<=.25)&&o.addClass("--fit"),n.exists()&&$("li",n).css({width:100/$("li",n).length+"%"}).css({height:$("li",n).width()}),a||p.hide()),!i.hasClass("jsly")&&$(this).is(":hidden")&&$(this).css("top","100%"),PF.obj.listing.columns[PF.obj.listing.current_column]+=$(this).outerHeight(!0),$(this).is(":animated")&&(c=0),$(this).addClass("position-absolute"),$(this).outerWidth(!0)*(PF.obj.listing.current_column-1)),l=parseFloat($(this).css("left"))!=s,d=(l&&(animate_grid=!0,$(this).animate({left:s},c)),PF.obj.listing.columns[PF.obj.listing.current_column]-$(this).outerHeight(!0));parseFloat($(this).css("top"))!=d&&(animate_grid=!0,$(this).animate({top:d},c),l)&&(h=1),a&&p.show(),PF.obj.listing.current_column++}),f.data({columns:PF.obj.listing.columns,current_column:PF.obj.listing.current_column}).attr("data-columns",PF.obj.listing.columns_number),0),s=($.each(PF.obj.listing.columns,function(e,t){a<t&&(a=t)}),PF.obj.listing.width=f.width(),void 0!==PF.obj.listing.height&&(n=PF.obj.listing.height),PF.obj.listing.height=a,void 0!==n&&n!==PF.obj.listing.height);s||(o.height(a),PF.fn.list_fluid_width()),s&&(o.height(n),setTimeout(function(){o.animate({height:a},c,function(){PF.fn.list_fluid_width()})},c*h)),f.data("list-mode",PF.obj.listing.mode),$(PF.obj.listing.selectors.content_listing_visible).data("queued",!1),f.addClass("jsly")}},PF.fn.loading={spin:{small:{lines:11,length:0,width:3,radius:7,speed:1,trail:45,blocksize:20},normal:{lines:11,length:0,width:5,radius:10,speed:1,trail:45,blocksize:30},big:{lines:11,length:0,width:7,radius:13,speed:1,trail:45,blocksize:40},huge:{lines:11,length:0,width:9,radius:16,speed:1,trail:45,blocksize:50}},inline:function(e,t){if(void 0!==e){e instanceof jQuery==0&&(e=$(e));var o={size:"normal",color:$("body").css("color"),center:!1,position:"absolute",shadow:!1,valign:"top"};if(void 0===t)t=o;else for(var i in o)void 0===t[i]&&(t[i]=o[i]);PF.fn.loading.spin[t.size];PF.fn.loading.spin[t.size].color=t.color,PF.fn.loading.spin[t.size].shadow=t.shadow,e.html('<span class="loading-indicator"></span>'+(void 0!==t.message?'<span class="loading-text">'+t.message+"</span>":"")).css({"line-height":PF.fn.loading.spin[t.size].blocksize+"px"}),$(".loading-indicator",e).css({width:PF.fn.loading.spin[t.size].blocksize,height:PF.fn.loading.spin[t.size].blocksize}).spin(PF.fn.loading.spin[t.size]),t.center&&$(".loading-indicator",e.css("textAlign","center")).css({position:t.position,top:"50%",left:"50%",marginTop:-PF.fn.loading.spin[t.size].blocksize/2,marginLeft:-PF.fn.loading.spin[t.size].blocksize/2}),"center"==t.valign&&$(".loading-indicator,.loading-text",e).css("marginTop",(e.height()-PF.fn.loading.spin[t.size].blocksize)/2+"px"),$(".spinner",e).css({top:PF.fn.loading.spin[t.size].blocksize/2+"px",left:PF.fn.loading.spin[t.size].blocksize/2+"px"})}},fullscreen:function(){$("body").append('<div class="fullscreen" id="pf-fullscreen-loader"><div class="fullscreen-loader black-bkg"><span class="loading-txt">'+PF.fn._s("loading")+"</span></div></div>"),$(".fullscreen-loader","#pf-fullscreen-loader").spin(PF.fn.loading.spin.huge),$(".spinner","#pf-fullscreen-loader").css({top:"50%",left:"50%"}),$("#pf-fullscreen-loader").css("opacity",1)},destroy:function(e){var t=$("#pf-fullscreen-loader"),o=$("#pf-onscreen-loader");(void 0!==(e="onscreen"==(e="fullscreen"==e?t:e)?o:e)?e:(t.remove(),o)).remove()}},jQuery.fn.disableForm=function(){return $(this).data("disabled",!0),$(":input",this).each(function(){$(this).attr("disabled",!0)}),this},jQuery.fn.enableForm=function(){return $(this).data("disabled",!1),$(":input",this).removeAttr("disabled"),this},PF.fn.isDevice=function(e){return e="object"==typeof e?"."+e.join(",."):"."+e,$("html").is(e)},PF.fn.getDeviceName=function(){var o;return $.each(PF.obj.devices,function(e,t){if(PF.fn.isDevice(t))return o=t,!0}),o},PF.fn.topMenu={vars:{$button:$("[data-action=top-bar-menu-full]","#top-bar"),menu:"#menu-fullscreen",speed:PF.obj.config.animation.fast,menu_top:parseInt($("#top-bar").outerHeight())+parseInt($("#top-bar").css("top"))+parseInt($("#top-bar").css("margin-top"))+parseInt($("#top-bar").css("margin-bottom"))-parseInt($("#top-bar").css("border-bottom-width"))+"px"},show:function(e){var t;$("body").is(":animated")||(void 0===e&&(e=this.vars.speed),this.vars.$button.addClass("current"),$("#top-bar").append($("<div/>",{id:"menu-fullscreen",class:"touch-scroll",html:$("<div/>",{class:"fullscreen black"})}).css({borderTopWidth:this.vars.menu_top,left:"-100%"}).append($("<ul/>",{html:$(".top-bar-left").html()+$(".top-bar-right").html()}))),t=$(this.vars.menu),$("li.phone-hide, li > .top-btn-text, li > .top-btn-text > span, li > a > .top-btn-text > span",t).each(function(){$(this).removeClass("phone-hide")}),$("[data-action=top-bar-menu-full]",t).remove(),$(".btn.black, .btn.default, .btn.blue, .btn.green, .btn.orange, .btn.red, .btn.transparent",t).removeClass("btn black default blue green orange red transparent"),setTimeout(function(){t.css({transform:"translate(100%, 0)"}),$(".fullscreen").css("opacity",1)},1),setTimeout(function(){$("html").css({backgroundColor:""})},this.vars.speed))},hide:function(e){var t;$("body").is(":animated")||$(this.vars.menu).is(":visible")&&(void 0===e&&(e=this.vars.speed),$("#top-bar").css("position",""),this.vars.$button.removeClass("current"),$("html").removeClass("menu-fullscreen-visible"),(t=$(this.vars.menu)).css({transform:"none"}),setTimeout(function(){t.remove()},e))}},function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){var o;if(e&&t)return-1==(o=(o=this._events=this._events||{})[e]=o[e]||[]).indexOf(t)&&o.push(t),this},t.once=function(e,t){var o;if(e&&t)return this.on(e,t),((o=this._onceEvents=this._onceEvents||{})[e]=o[e]||{})[t]=!0,this},t.off=function(e,t){e=this._events&&this._events[e];if(e&&e.length)return-1!=(t=e.indexOf(t))&&e.splice(t,1),this},t.emitEvent=function(e,t){var o=this._events&&this._events[e];if(o&&o.length){o=o.slice(0),t=t||[];for(var i=this._onceEvents&&this._onceEvents[e],n=0;n<o.length;n++){var a=o[n];i&&i[a]&&(this.off(e,a),delete i[a]),a.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(t,o){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(e){return o(t,e)}):"object"==typeof module&&module.exports?module.exports=o(t,require("ev-emitter")):t.imagesLoaded=o(t,t.EvEmitter)}("undefined"!=typeof window?window:this,function(t,e){function a(e,t){for(var o in t)e[o]=t[o];return e}function s(e,t,o){var i,n;return this instanceof s?(i="string"==typeof(i=e)?document.querySelectorAll(e):i)?(this.elements=(n=i,Array.isArray(n)?n:"object"==typeof n&&"number"==typeof n.length?d.call(n):[n]),this.options=a({},this.options),"function"==typeof t?o=t:a(this.options,t),o&&this.on("always",o),this.getImages(),r&&(this.jqDeferred=new r.Deferred),void setTimeout(this.check.bind(this))):void l.error("Bad element for imagesLoaded "+(i||e)):new s(e,t,o)}function o(e){this.img=e}function i(e,t){this.url=e,this.element=t,this.img=new Image}var r=t.jQuery,l=t.console,d=Array.prototype.slice,c=((s.prototype=Object.create(e.prototype)).options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&c[t]){for(var o=e.querySelectorAll("img"),i=0;i<o.length;i++){var n=o[i];this.addImage(n)}if("string"==typeof this.options.background)for(var a=e.querySelectorAll(this.options.background),i=0;i<a.length;i++){var s=a[i];this.addElementBackgroundImages(s)}}},{1:!0,9:!0,11:!0});return s.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var o=/url\((['"])?(.*?)\1\)/gi,i=o.exec(t.backgroundImage);null!==i;){var n=i&&i[2];n&&this.addBackground(n,e),i=o.exec(t.backgroundImage)}},s.prototype.addImage=function(e){e=new o(e);this.images.push(e)},s.prototype.addBackground=function(e,t){e=new i(e,t);this.images.push(e)},s.prototype.check=function(){function t(e,t,o){setTimeout(function(){i.progress(e,t,o)})}var i=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},s.prototype.progress=function(e,t,o){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&l&&l.log("progress: "+o,e,t)},s.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred&&(e=this.hasAnyBroken?"reject":"resolve",this.jqDeferred[e](this))},(o.prototype=Object.create(e.prototype)).check=function(){return this.getIsImageComplete()?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},o.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},o.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},o.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},o.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},o.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},o.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},(i.prototype=Object.create(o.prototype)).check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},i.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},i.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},(s.makeJQueryPlugin=function(e){(e=e||t.jQuery)&&((r=e).fn.imagesLoaded=function(e,t){return new s(this,e,t).jqDeferred.promise(r(this))})})(),s}),function(_){_.fn.tipTip=function(i){var $,w,y,n={activation:"hover",keepAlive:!1,maxWidth:"200px",edgeOffset:6,defaultPosition:"bottom",delay:400,fadeIn:200,fadeOut:200,attribute:"title",content:!1,enter:function(){},afterEnter:function(){},exit:function(){},afterExit:function(){},cssClass:""};return _("#tiptip_holder").length<=0?($=_('<div id="tiptip_holder"></div>'),w=_('<div id="tiptip_content"></div>'),y=_('<div id="tiptip_arrow"></div>'),_("body").append($.html(w).prepend(y.html('<div id="tiptip_arrow_inner"></div>')))):($=_("#tiptip_holder"),w=_("#tiptip_content"),y=_("#tiptip_arrow")),this.each(function(){var m=_(this),e=m.data("tipTip"),g=e&&e.options||_.extend(n,i),b={holder:$,content:w,arrow:y,options:g};if(e)switch(i){case"show":t();break;case"hide":o();break;case"destroy":m.unbind(".tipTip").removeData("tipTip")}else{var v=!1;m.data("tipTip",{options:g}),"hover"==g.activation?m.bind("mouseenter.tipTip",function(){t()}).bind("mouseleave.tipTip",function(){g.keepAlive?$.one("mouseleave.tipTip",function(){o()}):o()}):"focus"==g.activation?m.bind("focus.tipTip",function(){t()}).bind("blur.tipTip",function(){o()}):"click"==g.activation?m.bind("click.tipTip",function(e){return e.preventDefault(),t(),!1}).bind("mouseleave.tipTip",function(){g.keepAlive?$.one("mouseleave.tipTip",function(){o()}):o()}):g.activation}function t(){var e,t,o,i,n,a,s,r,l,d,c,u,f,p,h;!1!==g.enter.call(m,b)&&(g.content?e=_.isFunction(g.content)?g.content.call(m,b):g.content:(e=g.content=m.attr(g.attribute),m.removeAttr(g.attribute)),e)&&(w.html(e),$.hide().removeAttr("class").css({margin:"0px","max-width":g.maxWidth}),g.cssClass&&$.addClass(g.cssClass),y.removeAttr("style"),e=parseInt(m.offset().top),t=parseInt(m.offset().left),p=parseInt(m.outerWidth()),o=parseInt(m.outerHeight()),i=$.outerWidth(),n=$.outerHeight(),a=Math.round((p-i)/2),s=Math.round((o-n)/2),r=Math.round(t+a),l=Math.round(e+o+g.edgeOffset),c=d="",u=Math.round(i-12)/2,"bottom"==g.defaultPosition?d="_bottom":"top"==g.defaultPosition?d="_top":"left"==g.defaultPosition?d="_left":"right"==g.defaultPosition&&(d="_right"),f=a+t<parseInt(_(window).scrollLeft()),h=i+t>parseInt(_(window).width()),f&&a<0||"_right"==d&&!h||"_left"==d&&t<i+g.edgeOffset+5?(d="_right",c=Math.round(n-13)/2,u=-12,r=Math.round(t+p+g.edgeOffset),l=Math.round(e+s)):(h&&a<0||"_left"==d&&!f)&&(d="_left",c=Math.round(n-13)/2,u=Math.round(i),r=Math.round(t-(i+g.edgeOffset+5)),l=Math.round(e+s)),p=e+o+g.edgeOffset+n+8>parseInt(_(window).height()+_(window).scrollTop()),h=e+o-(g.edgeOffset+n+8)<0,p||"_bottom"==d&&p||"_top"==d&&!h?("_top"==d||"_bottom"==d?d="_top":d+="_top",c=n,l=Math.round(e-(n+5+g.edgeOffset))):(h|("_top"==d&&h)||"_bottom"==d&&!p)&&("_top"==d||"_bottom"==d?d="_bottom":d+="_bottom",c=-12,l=Math.round(e+o+g.edgeOffset)),"_right_top"==d||"_left_top"==d?l+=5:"_right_bottom"!=d&&"_left_bottom"!=d||(l-=5),"_left_top"!=d&&"_left_bottom"!=d||(r+=5),y.css({"margin-left":u+"px","margin-top":c+"px"}),$.css({"margin-left":r+"px","margin-top":l+"px"}).addClass("tip"+d),v&&clearTimeout(v),v=setTimeout(function(){$.stop(!0,!0).fadeIn(g.fadeIn)},g.delay),g.afterEnter.call(m,b))}function o(){!1!==g.exit.call(m,b)&&(v&&clearTimeout(v),$.fadeOut(g.fadeOut),g.afterExit.call(m,b))}})}}(jQuery),function(e){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)}(function(ne){var ae="left",se="right",re="up",le="down",de="in",ce="out",ue="none",fe="auto",pe="swipe",he="pinch",me="tap",ge="doubletap",be="longtap",ve="horizontal",$e="vertical",we="all",ye=10,_e="start",Pe="move",Fe="end",je="cancel",Ce="ontouchstart"in window,xe="TouchSwipe";function i(A,l){var e=Ce||!l.fallbackToMouseEvents,t=e?"touchstart":"mousedown",o=e?"touchmove":"mousemove",i=e?"touchend":"mouseup",n=e?null:"mouseleave",a="touchcancel",d=0,c=null,u=0,f=0,p=0,h=1,m=0,g=0,b=null,s=ne(A),v="start",$=0,w=null,r=0,y=0,_=0,P=0,F=0,j=null;try{s.bind(t,C),s.bind(a,k)}catch(e){ne.error("events not supported "+t+","+a+" on jQuery.swipe")}function C(e){var t,o,i;if(!0!==s.data(xe+"_intouch")&&!(0<ne(e.target).closest(l.excludedElements,s).length))return t=e.originalEvent||e,i=Ce?t.touches[0]:t,v=_e,Ce?$=t.touches.length:e.preventDefault(),g=c=null,h=1,m=p=f=u=d=0,w=function(){for(var e=[],t=0;t<=5;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return e}(),(e={})[ae]=E(ae),e[se]=E(se),e[re]=E(re),e[le]=E(le),b=e,G(),!Ce||$===l.fingers||l.fingers===we||T()?(K(0,i),r=O(),2==$&&(K(1,t.touches[1]),f=p=ie(w[0].start,w[1].start)),(l.swipeStatus||l.pinchStatus)&&(o=S(t,v))):o=!1,!1===o?(S(t,v=je),o):(I(!0),null)}function x(e){var t=e.originalEvent||e;if(v!==Fe&&v!==je&&!Z()){var o,i=ee(Ce?t.touches[0]:t);if(y=O(),Ce&&($=t.touches.length),v=Pe,2==$&&(0==f?(K(1,t.touches[1]),f=p=ie(w[0].start,w[1].start)):(ee(t.touches[1]),p=ie(w[0].end,w[1].end),w[0].end,w[1].end,g=h<1?ce:de),h=(p/f*1).toFixed(2),m=Math.abs(f-p)),$===l.fingers||l.fingers===we||!Ce||T()){c=function(e,t){e=function(e,t){var o=e.x-t.x,t=t.y-e.y,e=Math.atan2(t,o),t=Math.round(180*e/Math.PI);t<0&&(t=360-Math.abs(t));return t}(e,t);return e<=45&&0<=e||e<=360&&315<=e?ae:135<=e&&e<=225?se:45<e&&e<135?le:re}(i.start,i.end);var n,a,s=e,e=c;if(l.allowPageScroll===ue||T())s.preventDefault();else{var r=l.allowPageScroll===fe;switch(e){case ae:(l.swipeLeft&&r||!r&&l.allowPageScroll!=ve)&&s.preventDefault();break;case se:(l.swipeRight&&r||!r&&l.allowPageScroll!=ve)&&s.preventDefault();break;case re:(l.swipeUp&&r||!r&&l.allowPageScroll!=$e)&&s.preventDefault();break;case le:(l.swipeDown&&r||!r&&l.allowPageScroll!=$e)&&s.preventDefault()}}e=i.start,n=i.end,d=Math.round(Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))),u=oe(),n=c,e=d,e=Math.max(e,te(n)),b[n].distance=e,(l.swipeStatus||l.pinchStatus)&&(o=S(t,v)),l.triggerOnTouchEnd&&!l.triggerOnTouchLeave||(n=!0,l.triggerOnTouchLeave&&(a={left:(a=(e=ne(e=this)).offset()).left,right:a.left+e.outerWidth(),top:a.top,bottom:a.top+e.outerHeight()},e=i.end,i=a,n=e.x>i.left&&e.x<i.right&&e.y>i.top&&e.y<i.bottom),!l.triggerOnTouchEnd&&n?v=L(Pe):l.triggerOnTouchLeave&&!n&&(v=L(Fe)),v!=je&&v!=Fe)||S(t,v)}else S(t,v=je);!1===o&&S(t,v=je)}}function H(e){var t=e.originalEvent;return Ce&&0<t.touches.length?(_=O(),P=event.touches.length+1,!0):(Z()&&($=P),e.preventDefault(),y=O(),u=oe(),D()?S(t,v=je):l.triggerOnTouchEnd||0==l.triggerOnTouchEnd&&v===Pe?S(t,v=Fe):!l.triggerOnTouchEnd&&X()?V(t,v=Fe,me):v===Pe&&S(t,v=je),I(!1),null)}function k(){p=f=r=y=$=0,G(),I(!(h=1))}function q(e){e=e.originalEvent;l.triggerOnTouchLeave&&S(e,v=L(Fe))}function z(){s.unbind(t,C),s.unbind(a,k),s.unbind(o,x),s.unbind(i,H),n&&s.unbind(n,q),I(!1)}function L(e){var t=e,o=R(),i=M(),n=D();return!o||n?t=je:!i||e!=Pe||l.triggerOnTouchEnd&&!l.triggerOnTouchLeave?!i&&e==Fe&&l.triggerOnTouchLeave&&(t=je):t=Fe,t}function S(e,t){var o=void 0;return N()&&B()||B()?o=V(e,t,pe):(U()&&T()||T())&&!1!==o&&(o=V(e,t,he)),Y()&&J()&&!1!==o?o=V(e,t,ge):u>l.longTapThreshold&&d<ye&&l.longTap&&!1!==o?o=V(e,t,be):1!==$&&Ce||!isNaN(d)&&0!==d||!X()||!1===o||(o=V(e,t,me)),t===je&&k(),t!==Fe||Ce&&0!=e.touches.length||k(),o}function V(e,t,o){var i=void 0;if(o==pe){if(s.trigger("swipeStatus",[t,c||null,d||0,u||0,$]),l.swipeStatus&&!1===(i=l.swipeStatus.call(s,e,t,c||null,d||0,u||0,$)))return!1;if(t==Fe&&N()){if(s.trigger("swipe",[c,d,u,$]),l.swipe&&!1===(i=l.swipe.call(s,e,c,d,u,$)))return!1;switch(c){case ae:s.trigger("swipeLeft",[c,d,u,$]),l.swipeLeft&&(i=l.swipeLeft.call(s,e,c,d,u,$));break;case se:s.trigger("swipeRight",[c,d,u,$]),l.swipeRight&&(i=l.swipeRight.call(s,e,c,d,u,$));break;case re:s.trigger("swipeUp",[c,d,u,$]),l.swipeUp&&(i=l.swipeUp.call(s,e,c,d,u,$));break;case le:s.trigger("swipeDown",[c,d,u,$]),l.swipeDown&&(i=l.swipeDown.call(s,e,c,d,u,$))}}}if(o==he){if(s.trigger("pinchStatus",[t,g||null,m||0,u||0,$,h]),l.pinchStatus&&!1===(i=l.pinchStatus.call(s,e,t,g||null,m||0,u||0,$,h)))return!1;if(t==Fe&&U())switch(g){case de:s.trigger("pinchIn",[g||null,m||0,u||0,$,h]),l.pinchIn&&(i=l.pinchIn.call(s,e,g||null,m||0,u||0,$,h));break;case ce:s.trigger("pinchOut",[g||null,m||0,u||0,$,h]),l.pinchOut&&(i=l.pinchOut.call(s,e,g||null,m||0,u||0,$,h))}}return o==me?t!==je&&t!==Fe||(clearTimeout(j),J()&&!Y()?(F=O(),j=setTimeout(ne.proxy(function(){F=null,s.trigger("tap",[e.target]),l.tap&&(i=l.tap.call(s,e,e.target))},this),l.doubleTapThreshold)):(F=null,s.trigger("tap",[e.target]),l.tap&&(i=l.tap.call(s,e,e.target)))):o==ge?t!==je&&t!==Fe||(clearTimeout(j),F=null,s.trigger("doubletap",[e.target]),l.doubleTap&&(i=l.doubleTap.call(s,e,e.target))):o!=be||t!==je&&t!==Fe||(clearTimeout(j),F=null,s.trigger("longtap",[e.target]),l.longTap&&(i=l.longTap.call(s,e,e.target))),i}function M(){var e=!0;return e=null!==l.threshold?d>=l.threshold:e}function D(){var e=!1;return e=null!==l.cancelThreshold&&null!==c?te(c)-d>=l.cancelThreshold:e}function R(){var e=!(l.maxTimeThreshold&&u>=l.maxTimeThreshold);return e}function U(){var e=W(),t=Q(),o=null===l.pinchThreshold||m>=l.pinchThreshold;return e&&t&&o}function T(){return l.pinchStatus||l.pinchIn||l.pinchOut}function N(){var e=R(),t=M(),o=W(),i=Q();return!D()&&i&&o&&t&&e}function B(){return l.swipe||l.swipeStatus||l.swipeLeft||l.swipeRight||l.swipeUp||l.swipeDown}function W(){return $===l.fingers||l.fingers===we||!Ce}function Q(){return 0!==w[0].end.x}function X(){return l.tap}function J(){return!!l.doubleTap}function Y(){var e;return null!=F&&(e=O(),J())&&e-F<=l.doubleTapThreshold}function G(){P=_=0}function Z(){var e=!1;return e=_&&O()-_<=l.fingerReleaseThreshold?!0:e}function I(e){!0===e?(s.bind(o,x),s.bind(i,H),n&&s.bind(n,q)):(s.unbind(o,x,!1),s.unbind(i,H,!1),n&&s.unbind(n,q,!1)),s.data(xe+"_intouch",!0===e)}function K(e,t){var o=void 0!==t.identifier?t.identifier:0;w[e].identifier=o,w[e].start.x=w[e].end.x=t.pageX||t.clientX,w[e].start.y=w[e].end.y=t.pageY||t.clientY,w[e]}function ee(e){var t=function(e){for(var t=0;t<w.length;t++)if(w[t].identifier==e)return w[t]}(void 0!==e.identifier?e.identifier:0);return t.end.x=e.pageX||e.clientX,t.end.y=e.pageY||e.clientY,t}function te(e){if(b[e])return b[e].distance}function E(e){return{direction:e,distance:0}}function oe(){return y-r}function ie(e,t){var o=Math.abs(e.x-t.x),e=Math.abs(e.y-t.y);return Math.round(Math.sqrt(o*o+e*e))}function O(){return(new Date).getTime()}this.enable=function(){return s.bind(t,C),s.bind(a,k),s},this.disable=function(){return z(),s},this.destroy=function(){return z(),s.data(xe,null),s},this.option=function(e,t){if(void 0!==l[e]){if(void 0===t)return l[e];l[e]=t}else ne.error("Option "+e+" does not exist on jQuery.swipe.options");return null}}ne.fn.swipe=function(e){var t=ne(this),o=t.data(xe);if(o&&"string"==typeof e){if(o[e])return o[e].apply(this,Array.prototype.slice.call(arguments,1));ne.error("Method "+e+" does not exist on jQuery.swipe")}else if(!(o||"object"!=typeof e&&e))return function(o){!o||void 0!==o.allowPageScroll||void 0===o.swipe&&void 0===o.swipeStatus||(o.allowPageScroll=ue);void 0!==o.click&&void 0===o.tap&&(o.tap=o.click);o=o||{};return o=ne.extend({},ne.fn.swipe.defaults,o),this.each(function(){var e,t=ne(this);t.data(xe)||(e=new i(this,o),t.data(xe,e))})}.apply(this,arguments);return t},ne.fn.swipe.defaults={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe"},ne.fn.swipe.phases={PHASE_START:_e,PHASE_MOVE:Pe,PHASE_END:Fe,PHASE_CANCEL:je},ne.fn.swipe.directions={LEFT:ae,RIGHT:se,UP:re,DOWN:le,IN:de,OUT:ce},ne.fn.swipe.pageScroll={NONE:ue,HORIZONTAL:ve,VERTICAL:$e,AUTO:fe},ne.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:we}}),function(l){"use strict";var t=l.URL||l.webkitURL;function d(e){return!!t&&t.createObjectURL(e)}function o(e){return!!t&&t.revokeObjectURL(e)}function c(e,t){!e||"blob:"!==e.slice(0,5)||t&&t.noRevoke||o(e)}function u(e,t,o,i){var n;return!!l.FileReader&&((n=new FileReader).onload=function(){t.call(n,this.result)},o&&(n.onabort=n.onerror=function(){o.call(n,this.error)}),(i=n[i||"readAsDataURL"])?(i.call(n,e),n):void 0)}function f(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"}function p(s,e,r){function t(o,i){var n,a=document.createElement("img");function t(e,t){o===i?o&&o(e,t):e instanceof Error?i(e):((t=t||{}).image=e,o(t))}function e(e,t){t&&l.console&&console.log(t),e&&f("Blob",e)?n=d(s=e):(n=s,r&&r.crossOrigin&&(a.crossOrigin=r.crossOrigin)),a.src=n}return a.onerror=function(e){c(n,r),i&&i.call(a,e)},a.onload=function(){c(n,r);var e={originalWidth:a.naturalWidth||a.width,originalHeight:a.naturalHeight||a.height};try{p.transform(a,r,t,s,e)}catch(e){i&&i(e)}},"string"==typeof s?(p.requiresMetaData(r)?p.fetchBlob(s,e,r):e(),a):f("Blob",s)||f("File",s)?(n=d(s))?(a.src=n,a):u(s,function(e){a.src=e},i):void 0}return l.Promise&&"function"!=typeof e?(r=e,new Promise(t)):t(e,e)}p.requiresMetaData=function(e){return e&&e.meta},p.fetchBlob=function(e,t){t()},p.transform=function(e,t,o,i,n){o(e,n)},p.global=l,p.readFile=u,p.isInstanceOf=f,p.createObjectURL=d,p.revokeObjectURL=o,"function"==typeof define&&define.amd?define(function(){return p}):"object"==typeof module&&module.exports?module.exports=p:l.loadImage=p}("undefined"!=typeof window&&window||this),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof module&&module.exports?e(require("./load-image")):e(window.loadImage)}(function(s){"use strict";var r=s.global,l=s.transform,i=r.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),h=r.ArrayBuffer&&ArrayBuffer.prototype.slice||function(e,t){t=t||this.byteLength-e;e=new Uint8Array(this,e,t),t=new Uint8Array(t);return t.set(e),t.buffer},m={jpeg:{65505:[],65517:[]}};function d(t,e,u,f){var p=this;function o(d,c){if(!(r.DataView&&i&&t&&12<=t.size&&"image/jpeg"===t.type))return d(f);var e=u.maxMetaDataSize||262144;s.readFile(i.call(t,0,e),function(e){var t=new DataView(e);if(65496!==t.getUint16(0))return c(new Error("Invalid JPEG file: Missing JPEG marker."));for(var o,i,n,a,s=2,r=t.byteLength-4,l=s;s<r&&(65504<=(o=t.getUint16(s))&&o<=65519||65534===o);){if(s+(i=t.getUint16(s+2)+2)>t.byteLength){console.log("Invalid JPEG metadata: Invalid segment size.");break}if((n=m.jpeg[o])&&!u.disableMetaDataParsers)for(a=0;a<n.length;a+=1)n[a].call(p,t,s,i,f,u);l=s+=i}!u.disableImageHead&&6<l&&(f.imageHead=h.call(e,0,l)),d(f)},c,"readAsArrayBuffer")||d(f)}return u=u||{},r.Promise&&"function"!=typeof e?(f=u=e||{},new Promise(o)):(f=f||{},o(e,e))}function n(e,t,o){return e&&t&&o?new Blob([o,i.call(e,t.byteLength)],{type:"image/jpeg"}):null}s.transform=function(t,o,i,n,a){s.requiresMetaData(o)?d(n,function(e){e!==a&&(r.console&&console.log(e),e=a),l.call(s,t,o,i,n,e)},o,a=a||{}):l.apply(s,arguments)},s.blobSlice=i,s.bufferSlice=h,s.replaceHead=function(t,o,i){var e={maxMetaDataSize:1024,disableMetaDataParsers:!0};if(!i&&r.Promise)return d(t,e).then(function(e){return n(t,e.imageHead,o)});d(t,function(e){i(n(t,e.imageHead,o))},e)},s.parseMetaData=d,s.metaDataParsers=m}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof module&&module.exports?e(require("./load-image")):e(window.loadImage)}(function(y){"use strict";var a=y.transform;y.createCanvas=function(e,t,o){return o&&y.global.OffscreenCanvas?new OffscreenCanvas(e,t):((o=document.createElement("canvas")).width=e,o.height=t,o)},y.transform=function(e,t,o,i,n){a.call(y,y.scale(e,t,n),t,o,i,n)},y.transformCoordinates=function(){},y.getTransformedOptions=function(e,t){var o,i,n,a=t.aspectRatio;if(!a)return t;for(i in o={},t)Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o.crop=!0,a<(n=e.naturalWidth||e.width)/(e=e.naturalHeight||e.height)?(o.maxWidth=e*a,o.maxHeight=e):(o.maxWidth=n,o.maxHeight=n/a),o},y.drawImage=function(e,t,o,i,n,a,s,r,l){t=t.getContext("2d");return!1===l.imageSmoothingEnabled?(t.msImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1):l.imageSmoothingQuality&&(t.imageSmoothingQuality=l.imageSmoothingQuality),t.drawImage(e,o,i,n,a,0,0,s,r),t},y.requiresCanvas=function(e){return e.canvas||e.crop||!!e.aspectRatio},y.scale=function(e,t,o){t=t||{},o=o||{};var i,n,a,s,r,l,d,c,u,f,p,h=e.getContext||y.requiresCanvas(t)&&!!y.global.HTMLCanvasElement,m=e.naturalWidth||e.width,g=e.naturalHeight||e.height,b=m,v=g;function $(){var e=Math.max((a||b)/b,(s||v)/v);1<e&&(b*=e,v*=e)}function w(){var e=Math.min((i||b)/b,(n||v)/v);e<1&&(b*=e,v*=e)}if(h&&(d=(t=y.getTransformedOptions(e,t,o)).left||0,c=t.top||0,t.sourceWidth?(r=t.sourceWidth,void 0!==t.right&&void 0===t.left&&(d=m-r-t.right)):r=m-d-(t.right||0),t.sourceHeight?(l=t.sourceHeight,void 0!==t.bottom&&void 0===t.top&&(c=g-l-t.bottom)):l=g-c-(t.bottom||0),b=r,v=l),i=t.maxWidth,n=t.maxHeight,a=t.minWidth,s=t.minHeight,h&&i&&n&&t.crop?(f=r/l-(b=i)/(v=n))<0?(l=n*r/i,void 0===t.top&&void 0===t.bottom&&(c=(g-l)/2)):0<f&&(r=i*l/n,void 0===t.left)&&void 0===t.right&&(d=(m-r)/2):((t.contain||t.cover)&&(a=i=i||a,s=n=n||s),(t.cover?(w(),$):($(),w))()),h){if(1<(h=t.pixelRatio)&&(!e.style.width||Math.floor(parseFloat(e.style.width,10))!==Math.floor(m/h))&&(b*=h,v*=h),y.orientationCropBug&&!e.getContext&&(d||c||r!==m||l!==g)&&(f=e,e=y.createCanvas(m,g,!0),y.drawImage(f,e,0,0,m,g,m,g,t)),0<(u=t.downsamplingRatio)&&u<1&&b<r&&v<l)for(;b<r*u;)p=y.createCanvas(r*u,l*u,!0),y.drawImage(e,p,d,c,r,l,p.width,p.height,t),c=d=0,r=p.width,l=p.height,e=p;return p=y.createCanvas(b,v),y.transformCoordinates(p,t,o),1<h&&(p.style.width=p.width/h+"px"),y.drawImage(e,p,d,c,r,l,b,v,t).setTransform(1,0,0,1,0,0),p}return e.width=b,e.height=v,e}}),function(e){"use strict";var t=e.History=e.History||{},i=e.jQuery;if(void 0!==t.Adapter)throw new Error("History.js Adapter has already been loaded...");t.Adapter={bind:function(e,t,o){i(e).bind(t,o)},trigger:function(e,t,o){i(e).trigger(t,o)},extractEventData:function(e,t,o){return t&&t.originalEvent&&t.originalEvent[e]||o&&o[e]||void 0},onDomLoad:function(e){i(e)}},void 0!==t.init&&t.init()}(window),function(n,o){"use strict";var r=n.console||o,l=n.document,i=n.navigator,a=n.sessionStorage||!1,s=n.setTimeout,d=n.clearTimeout,c=n.setInterval,u=n.clearInterval,f=n.JSON,p=n.alert,h=n.History=n.History||{},m=n.history;try{a.setItem("TEST","1"),a.removeItem("TEST")}catch(e){a=!1}if(f.stringify=f.stringify||f.encode,f.parse=f.parse||f.decode,void 0!==h.init)throw new Error("History.js Core has already been loaded...");h.init=function(e){return void 0!==h.Adapter&&(void 0!==h.initCore&&h.initCore(),void 0!==h.initHtml4&&h.initHtml4(),!0)},h.initCore=function(e){if(void 0!==h.initCore.initialized)return!1;var t;if(h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.disableSuid=h.options.disableSuid||!1,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||l.title,h.options.html4Mode=h.options.html4Mode||!1,h.options.delayInit=h.options.delayInit||!1,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if(null!=t){for(e=0;e<t.length;e++)u(t[e]);h.intervalList=null}},h.debug=function(){h.options.debug&&h.log.apply(h,arguments)},h.log=function(){var e,t,o,i,n,a=void 0!==r&&void 0!==r.log&&void 0!==r.log.apply,s=l.getElementById("log");for(a?(e=(i=Array.prototype.slice.call(arguments)).shift(),(void 0!==r.debug?r.debug:r.log).apply(r,[e,i])):e="\n"+arguments[0]+"\n",t=1,o=arguments.length;t<o;++t){if("object"==typeof(n=arguments[t])&&void 0!==f)try{n=f.stringify(n)}catch(e){}e+="\n"+n+"\n"}return s?(s.value+=e+"\n-----\n",s.scrollTop=s.scrollHeight-s.clientHeight):a||p(e),!0},h.getInternetExplorerMajorVersion=function(){return h.getInternetExplorerMajorVersion.cached=void 0!==h.getInternetExplorerMajorVersion.cached?h.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=l.createElement("div"),o=t.getElementsByTagName("i");(t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e")&&o[0];);return 4<e&&e}()},h.isInternetExplorer=function(){return h.isInternetExplorer.cached=void 0!==h.isInternetExplorer.cached?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion())},h.options.html4Mode?h.emulated={pushState:!0,hashChange:!0}:h.emulated={pushState:!Boolean(n.history&&n.history.pushState&&n.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!("onhashchange"in n||"onhashchange"in l)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&"Apple Computer, Inc."===i.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&"Apple Computer, Inc."===i.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},h.cloneObject=function(e){e=e?(e=f.stringify(e),f.parse(e)):{};return e},h.getRootUrl=function(){var e=l.location.protocol+"//"+(l.location.hostname||l.location.host);return l.location.port&&(e+=":"+l.location.port),e+="/"},h.getBaseHref=function(){var e=l.getElementsByTagName("base"),t="";return(t=(t=1===e.length?e[0].href.replace(/[^\/]+$/,""):t).replace(/\/+$/,""))&&(t+="/"),t},h.getBaseUrl=function(){return h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl()},h.getPageUrl=function(){return((h.getState(!1,!1)||{}).url||h.getLocationHref()).replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,o){return/\./.test(e)?e:e+"/"})},h.getBasePageUrl=function(){return h.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,o){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/"},h.getFullUrl=function(e,t){var o=e,i=e.substring(0,1);return t=void 0===t||t,(o=/[a-z]+\:\/\//.test(e)?o:"/"===i?h.getRootUrl()+e.replace(/^\/+/,""):"#"===i?h.getPageUrl().replace(/#.*/,"")+e:"?"===i?h.getPageUrl().replace(/[\?#].*/,"")+e:t?h.getBaseUrl()+e.replace(/^(\.\/)+/,""):h.getBasePageUrl()+e.replace(/^(\.\/)+/,"")).replace(/\#$/,"")},h.getShortUrl=function(e){var t=h.getBaseUrl(),o=h.getRootUrl(),e=(e=h.emulated.pushState?e.replace(t,""):e).replace(o,"/");return e=(e=h.isTraditionalAnchor(e)?"./"+e:e).replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},h.getLocationHref=function(e){return(e=e||l).URL===e.location.href?e.location.href:e.location.href===decodeURIComponent(e.URL)?e.URL:(!e.location.hash||decodeURIComponent(e.location.href.replace(/^[^#]+/,""))!==e.location.hash)&&(-1!=e.URL.indexOf("#")||-1==e.location.href.indexOf("#"))&&e.URL||e.location.href},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var o=h.getLastSavedState();return!o&&t&&(o=h.createStateObject()),e&&((o=h.cloneObject(o)).url=o.cleanUrl||o.url),o},h.getIdByState=function(e){var t,o=h.extractId(e.url);if(!o)if(t=h.getStateString(e),void 0!==h.stateToId[t])o=h.stateToId[t];else if(void 0!==h.store.stateToId[t])o=h.store.stateToId[t];else{for(;o=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),void 0!==h.idToState[o]||void 0!==h.store.idToState[o];);h.stateToId[t]=o,h.idToState[o]=e}return o},h.normalizeState=function(e){var t;return void 0!==(e=e&&"object"==typeof e?e:{}).normalized?e:(e.data&&"object"==typeof e.data||(e.data={}),(t={normalized:!0}).title=e.title||"",t.url=h.getFullUrl(e.url||h.getLocationHref()),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,e=!h.isEmptyObject(t.data),(t.title||e)&&!0!==h.options.disableSuid&&(t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id),t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t)},h.createStateObject=function(e,t,o){return h.normalizeState({data:e,title:t,url:o})},h.getStateById=function(e){return e=String(e),h.idToState[e]||h.store.idToState[e]||o},h.getStateString=function(e){e={data:h.normalizeState(e).data,title:e.title,url:e.url};return f.stringify(e)},h.getStateId=function(e){return h.normalizeState(e).id},h.getHashByState=function(e){return h.normalizeState(e).hash},h.extractId=function(e){e=-1!=e.indexOf("#")?e.split("#")[0]:e,e=/(.*)\&_suid=([0-9]+)$/.exec(e);e&&e[1];return(e?String(e[2]||""):"")||!1},h.isTraditionalAnchor=function(e){return!/[\/\?\.]/.test(e)},h.extractState=function(e,t){var o,i,n=null;return t=t||!1,(n=(o=h.extractId(e))?h.getStateById(o):n)||(i=h.getFullUrl(e),(n=(o=h.getIdByUrl(i)||!1)?h.getStateById(o):n)||!t||h.isTraditionalAnchor(e)||(n=h.createStateObject(null,null,i))),n},h.getIdByUrl=function(e){return h.urlToId[e]||h.store.urlToId[e]||o},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||o},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||o},h.hasUrlDuplicate=function(e){var t=h.extractState(e.url);return t&&t.id!==e.id},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t=!1;return t=h.savedStates.length?e.id===h.getLastSavedState().id:t},h.saveState=function(e){return!h.isLastSavedState(e)&&(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){return void 0===e?h.savedStates[h.savedStates.length-1]:e<0?h.savedStates[h.savedStates.length+e]:h.savedStates[e]},h.getCurrentIndex=function(){return h.savedStates.length<1?0:h.savedStates.length-1},h.getHash=function(e){e=h.getLocationHref(e);return h.getHashByUrl(e)},h.unescapeHash=function(e){e=h.normalizeHash(e);return decodeURIComponent(e)},h.normalizeHash=function(e){return e.replace(/[^#]*#/,"").replace(/#.*/,"")},h.setHash=function(e,t){return!1!==t&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(h.busy(!0),(t=h.extractState(e,!0))&&!h.emulated.pushState?h.pushState(t.data,t.title,t.url,!1):h.getHash()!==e&&(h.bugs.setHash?(t=h.getPageUrl(),h.pushState(null,null,t+"#"+e,!1)):l.location.hash=e),h)},h.escapeHash=function(e){e=h.normalizeHash(e),e=n.encodeURIComponent(e);return e=h.bugs.hashEscape?e:e.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")},h.getHashByUrl=function(e){e=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return h.unescapeHash(e)},h.setTitle=function(e){var t,o=e.title;o||(t=h.getStateByIndex(0))&&t.url===e.url&&(o=t.title||h.options.initialTitle);try{l.getElementsByTagName("title")[0].innerHTML=o.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return l.title=o,h},h.queues=[],h.busy=function(e){var o;return void 0!==e?h.busy.flag=e:void 0===h.busy.flag&&(h.busy.flag=!1),h.busy.flag||(d(h.busy.timeout),h.busy.timeout=s(o=function(){var e,t;if(!h.busy.flag)for(e=h.queues.length-1;0<=e;--e)0!==(t=h.queues[e]).length&&(t=t.shift(),h.fireQueueItem(t),h.busy.timeout=s(o,h.options.busyDelay))},h.options.busyDelay)),h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return"function"==typeof e&&(e={callback:e}),void 0!==t&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(d(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=s(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var e=h.extractState(h.getLocationHref());if(!h.isLastSavedState(e))return e||h.createStateObject(),h.Adapter.trigger(n,"popstate"),h},h.back=function(e){return!1!==e&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),m.go(-1),!0)},h.forward=function(e){return!1!==e&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),m.go(1),!0)},h.go=function(e,t){var o;if(0<e)for(o=1;o<=e;++o)h.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(o=-1;e<=o;--o)h.back(t)}return h},h.emulated.pushState?(t=function(){},h.pushState=h.pushState||t,h.replaceState=h.replaceState||t):(h.onPopState=function(e,t){var o,i=!1;return h.doubleCheckComplete(),(o=h.getHash())?((o=h.extractState(o||h.getLocationHref(),!0))?h.replaceState(o.data,o.title,o.url,!1):(h.Adapter.trigger(n,"anchorchange"),h.busy(!1)),h.expectedStateId=!1):(i=(i=(o=h.Adapter.extractEventData("state",e,t)||!1)?h.getStateById(o):h.expectedStateId?h.getStateById(h.expectedStateId):h.extractState(h.getLocationHref()))||h.createStateObject(null,null,h.getLocationHref()),h.expectedStateId=!1,h.isLastSavedState(i)?(h.busy(!1),!1):(h.storeState(i),h.saveState(i),h.setTitle(i),h.Adapter.trigger(n,"statechange"),h.busy(!1),!0))},h.Adapter.bind(n,"popstate",h.onPopState),h.pushState=function(e,t,o,i){if(h.getHashByUrl(o)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==i&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:i}),!1;h.busy(!0);i=h.createStateObject(e,t,o);return h.isLastSavedState(i)?h.busy(!1):(h.storeState(i),h.expectedStateId=i.id,m.pushState(i.id,i.title,i.url),h.Adapter.trigger(n,"popstate")),!0},h.replaceState=function(e,t,o,i){if(h.getHashByUrl(o)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==i&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:i}),!1;h.busy(!0);i=h.createStateObject(e,t,o);return h.isLastSavedState(i)?h.busy(!1):(h.storeState(i),h.expectedStateId=i.id,m.replaceState(i.id,i.title,i.url),h.Adapter.trigger(n,"popstate")),!0}),a)try{h.store=f.parse(a.getItem("History.store"))||{}}catch(e){h.store={}}else h.store={};h.normalizeStore(),h.Adapter.bind(n,"unload",h.clearAllIntervals),h.saveState(h.storeState(h.extractState(h.getLocationHref(),!0))),a&&(h.onUnload=function(){var t,e,o;try{t=f.parse(a.getItem("History.store"))||{}}catch(e){t={}}for(e in t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{},h.idToState)h.idToState.hasOwnProperty(e)&&(t.idToState[e]=h.idToState[e]);for(e in h.urlToId)h.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=h.urlToId[e]);for(e in h.stateToId)h.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=h.stateToId[e]);h.store=t,h.normalizeStore(),o=f.stringify(t);try{a.setItem("History.store",o)}catch(e){if(e.code!==DOMException.QUOTA_EXCEEDED_ERR)throw e;a.length&&(a.removeItem("History.store"),a.setItem("History.store",o))}},h.intervalList.push(c(h.onUnload,h.options.storeInterval)),h.Adapter.bind(n,"beforeunload",h.onUnload),h.Adapter.bind(n,"unload",h.onUnload)),h.emulated.pushState||(h.bugs.safariPoll&&h.intervalList.push(c(h.safariStatePoll,h.options.safariPollInterval)),"Apple Computer, Inc."!==i.vendor&&"Mozilla"!==(i.appCodeName||""))||(h.Adapter.bind(n,"hashchange",function(){h.Adapter.trigger(n,"popstate")}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(n,"hashchange")}))},h.options&&h.options.delayInit||h.init()}(window),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(r){var o=0;r.ajaxTransport("iframe",function(n){var a,s,t;if(n.async)return{send:function(e,i){(a=r('<form style="display:none;"></form>')).attr("accept-charset",n.formAcceptCharset),t=/\?/.test(n.url)?"&":"?","DELETE"===n.type?(n.url=n.url+t+"_method=DELETE",n.type="POST"):"PUT"===n.type?(n.url=n.url+t+"_method=PUT",n.type="POST"):"PATCH"===n.type&&(n.url=n.url+t+"_method=PATCH",n.type="POST"),s=r('<iframe src="javascript:false;" name="iframe-transport-'+(o+=1)+'"></iframe>').bind("load",function(){var o,t=r.isArray(n.paramName)?n.paramName:[n.paramName];s.unbind("load").bind("load",function(){var t;try{if(!(t=s.contents()).length||!t[0].firstChild)throw new Error}catch(e){t=void 0}i(200,"success",{iframe:t}),r('<iframe src="javascript:false;"></iframe>').appendTo(a),window.setTimeout(function(){a.remove()},0)}),a.prop("target",s.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&r.each(n.formData,function(e,t){r('<input type="hidden"/>').prop("name",t.name).val(t.value).appendTo(a)}),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(o=n.fileInput.clone(),n.fileInput.after(function(e){return o[e]}),n.paramName&&n.fileInput.each(function(e){r(this).prop("name",t[e]||n.paramName)}),a.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),a.submit(),o&&o.length&&n.fileInput.each(function(e,t){e=r(o[e]);r(t).prop("name",e.prop("name")),e.replaceWith(t)})}),a.append(s).appendTo(document.body)},abort:function(){s&&s.unbind("load").prop("src","javascript".concat(":false;")),a&&a.remove()}}}),r.ajaxSetup({converters:{"iframe text":function(e){return e&&r(e[0].body).text()},"iframe json":function(e){return e&&r.parseJSON(r(e[0].body).text())},"iframe html":function(e){return e&&r(e[0].body).html()},"iframe xml":function(e){e=e&&e[0];return e&&r.isXMLDoc(e)?e:r.parseXML(e.XMLDocument&&e.XMLDocument.xml||r(e.body).html())},"iframe script":function(e){return e&&r.globalEval(r(e[0].body).text())}}})}),function(e,t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Spinner=t()}(this,function(){"use strict";function f(e,t){var o,i=document.createElement(e||"div");for(o in t)i[o]=t[o];return i}function u(e){for(var t=1,o=arguments.length;t<o;t++)e.appendChild(arguments[t]);return e}function i(e,t){var o,i,n=e.style;if(void 0!==n[t=t.charAt(0).toUpperCase()+t.slice(1)])return t;for(i=0;i<a.length;i++)if(void 0!==n[o=a[i]+t])return o}function p(e,t){for(var o in t)e.style[i(e,o)||o]=t[o];return e}function t(e){for(var t=1;t<arguments.length;t++){var o,i=arguments[t];for(o in i)void 0===e[o]&&(e[o]=i[o])}return e}function h(e,t){return"string"==typeof e?e:e[t%e.length]}function o(e){this.opts=t(e||{},o.defaults,n)}var m,g,e,a=["webkit","Moz","ms","O"],b={},n={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",shadow:!1,hwaccel:!1,position:"relative"};function d(e,t){return f("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}return o.defaults={},t(o.prototype,{spin:function(e){this.stop();var o,i,n,a,s,r,l,d=this,c=d.opts,u=d.el=f(null,{className:c.className});return p(u,{position:c.position,width:0,zIndex:c.zIndex,left:c.left,top:c.top}),e&&e.insertBefore(u,e.firstChild||null),u.setAttribute("role","progressbar"),d.lines(u,d.opts),m||(i=0,n=(c.lines-1)*(1-c.direction)/2,a=c.fps,s=a/c.speed,r=(1-c.opacity)/(s*c.trail/100),l=s/c.lines,function e(){i++;for(var t=0;t<c.lines;t++)o=Math.max(1-(i+(c.lines-t)*l)%s*r,c.opacity),d.opacity(u,t*c.direction+n,o,c);d.timeout=d.el&&setTimeout(e,~~(1e3/a))}()),d},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(e,o){function t(e,t){return p(f(),{position:"absolute",width:o.scale*(o.length+o.width)+"px",height:o.scale*o.width+"px",background:e,boxShadow:t,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*d+o.rotate)+"deg) translate("+o.scale*o.radius+"px,0)",borderRadius:(o.corners*o.scale*o.width>>1)+"px"})}for(var i,n,a,s,r,l,d=0,c=(o.lines-1)*(1-o.direction)/2;d<o.lines;d++)l=p(f(),{position:"absolute",top:1+~(o.scale*o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:m&&(i=o.opacity,n=o.trail,a=c+d*o.direction,s=o.lines,l=r=void 0,r=["opacity",n,~~(100*i),a,s].join("-"),a=.01+a/s*100,s=Math.max(1-(1-i)/n*(100-a),i),l=m.substring(0,m.indexOf("Animation")).toLowerCase(),b[r]||(g.insertRule("@"+(l&&"-"+l+"-"||"")+"keyframes "+r+"{0%{opacity:"+s+"}"+a+"%{opacity:"+i+"}"+(.01+a)+"%{opacity:1}"+(a+n)%100+"%{opacity:"+i+"}100%{opacity:"+s+"}}",g.cssRules.length),b[r]=1),r+" "+1/o.speed+"s linear infinite")}),o.shadow&&u(l,p(t("#000","0 0 4px #000"),{top:"2px"})),u(e,u(l,t(h(o.color,d),"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,o){t<e.childNodes.length&&(e.childNodes[t].style.opacity=o)}}),"undefined"!=typeof document&&(e=f("style",{type:"text/css"}),u(document.getElementsByTagName("head")[0],e),g=e.sheet||e.styleSheet,!i(e=p(f("group"),{behavior:"url(#default#VML)"}),"transform")&&e.adj?(g.addRule(".spin-vml","behavior:url(#default#VML)"),o.prototype.lines=function(e,i){function n(){return p(d("group",{coordsize:s+" "+s,coordorigin:-a+" "+-a}),{width:s,height:s})}function t(e,t,o){u(l,u(p(n(),{rotation:360/i.lines*e+"deg",left:~~t}),u(p(d("roundrect",{arcsize:i.corners}),{width:a,height:i.scale*i.width,left:i.scale*i.radius,top:-i.scale*i.width>>1,filter:o}),d("fill",{color:h(i.color,e),opacity:i.opacity}),d("stroke",{opacity:0}))))}var o,a=i.scale*(i.length+i.width),s=2*i.scale*a,r=-(i.width+i.length)*i.scale*2+"px",l=p(n(),{position:"absolute",top:r,left:r});if(i.shadow)for(o=1;o<=i.lines;o++)t(o,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(o=1;o<=i.lines;o++)t(o);return u(e,l)},o.prototype.opacity=function(e,t,o,i){e=e.firstChild;i=i.shadow&&i.lines||0,e&&t+i<e.childNodes.length&&(e=(e=(e=e.childNodes[t+i])&&e.firstChild)&&e.firstChild)&&(e.opacity=o)}):m=i(e,"animation")),o}),function(e){if("object"==typeof exports)e(require("jquery"),require("spin"));else if("function"==typeof define&&define.amd)define(["jquery","spin"],e);else{if(!window.Spinner)throw new Error("Spin.js not present");e(window.jQuery,window.Spinner)}}(function(n,a){n.fn.spin=function(o,i){return this.each(function(){var e=n(this),t=e.data();t.spinner&&(t.spinner.stop(),delete t.spinner),!1!==o&&(o=n.extend({color:i||e.css("color")},n.fn.spin.presets[o]||o),t.spinner=new a(o).spin(this))})},n.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),jQuery.fn.hasScrollBar=function(){var e={},t=this.get(0);return e.vertical=t.scrollHeight>t.clientHeight,e.horizontal=t.scrollWidth>t.clientWidth,e},function(i){function e(e,t){this.el=i(e),this.options=t||{},this.x=!1!==this.options.x||this.options.forceHorizontal,this.y=!1!==this.options.y||this.options.forceVertical,this.autoHide=!1!==this.options.autoHide,this.padding=null==this.options.padding?2:this.options.padding,this.inner=this.el.find(".antiscroll-inner"),this.inner.css({width:"+="+(this.y?a():0),height:"+="+(this.x?a():0)}),this.refresh()}function o(e){this.pane=e,this.pane.el.append(this.el),this.innerEl=this.pane.inner.get(0),this.dragging=!1,this.enter=!1,this.shown=!1,this.pane.el.mouseenter(i.proxy(this,"mouseenter")),this.pane.el.mouseleave(i.proxy(this,"mouseleave")),this.el.mousedown(i.proxy(this,"mousedown")),this.innerPaneScrollListener=i.proxy(this,"scroll"),this.pane.inner.scroll(this.innerPaneScrollListener),this.innerPaneMouseWheelListener=i.proxy(this,"mousewheel"),this.pane.inner.bind("mousewheel",this.innerPaneMouseWheelListener);e=this.pane.options.initialDisplay;!1!==e&&(this.show(),this.pane.autoHide)&&(this.hiding=setTimeout(i.proxy(this,"hide"),parseInt(e,10)||3e3))}function t(e,t){function o(){}o.prototype=t.prototype,e.prototype=new o}var n;function a(){var e,t,o;return void 0===n&&(e=i('<div class="antiscroll-inner" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div>'),i("body").append(e),t=i(e).innerWidth(),o=i("div",e).innerWidth(),i(e).remove(),n=t-o),n}i.fn.antiscroll=function(e){return this.each(function(){i(this).data("antiscroll")&&i(this).data("antiscroll").destroy(),i(this).data("antiscroll",new i.Antiscroll(this,e))})},(i.Antiscroll=e).prototype.refresh=function(){var e=this.inner.get(0).scrollWidth>this.el.width()+(this.y?a():0),t=this.inner.get(0).scrollHeight>this.el.height()+(this.x?a():0);this.x&&(!this.horizontal&&e?this.horizontal=new o.Horizontal(this):this.horizontal&&!e?(this.horizontal.destroy(),this.horizontal=null):this.horizontal&&this.horizontal.update()),this.y&&(!this.vertical&&t?this.vertical=new o.Vertical(this):this.vertical&&!t?(this.vertical.destroy(),this.vertical=null):this.vertical&&this.vertical.update())},e.prototype.destroy=function(){return this.horizontal&&(this.horizontal.destroy(),this.horizontal=null),this.vertical&&(this.vertical.destroy(),this.vertical=null),this},e.prototype.rebuild=function(){return this.destroy(),this.inner.attr("style",""),e.call(this,this.el,this.options),this},o.prototype.destroy=function(){return this.el.remove(),this.pane.inner.unbind("scroll",this.innerPaneScrollListener),this.pane.inner.unbind("mousewheel",this.innerPaneMouseWheelListener),this},o.prototype.mouseenter=function(){this.enter=!0,this.show()},o.prototype.mouseleave=function(){this.enter=!1,this.dragging||this.pane.autoHide&&this.hide()},o.prototype.scroll=function(){this.shown||(this.show(),this.enter)||this.dragging||this.pane.autoHide&&(this.hiding=setTimeout(i.proxy(this,"hide"),1500)),this.update()},o.prototype.mousedown=function(e){e.preventDefault(),this.dragging=!0,this.startPageY=e.pageY-parseInt(this.el.css("top"),10),this.startPageX=e.pageX-parseInt(this.el.css("left"),10),this.el[0].ownerDocument.onselectstart=function(){return!1};this.pane;var t=i.proxy(this,"mousemove"),o=this;i(this.el[0].ownerDocument).mousemove(t).mouseup(function(){o.dragging=!1,this.onselectstart=null,i(this).unbind("mousemove",t),o.enter||o.hide()})},o.prototype.show=function(e){!this.shown&&this.update()&&(this.el.addClass("antiscroll-scrollbar-shown"),this.hiding&&(clearTimeout(this.hiding),this.hiding=null),this.shown=!0)},o.prototype.hide=function(){!1!==this.pane.autoHide&&this.shown&&(this.el.removeClass("antiscroll-scrollbar-shown"),this.shown=!1)},t(o.Horizontal=function(e){this.el=i('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">',e.el),o.call(this,e)},o),o.Horizontal.prototype.update=function(){var e=this.pane.el.width(),t=e-2*this.pane.padding,o=this.pane.inner.get(0);return this.el.css("width",t*e/o.scrollWidth).css("left",t*o.scrollLeft/o.scrollWidth),e<o.scrollWidth},o.Horizontal.prototype.mousemove=function(e){var t=this.pane.el.width()-2*this.pane.padding,e=e.pageX-this.startPageX,o=this.el.width(),i=this.pane.inner.get(0),e=Math.min(Math.max(e,0),t-o);i.scrollLeft=(i.scrollWidth-this.pane.el.width())*e/(t-o)},o.Horizontal.prototype.mousewheel=function(e,t,o,i){if(o<0&&0==this.pane.inner.get(0).scrollLeft||0<o&&this.innerEl.scrollLeft+Math.ceil(this.pane.el.width())==this.innerEl.scrollWidth)return e.preventDefault(),!1},t(o.Vertical=function(e){this.el=i('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">',e.el),o.call(this,e)},o),o.Vertical.prototype.update=function(){var e=this.pane.el.height(),t=e-2*this.pane.padding,o=this.innerEl,i=t*e/o.scrollHeight,n=t*o.scrollTop/o.scrollHeight;return t<n+(i=i<20?20:i)&&(n=n-(n+i-t)-3),this.el.css("height",i).css("top",n),e<o.scrollHeight},o.Vertical.prototype.mousemove=function(e){var t=this.pane.el.height(),o=t-2*this.pane.padding,e=e.pageY-this.startPageY,i=this.el.height(),n=this.innerEl,e=Math.min(Math.max(e,0),o-i);n.scrollTop=(n.scrollHeight-t)*e/(o-i)},o.Vertical.prototype.mousewheel=function(e,t,o,i){if(0<i&&0==this.innerEl.scrollTop||i<0&&this.innerEl.scrollTop+Math.ceil(this.pane.el.height())==this.innerEl.scrollHeight)return e.preventDefault(),!1}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(s){var r,l,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(s.event.fixHooks)for(var o=e.length;o;)s.event.fixHooks[e[--o]]=s.event.mouseHooks;function i(e){var t=e||window.event,o=[].slice.call(arguments,1),i=0,n=0,a=0;return(e=s.event.fix(t)).type="mousewheel",t.wheelDelta&&(i=t.wheelDelta),t.detail&&(i=-1*t.detail),t.deltaY&&(i=a=-1*t.deltaY),t.deltaX&&(i=-1*(n=t.deltaX)),void 0!==t.wheelDeltaY&&(a=t.wheelDeltaY),void 0!==t.wheelDeltaX&&(n=-1*t.wheelDeltaX),t=Math.abs(i),(!r||t<r)&&(r=t),t=Math.max(Math.abs(a),Math.abs(n)),(!l||t<l)&&(l=t),t=0<i?"floor":"ceil",i=Math[t](i/r),n=Math[t](n/l),a=Math[t](a/l),o.unshift(e,i,n,a),(s.event.dispatch||s.event.handle).apply(this,o)}s.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],i,!1);else this.onmousewheel=i},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],i,!1);else this.onmousewheel=null}},s.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(o){o.fn.delayedAction=function(e){var t=o.extend({},{delayedAction:function(){},cancelledAction:function(){},hoverTime:1e3},e);return this.each(function(){var e=o(this);e.hover(function(){e.data("timerId",setTimeout(function(){e.data("hover",!1),t.delayedAction(e)},t.hoverTime)),e.data("hover",!0)},function(){e.data("hover")&&(clearTimeout(e.data("timerId")),t.cancelledAction(e)),e.data("hover",!1)})})}}(jQuery),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ClipboardJS=t():e.ClipboardJS=t()}(this,function(){return o={686:function(e,t,o){"use strict";o.d(t,{default:function(){return i}});var t=o(279),s=o.n(t),t=o(370),r=o.n(t),t=o(817),l=o.n(t);function d(e){try{document.execCommand(e)}catch(e){}}function c(e){return e=l()(e),d("cut"),e}function u(e){var t,o,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{container:document.body},a="";return"string"==typeof e?(t=e,o="rtl"===document.documentElement.getAttribute("dir"),(i=document.createElement("textarea")).style.fontSize="12pt",i.style.border="0",i.style.padding="0",i.style.margin="0",i.style.position="absolute",i.style[o?"right":"left"]="-9999px",o=window.pageYOffset||document.documentElement.scrollTop,i.style.top="".concat(o,"px"),i.setAttribute("readonly",""),i.value=t,n.container.appendChild(i),a=l()(i),d("copy"),i.remove()):(a=l()(e),d("copy")),a}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){if(e="data-clipboard-".concat(e),t.hasAttribute(e))return t.getAttribute(e)}var i=function(){var e=a,t=s();if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t);o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();var o,i,n=function(){var e=g(o),t=i?(t=g(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this;if(!t||"object"!==p(t)&&"function"!=typeof t){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t};function a(e,t){var o;if(this instanceof a)return(o=n.call(this)).resolveOptions(t),o.listenClick(e),o;throw new TypeError("Cannot call a class as a function")}return e=[{key:"copy",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{container:document.body};return u(e,t)}},{key:"cut",value:c},{key:"isSupported",value:function(){var e="string"==typeof(e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"])?[e]:e,t=!!document.queryCommandSupported;return e.forEach(function(e){t=t&&!!document.queryCommandSupported(e)}),t}}],h((t=a).prototype,[{key:"resolveOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===p(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=r()(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget,o=this.action(t)||"copy",e=function(){var e=void 0===(o=(i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).action)?"copy":o,t=i.container,o=i.target,i=i.text;if("copy"!==e&&"cut"!==e)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==o){if(!o||"object"!==f(o)||1!==o.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===e&&o.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===e&&(o.hasAttribute("readonly")||o.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return i?u(i,{container:t}):o?"cut"===e?c(o):u(o,{container:t}):void 0}({action:o,container:this.container,target:this.target(t),text:this.text(t)});this.emit(e?"success":"error",{action:o,text:e,trigger:t,clearSelection:function(){t&&t.focus(),document.activeElement.blur(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(e){return b("action",e)}},{key:"defaultTarget",value:function(e){if(e=b("target",e))return document.querySelector(e)}},{key:"defaultText",value:function(e){return b("text",e)}},{key:"destroy",value:function(){this.listener.destroy()}}]),h(t,e),a}()},828:function(e){var t;"undefined"==typeof Element||Element.prototype.matches||((t=Element.prototype).matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector),e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},438:function(e,t,o){var s=o(828);function a(e,t,o,i,n){var a=function(t,o,e,i){return function(e){e.delegateTarget=s(e.target,o),e.delegateTarget&&i.call(t,e)}}.apply(this,arguments);return e.addEventListener(o,a,n),{destroy:function(){e.removeEventListener(o,a,n)}}}e.exports=function(e,t,o,i,n){return"function"==typeof e.addEventListener?a.apply(null,arguments):"function"==typeof o?a.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return a(e,t,o,i,n)}))}},879:function(e,o){o.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},o.nodeList=function(e){var t=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===t||"[object HTMLCollection]"===t)&&"length"in e&&(0===e.length||o.node(e[0]))},o.string=function(e){return"string"==typeof e||e instanceof String},o.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},370:function(e,t,o){var d=o(879),c=o(438);e.exports=function(e,t,o){if(!e&&!t&&!o)throw new Error("Missing required arguments");if(!d.string(t))throw new TypeError("Second argument must be a String");if(!d.fn(o))throw new TypeError("Third argument must be a Function");if(d.node(e))return(s=e).addEventListener(r=t,l=o),{destroy:function(){s.removeEventListener(r,l)}};if(d.nodeList(e))return i=e,n=t,a=o,Array.prototype.forEach.call(i,function(e){e.addEventListener(n,a)}),{destroy:function(){Array.prototype.forEach.call(i,function(e){e.removeEventListener(n,a)})}};if(d.string(e))return c(document.body,e,t,o);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var i,n,a,s,r,l}},817:function(e){e.exports=function(e){var t,o="SELECT"===e.nodeName?(e.focus(),e.value):"INPUT"===e.nodeName||"TEXTAREA"===e.nodeName?((t=e.hasAttribute("readonly"))||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),t||e.removeAttribute("readonly"),e.value):(e.hasAttribute("contenteditable")&&e.focus(),o=window.getSelection(),(t=document.createRange()).selectNodeContents(e),o.removeAllRanges(),o.addRange(t),o.toString());return o}},279:function(e){function t(){}t.prototype={on:function(e,t,o){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:o}),this},once:function(e,t,o){var i=this;function n(){i.off(e,n),t.apply(o,arguments)}return n._=t,this.on(e,n,o)},emit:function(e){for(var t=[].slice.call(arguments,1),o=((this.e||(this.e={}))[e]||[]).slice(),i=0,n=o.length;i<n;i++)o[i].fn.apply(o[i].ctx,t);return this},off:function(e,t){var o=this.e||(this.e={}),i=o[e],n=[];if(i&&t)for(var a=0,s=i.length;a<s;a++)i[a].fn!==t&&i[a].fn._!==t&&n.push(i[a]);return n.length?o[e]=n:delete o[e],this}},e.exports=t,e.exports.TinyEmitter=t}},n={},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i(686).default;function i(e){var t;return(n[e]||(t=n[e]={exports:{}},o[e](t,t.exports,i),t)).exports}var o,n}),"undefined"==typeof CHV&&(CHV={obj:{},fn:{},str:{}}),window.opener&&"/upload"==window.location.pathname&&""==window.location.search.substr(1)&&(CHV.obj.opener={uploadPlugin:{}}),CHV.fn.album={showEmbedCodes:function(){var t,o=$(".content-listing-loading","#tab-embeds");o.exists()&&(t=$("#embed-codes"),$.ajax({url:PF.obj.config.json_api,type:"POST",dataType:"json",data:{action:"get-album-contents",albumid:CHV.obj.resource.id},cache:!1}).always(function(e){PF.fn.loading.destroy(o),200==e.status_code&&(CHV.fn.fillEmbedCodes(e.contents,"#tab-embeds"),$("#tab-embeds").addClass("visible"),t.removeClass("soft-hidden"))}))}},CHV.fn.modal={getTemplateWithPreview:function(e,t){var e=$(e).html(),o=$("<div/>"),i="",n=t.find(".image-container img").attr("src");return void 0!==n&&(i+='<a href="'+t.find(".image-container").attr("href")+'" target="_blank"><img class="canvas" src='+n+" /></a>"),o.html(e).find(".image-preview").html(i),o.html()},getTemplateWithPreviews:function(e,t){var e=$(e).html(),o=$("<div/>"),i="",n=0;return t.each(function(){if(50<=n)return!1;i+='<a class="image-preview-container" href="'+$(this).find(".image-container").attr("href")+'" target="_blank">';var e=$(this).find(".image-container img");e.exists()?i+='<canvas width="160" height="160" class="thumb" style="background-image: url('+e.attr("src")+');" />':i+='<canvas width="160" height="160" class="thumb ee" /><span class="empty icon icon-inbox"></span>',i+="</a>",n++}),o.html(e).find(".image-preview").html(i),o.html()}},CHV.fn.listingViewer={selectors:{bodyShown:".--viewer-shown",template:"#viewer-template",root:".viewer",rootShow:".viewer--show",rootHide:".viewer--hide",rootZero:".viewer--zero",rootNavPrev:".viewer--nav-prev",rootNavNext:".viewer--nav-next",src:".viewer-src",tools:".viewer-tools",loader:".viewer-loader",owner:".viewer-owner",ownerGuest:".viewer-owner--guest",ownerUser:".viewer-owner--user",inputMap:".viewer-kb-input"},keys:{83:"select",76:"like",69:"edit",81:"move",46:"delete",88:"close",27:"close",67:"codes",37:"prev",65:"prev",39:"next",68:"next"},keymap:{select:["S",PF.fn._s("Toggle select")],like:["L",PF.fn._s("Like")],edit:["E",PF.fn._s("Edit")],move:["Q",PF.fn._s("Album")],delete:["Del",PF.fn._s("Delete")],close:["X",PF.fn._s("Close")],codes:["C",PF.fn._s("Embed codes")],prev:["",PF.fn._s("Previous")],next:["",PF.fn._s("Next")]},loading:null,idleTimer:0,$item:null,show:function(){var e=PF.fn.deparam(this.$item.closest(PF.obj.listing.selectors.content_listing_visible).data("params-hidden")),e=e&&"is_animated"in e?e.is_animated:0;this.getEl("root").removeClass(this.selectors.rootHide.substring(1)).addClass(this.selectors.rootShow.substring(1)).attr("data-cover",e),$("body").addClass(this.selectors.bodyShown.substring(1)),new Hammer($(CHV.fn.listingViewer.selectors.root).get(0),{direction:Hammer.DIRECTION_VERTICAL}).on("swipeleft swiperight",function(e){e="left"==e.type.substring("swipe".length)?"next":"prev";CHV.fn.listingViewer[e]()}),this.getEl("root")[(PF.fn.isDevice(["phone","phablet"])?"add":"remove")+"Class"]("--over")},getItem:function(){return this.$item},getEl:function(e){var t=0!==e.lastIndexOf("template",0)&&0!==e.lastIndexOf("root",0)&&this.selectors.root;return t?$(this.selectors[e],t):$(this.selectors[e])},getObject:function(e){return!e&&void 0!==this.object||(e=decodeURIComponent(this.getItem().attr("data-object")),this.object=JSON&&JSON.parse(e)||$.parseJSON(e)),this.object},placeholderSizing:function(){var e,t;this.getEl("root").exists()&&(t=Math.max(document.documentElement.clientWidth,window.innerWidth||0)/Math.max(document.documentElement.clientHeight,window.innerHeight||0)<(e=this.getEl("src")[0]).getAttribute("width")/e.getAttribute("height"),e.classList.remove("--width-auto","--height-auto"),e.classList.add("--"+(t?"height":"width")+"-auto"))},filler:function(e){var i=this,n=this.getEl("root");e&&(e=$(this.getParsedTemplate()),n.html(e.html())),n[(this.getItem().hasClass("selected")?"add":"remove")+"Class"]("selected");$.each(["prev","next"],function(e,t){var o=i.selectors["rootNav"+(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase())],t=0<$(PF.obj.listing.selectors.content_listing_pagination+":visible").length||i.getItem()[t]().exists()?"add":"remove";n[t+"Class"](o.substring(1))}),$.each(this.getItem().get(0).attributes,function(e,t){if(0!==t.name.lastIndexOf("data-",0))return!0;n.attr(t.name,t.value)});e="owner"+((e=void 0===this.object.user?"user":"guest").charAt(0).toUpperCase()+e.slice(1).toLowerCase()),this.getEl(e).remove(),void 0!==this.object.user&&$(this.object.user.avatar?".default-user-image":"img.user-image",this.getEl("ownerUser")).remove(),e=this.getItem().find(".list-item-image-tools[data-action='list-tools']");this.getEl("tools").append(e.html()),$.each(e.find("[data-action]"),function(e,t){var o=$(this).attr("data-action"),o=i.keymap[o];void 0!==o&&$('<div class="viewer-kb-key" data-key="'+o[0]+'"><kbd>'+o[0]+"</kbd><span>"+PF.fn._s(o[1])+"</span></div>").appendTo(i.getEl("inputMap"))}),this.placeholderSizing(),this.trickyLoad()},remove:function(){this.getEl("root").remove()},getParsedTemplate:function(){var i=this.getObject(!0),n=this.getEl("template").html(),e=n.match(/%(\S+)%/g);return e&&$.each(e,function(e,t){t.slice(1,-1).split(".").map(function(e){var t=o||i;e in t&&(o=t[e])});var o,t=new RegExp(t,"g");n=n.replace(t,o)}),n},insertEl:function(){var e=this.getParsedTemplate();this.getEl("rootZero").remove(),$(e).appendTo("body")},toggleIdle:function(e,t){var o=this,t=void 0===t||t;$("html")[(e?"add":"remove")+"Class"]("--idle"),e||(clearTimeout(o.idleTimer),t&&(o.idleTimer=setTimeout(function(){var e=$(".fullscreen"),t=o.getEl("root");o.toggleIdle(0<t.length&&0==e.length)},5e3)))},open:function(e){this.setItem(e),this.insertEl(),this.filler(),this.show(),this.toggleIdle(!1);var t=this;this.getEl("root").on("mousemove mouseout",function(){t.toggleIdle(!1)})},setItem:function(e){this.$item=e},trickyLoad:function(){var e,t,o=this.getEl("loader");this.object.image.url==this.object.display_url?o.remove():(e=this.getEl("src").parent().html(),(t=$(e).attr("src",this.object.image.url)).insertBefore(this.getEl("src")),PF.fn.loading.inline(o,{color:"white",size:"small",center:!0,valign:!0}),o.hide().fadeIn("slow"),t.imagesLoaded(function(){t.next().remove(),PF.fn.loading.destroy(o)}))},close:function(){var e=this,t=($(this.selectors.root).removeClass(this.selectors.rootShow.substring(1)).addClass(this.selectors.rootHide.substring(1)),$("body").removeClass(this.selectors.bodyShown.substring(1)),this.toggleIdle(!1,!1),null!==this.getItem()&&$(window).scrollTop(this.getItem().offset().top),$("#top-bar, .follow-scroll"));t.attr("data-scroll-lock","1"),setTimeout(function(){e.remove()},250),setTimeout(function(){t.removeAttr("data-scroll-lock")},300)},browse:function(e){var t=this.getItem()[e]();if(!t.exists())return(o=$("[data-pagination="+e+"]",PF.obj.listing.selectors.content_listing_pagination+":visible").attr("href"))?(PF.fn.deparam(window.location.search),void(window.location.href=o+"&viewer="+e)):void 0;this.setItem(t),this.filler(!0);var o=$(PF.obj.listing.selectors.content_listing_visible).find("[data-action=load-more]"),t=t[e+"All"]().length;0<o.length&&t<=5&&!PF.obj.listing.calling&&"next"==e&&$("[data-action=load-more]").click()},prev:function(){this.browse("prev")},next:function(){this.browse("next")}},CHV.obj.image_viewer={selector:"#image-viewer",container:"#image-viewer-container",navigation:".image-viewer-navigation",loading:"#image-viewer-loading",loader:"#image-viewer-loader"},CHV.obj.image_viewer.$container=$(CHV.obj.image_viewer.container),CHV.obj.image_viewer.$navigation=$(CHV.obj.image_viewer.navigation),CHV.obj.image_viewer.$loading=$(CHV.obj.image_viewer.loading),CHV.fn.bindSelectableItems=function(){var e="content-listing-wrapper",t="#"+e;$(t).exists()?$(t).hasClass("ui-selectable")&&$(t).selectable("destroy"):$("[data-content=list-selection]").closest(".content-width").wrap("<div id='"+e+"' />"),$("[data-content=list-selection]").exists()&&$("html.device-nonmobile "+t).selectable({delay:150,filter:PF.obj.listing.selectors.list_item,cancel:".content-empty, .header, #tab-sh, .viewer-title, .header-link, .top-bar, .content-listing-pagination *, #fullscreen-modal, #top-user, #background-cover, .list-item-desc, .list-item-image-tools, [data-action=load-image], #tab-embeds",selecting:function(e,t){var t=$(t.selecting),o=t.hasClass("selected");CHV.fn.list_editor[(o?"unselect":"select")+"Item"](t)},unselecting:function(e,t){CHV.fn.list_editor.unselectItem($(t.unselecting))}})},CHV.fn.isCachedImage=function(e){var t=new Image;return t.src=e,t.complete||0<t.width+t.height},CHV.fn.viewerLoadImage=function(){CHV.obj.image_viewer.$loading.exists()&&(CHV.obj.image_viewer.$loading.removeClass("soft-hidden").css({zIndex:2}),PF.fn.loading.inline(CHV.obj.image_viewer.$loading,{color:"white",size:"small",center:!0,valign:!0}),CHV.obj.image_viewer.$loading.hide().fadeIn("slow")),$(CHV.obj.image_viewer.loader).remove(),CHV.obj.image_viewer.image.is_360?(PF.fn.loading.destroy(CHV.obj.image_viewer.$loading),pannellum.viewer("image-viewer-360",{autoLoad:!0,type:"equirectangular",panorama:CHV.obj.image_viewer.image.url,preview:CHV.obj.image_viewer.$container.find("img").eq(0).attr("src"),pitch:2.3,yaw:-135.4,hfov:120}),$("#image-viewer-360").removeClass("soft-hidden"),CHV.obj.image_viewer.$container.remove()):(CHV.obj.image_viewer.image.html=CHV.obj.image_viewer.$container.html(),CHV.obj.image_viewer.$container.prepend($(CHV.obj.image_viewer.image.html).css({top:0,zIndex:0,opacity:0,position:"absolute"})),CHV.obj.image_viewer.$container.find("img").eq(0).css("zIndex",1),CHV.obj.image_viewer.$container.find("img").eq(1).attr("src",CHV.obj.image_viewer.image.url),CHV.obj.image_viewer.$container.find("img").eq(1).imagesLoaded(function(){CHV.obj.image_viewer.$container.find("img").eq(1).css({position:"",display:""}),CHV.obj.image_viewer.$container.find("img").eq(0).remove(),PF.fn.loading.destroy(CHV.obj.image_viewer.$loading)}))},CHV.obj.embed_tpl={},CHV.obj.topBar={transparencyScrollToggle:function(){var e=$(window).scrollTop();$("#top-bar")[(0<e?"remove":"add")+"Class"]("transparent")}},CHV.obj.uploaderReset={isUploading:!1,canAdd:!0,queueStatus:"ready",uploadThreads:0,uploadParsedIds:[],uploadProcessedIds:[],files:{},results:{success:{},error:{}},toggleWorking:0,filesAddId:0,clipboardImages:[]},CHV.fn.uploader={selectors:{root:"#anywhere-upload",show:".upload-box--show",queue:"#anywhere-upload-queue",queue_complete:".queue-complete",queue_item:".queue-item",close_cancel:"[data-button=close-cancel]",file:"#anywhere-upload-input",camera:"#anywhere-upload-input-camera",upload_item_template:"#anywhere-upload-item-template",item_progress_bar:"[data-content=progress-bar]",item_progress_percent:"[data-text=progress-percent]",failed_result:"[data-content=failed-upload-result]",fullscreen_mask:"#fullscreen-uploader-mask",dropzone:"#uploader-dropzone",paste:"#anywhere-upload-paste",input:"[data-action=anywhere-upload-input]"},toggle:function(e,t){this.queueSize();var o,i,n,a=$("[data-action=top-bar-upload]",".top-bar"),s=!$(CHV.fn.uploader.selectors.root).data("shown");void 0!==(e=$.extend({callback:null,reset:!0},e)).show&&e.show&&(s=!0),PF.fn.growl.close(!0),PF.fn.close_pops(),1==this.toggleWorking||$(CHV.fn.uploader.selectors.root).is(":animated")||CHV.fn.uploader.isUploading||a.data("login-needed")&&!PF.fn.is_user_logged()||(this.toggleWorking=1,o=500,i=function(){!s&&e.reset&&CHV.fn.uploader.reset(),PF.fn.topMenu.hide(),"function"==typeof e.callback&&e.callback(t),CHV.fn.uploader.boxSizer(),CHV.fn.uploader.toggleWorking=0},$(CHV.fn.uploader.selectors.root)[(s?"add":"remove")+"Class"](this.selectors.show.substring(1)),s?(!$("body").is("#upload")&&PF.fn.isDevice(["phone","phablet"])&&$("html").addClass("overflow-hidden"),$("html").data({"followed-scroll":$("html").hasClass("followed-scroll"),"top-bar-box-shadow-prevent":!0}).removeClass("followed-scroll"),$("#top-bar").data({stock_classes:$("#top-bar").attr("class")}),$(".current[data-nav]",".top-bar").each(function(){$(this).is("[data-action=top-bar-menu-full]")||$(this).removeClass("current").attr("data-current",1)}),PF.fn.isDevice("mobile")&&(n=$(".upload-box-heading",$(CHV.fn.uploader.selectors.root))).css({position:"relative",top:.5*($(window).height()-n.height())+"px"}),e.reset&&CHV.fn.uploader.reset(),CHV.fn.uploader.focus(function(){setTimeout(function(){i()},o)})):($("[data-nav][data-current=1]",".top-bar").each(function(){$(this).addClass("current")}),$(CHV.fn.uploader.selectors.fullscreen_mask).css({opacity:0}),setTimeout(function(){$(CHV.fn.uploader.selectors.fullscreen_mask).remove()},250),n=$(CHV.fn.uploader.selectors.root).outerHeight()-parseInt($(CHV.fn.uploader.selectors.root).data("initial-height"))+"px",$(CHV.fn.uploader.selectors.root).css({transform:"translate(0,-"+n+")"}),setTimeout(function(){$(CHV.fn.uploader.selectors.root).css({top:""}),i(),$("html,body").removeClass("overflow-hidden").data({"top-bar-box-shadow-prevent":!1})},o)),$(CHV.fn.uploader.selectors.root).data("shown",s),a.toggleClass("current").removeClass("opened"))},reset:function(){$.extend(this,$.extend(!0,{},CHV.obj.uploaderReset)),$("li",this.selectors.queue).remove(),$(this.selectors.root).height("").css({"overflow-y":"","overflow-x":""}),$(this.selectors.queue).addClass("queueEmpty").removeClass(this.selectors.queue_complete.substring(1)),$(this.selectors.input,this.selectors.root).each(function(){}),$("[data-group=upload-result] textarea",this.selectors.root).prop("value",""),$.each(["upload-queue-ready","uploading","upload-result","upload-queue-ready","upload-queue"],function(e,t){$("[data-group="+t+"]").hide()}),$("[data-group=upload]",this.selectors.root).show(),$("[name=upload-album-id]",this.selectors.root).prop("value",function(){var e=$("option[selected]",this);if(e.exists())return e.attr("value")}),$(this.selectors.root).removeClass("queueCompleted queueReady queueHasResults").addClass("queueEmpty").attr("data-queue-size",0),this.boxSizer(!0)},focus:function(e){$(this.selectors.fullscreen_mask).exists()||($("body").is("#upload")||$("body").append($("<div/>",{id:this.selectors.fullscreen_mask.replace("#",""),class:"fullscreen black"}).css({top:PF.fn.isDevice("phone")?0:$(CHV.fn.uploader.selectors.root).data("top")})),setTimeout(function(){$("body").is("#upload")||$(CHV.fn.uploader.selectors.fullscreen_mask).css({opacity:1}),setTimeout(function(){"function"==typeof e&&e()},PF.fn.isDevice(["phone","phablet"])?0:250)},1))},boxSizer:function(e){var t=$(this.selectors.root).is(this.selectors.show),e=t||e;t&&!$("body").is("#upload")&&$("html")[(PF.fn.isDevice(["phone","phablet"])?"add":"remove")+"Class"]("overflow-hidden"),e&&($(this.selectors.root).height(""),!$("body").is("#upload")&&$(this.selectors.root).height()>$(window).height()?($(this.selectors.root).height($(window).height()).css({"overflow-y":"scroll","overflow-x":"auto"}),$("body").addClass("overflow-hidden")):($(this.selectors.root).css("overflow-y",""),$("body").removeClass("overflow-hidden")))},pasteURL:function(){var e=$("[name=urls]","#fullscreen-modal").val();void 0!==e&&"undefined"!=e&&""!=e&&(CHV.fn.uploader.toggle({show:!0}),CHV.fn.uploader.add({},e))},pasteImageHandler:function(o){var e,t;if(!$(o.target).is(":input")&&(void 0!==o.clipboardData&&o.clipboardData.items?e=o.clipboardData.items:setTimeout(function(){return o.clipboardData={},o.clipboardData.items=[],$.each($("img",CHV.fn.uploader.$pasteCatcher),function(e,t){o.clipboardData.items.push(PF.fn.dataURItoBlob($(this).attr("src")))}),$(CHV.fn.uploader.selectors.paste).html(""),CHV.fn.uploader.pasteImageHandler(o)},1),e))if(0==e.length)void 0!==window.clipboardData&&window.clipboardData.getData&&void 0!==(t=window.clipboardData.getData("Text"))&&"undefined"!=t&&""!=t&&($(CHV.fn.uploader.selectors.root).data("shown")?CHV.fn.uploader.add({},t):CHV.fn.uploader.toggle({callback:function(){CHV.fn.uploader.add({},t)}}));else{for(var i=!1,n=0;n<e.length;n++)-1!==e[n].type.indexOf("image")&&(i=!0);for(var a,s,n=0;n<e.length;n++)-1!==e[n].type.indexOf("image")?(a=e[n]instanceof Blob?e[n]:e[n].getAsFile(),(s=new FileReader).onload=function(e){var t=$(CHV.fn.uploader.selectors.root).data("shown"),o=(a.name=PF.fn._s("Clipboard image")+" "+PF.fn.getDateTime(),{originalEvent:{dataTransfer:{files:[a]},preventDefault:function(){},stopPropagation:function(){},clipboard:!0,dataURL:e.target.result,name:a.name}});t?CHV.fn.uploader.add(o):CHV.fn.uploader.toggle({callback:function(){CHV.fn.uploader.add(o)}})},s.readAsDataURL(a)):"string"==e[n].kind&&-1!==e[n].type.indexOf("text")&&-1===e[n].type.indexOf("html")&&0==i&&e[n].getAsString(function(e){void 0!==e&&"undefined"!=e&&""!=e&&($(CHV.fn.uploader.selectors.root).data("shown")?CHV.fn.uploader.add({},e):CHV.fn.uploader.toggle({callback:function(){CHV.fn.uploader.add({},e)}}))})}},add:function(e,g){var t;if(!this.canAdd)return(e=e.originalEvent).preventDefault(),e.stopPropagation(),!1;($fileinput=$(this.selectors.file)).replaceWith($fileinput=$fileinput.clone(!0));var o=$(this.selectors.upload_item_template).html(),b=[];if(void 0===g){if((e=e.originalEvent).preventDefault(),e.stopPropagation(),b=e.dataTransfer||e.target,b=$.makeArray(b.files),e.clipboard){if(t=PF.fn.md5(e.dataURL),-1!=$.inArray(t,this.clipboardImages))return null;this.clipboardImages.push(t)}for(var v=[],i=0;i<b.length;i++){var n=b[i],a=n.name.substr(n.name.lastIndexOf(".")+1).toLowerCase();n.size>CHV.obj.config.image.max_filesize?v.push({uid:i,name:n.name.truncate_middle()+" - "+PF.fn._s("File too large.")}):-1==CHV.obj.config.upload.image_types.indexOf(a)&&0==/android/i.test(navigator.userAgent)?v.push({uid:i,name:n.name.truncate_middle()+" - "+PF.fn._s("Invalid or unsupported file format.")}):(t&&(n.md5=t),n.fromClipboard=1==e.clipboard,n.uid=i)}for(i=0;i<v.length;i++){var s=v[i];b.splice(s.id,1)}if(0<v.length&&0==b.length){for(var r="",i=0;i<v.length;i++)r+="<li>"+PF.fn.htmlEncode(v[i].name)+"</li>";return void PF.fn.modal.simple({title:PF.fn._s("Some files couldn't be added"),message:"<ul><li>"+r+"</ul>"})}if(0==b.length)return;$("body").is(".replace")&&(b.splice(1),CHV.fn.uploader.canAdd=!1)}else{var l=(g=g.replace(/(\[([^\]]+)\])/g,"")).match_image_urls();if(g=g.replace(/(<([^>]+)>)/g,""),l)for(index=0;index<l.length;++index)g=g.replace(l[index],""),g+="\n"+l[index];if(!(b=g.match_urls()))return;b=(b=b.array_unique()).filter(function(e){return-1!==e.indexOf("/")&&-1!==e.indexOf(".")}),$("body").is(".replace")&&(b.splice(1),CHV.fn.uploader.canAdd=!1),b=$.map(b,function(e,t){return{uid:t,name:e,url:e}})}if($.isEmptyObject(this.files))for(i=0;i<b.length;i++)this.files[b[i].uid]=b[i],this.filesAddId++;else{var d,c=[];for(d in this.files)void 0!==this.files[d]&&"function"!=typeof this.files[d]&&c.push(encodeURI(this.files[d].name));for(b=$.map(b,function(e,t){return"undefined"!==e.fromClipboard&&1==e.fromClipboard||-1==$.inArray(encodeURI(e.name),c)?(e.uid=CHV.fn.uploader.filesAddId,CHV.fn.uploader.filesAddId++,e):null}),i=0;i<b.length;i++)this.files[b[i].uid]=b[i]}$(this.selectors.queue,this.selectors.root).append(o.repeat(b.length)),$(this.selectors.queue+" "+this.selectors.queue_item+":not([data-id])",this.selectors.root).hide();var w=v,v=[],y=0,u={canvas:!0,maxWidth:590};function _(){$("[data-group=upload-queue]",CHV.fn.uploader.selectors.root).is(":visible")||$("[data-group=upload-queue]",CHV.fn.uploader.selectors.root).css("display","block")}function P(e){var t=null;return void 0!==e.name&&(e=PF.fn.baseName(e.name),t=$.trim(e.substring(0,100).capitalizeFirstLetter())),t}var F=[];function j(e,h){var m;e in b?(m=b[e],$(CHV.fn.uploader.selectors.queue_item+":not([data-id]) .load-url",CHV.fn.uploader.selectors.queue)[void 0!==m.url?"show":"remove"](),loadImage.parseMetaData(m.url||m,function(p){$(CHV.fn.uploader.selectors.queue_item+":not([data-id]) .preview:empty",CHV.fn.uploader.selectors.queue).first().closest("li").attr("data-id",m.uid),loadImage(m.url||m,function(e,t){++y;var o,i,n=$(CHV.fn.uploader.selectors.queue_item+"[data-id="+m.uid+"]",CHV.fn.uploader.selectors.queue);if("error"===e.type){if(void 0===F[m.uid])if(void(F[m.uid]=0)!==m.url&&"undefined"!=m.url&&""!=m.url){var a=new XMLHttpRequest;a.open("GET",PF.obj.config.json_api+"?action=image&auth_token="+PF.obj.config.auth_token+"&url="+encodeURIComponent(m.url),!0),a.timeout=3e4,a.send(),a.onreadystatechange=function(){if(4==this.readyState){var e=!(F[m.uid]=1);if(200==a.status){var t="json"!==this.responseType?JSON.parse(this.response):this.response;if(void 0!==t&&void 0!==t.urls&&1==t.urls.length){if(g=t.urls[0],void 0===CHV.fn.uploader.files[m.uid])return void PF.fn.loading.destroy("fullscreen");b[m.uid]={uid:m.uid,name:m.url,url:g},CHV.fn.uploader.files[m.uid]=b[m.uid],e=!0}}e||v.push({uid:m.uid,name:m.name.truncate_middle()}),j(m.uid,!0)}}}else{_();var s=P(m);if(void 0===CHV.fn.uploader.files[m.uid])return void PF.fn.loading.destroy("fullscreen");CHV.fn.uploader.files[m.uid].parsedMeta={title:s,width:1e4,height:1e4,mimetype:"image/jpeg"},n.show(),$(CHV.fn.uploader.selectors.root).addClass("queueReady").removeClass("queueEmpty"),$("[data-group=upload-queue-ready]",CHV.fn.uploader.selectors.root).show(),$("[data-group=upload]",CHV.fn.uploader.selectors.root).hide(),n.find(".load-url").remove(),n.find(".preview").removeClass("soft-hidden").show().append($("<span>",{class:"icon icon-eye-slash canvas",style:"font-size:4em;color:#2a80b9;display:block;text-decoration:none;margin-top:-0.5em;margin-left:-0.62em;"})),CHV.fn.uploader.boxSizer()}}else{_();var r="image/jpeg";if(void 0!==p.buffer){for(var l=new Uint8Array(p.buffer).subarray(0,4),d="",c=0;c<l.length;c++)d+=l[c].toString(16);var u={"89504e47":"image/png",47494638:"image/gif",ffd8ffe0:"image/jpeg",ffd8ffe1:"image/jpeg",ffd8ffe2:"image/jpeg",ffd8ffe3:"image/jpeg",ffd8ffe8:"image/jpeg"};void 0!==u[d]&&(r=u[d])}s=P(m);if(void 0===CHV.fn.uploader.files[m.uid])return void PF.fn.loading.destroy("fullscreen");CHV.fn.uploader.files[m.uid].parsedMeta={title:s,width:t.originalWidth,height:t.originalHeight,mimetype:r},u=e,(s=n).show(),$(CHV.fn.uploader.selectors.root).addClass("queueReady").removeClass("queueEmpty"),$("[data-group=upload-queue-ready]",CHV.fn.uploader.selectors.root).show(),$("[data-group=upload]",CHV.fn.uploader.selectors.root).hide(),s.find(".load-url").remove(),s.find(".preview").removeClass("soft-hidden").show().append(u),($img=s.find(".preview").find("img,canvas")).attr("class","canvas"),queue_item_h=s.height(),queue_item_w=s.width(),u=parseInt($img.attr("width"))||$img.width(),s=parseInt($img.attr("height"))||$img.height(),t=u/s,$img.hide(),(s<u||u==s)&&(o=s<queue_item_h?s:queue_item_h,s<u)&&$img.height(o).width(o*t),(u<s||u==s)&&(i=u<queue_item_w?u:queue_item_w,u<s)&&$img.width(i).height(i/t),u==s&&$img.height(o).width(i),$img.css({marginTop:-$img.height()/2,marginLeft:-$img.width()/2}).show(),_(),CHV.fn.uploader.boxSizer()}if(1==F.every(function(e){return 0<e})&&(y==b.length||1==h)){if(void 0!==w&&(v=v.concat(w)),PF.fn.loading.destroy("fullscreen"),0<v.length){for(var f="",c=0;c<v.length;c++)f+="<li>"+PF.fn.htmlEncode(v[c].name)+"</li>",delete CHV.fn.uploader.files[v[c].uid],$("li[data-id="+v[c].uid+"]",CHV.fn.uploader.selectors.queue).find("[data-action=cancel]").click();PF.fn.modal.simple({title:PF.fn._s("Some files couldn't be added"),message:"<ul>"+f+"</ul>"})}else CHV.fn.uploader.focus();CHV.fn.uploader.boxSizer()}},$.extend({},u,{orientation:p.exif?p.exif.get("Orientation"):1})),setTimeout(function(){j(e+1,!1)},25)})):PF.fn.loading.destroy("fullscreen")}0<b.length&&(PF.fn.loading.fullscreen(),j(0,!1),this.queueSize())},queueSize:function(){$(this.selectors.root).attr("data-queue-size",Object.size(this.files)),$("[data-text=queue-objects]",this.selectors.root).text(PF.fn._n("image","images",Object.size(this.files))),$("[data-text=queue-size]",this.selectors.root).text(Object.size(this.files))},queueProgress:function(e,t){for(var o=Object.size(this.files),i=(this.files[t].progress=e.loaded/e.total,0),n=0;n<o;n++)void 0!==this.files[n]&&"progress"in this.files[n]&&(i+=this.files[n].progress);$("[data-text=queue-progress]",this.selectors.root).text(parseInt(100*i/o))},upload:function(a){var e,t,o,i,n,s,r,l=a.data("id"),d=!!a.next().exists()&&a.next().data("id");-1!==$.inArray(l,this.uploadParsedIds)?a.next().exists()&&this.upload(a.next()):((e=this).uploadParsedIds.push(l),void 0!==(t=this.files[l])&&(i=(o=void 0!==t.url)?t.url:t,n=void 0!==t.formValues,void 0===t?a.next().exists()&&this.upload(a.next()):(this.uploadThreads+=1,this.uploadThreads<2&&d&&this.upload(a.next()),this.isUploading=!0,s=new FormData,r={source:null,type:o?"url":"file",action:"upload",timestamp:this.timestamp,auth_token:PF.obj.config.auth_token,album_id:$("[name=upload-album-id]",this.selectors.root).val()||null,expiration:$("[name=upload-expiration]",this.selectors.root).val()||null,replace:$("[name=upload-replace]",this.selectors.root).val()||null},window.opener&&void 0!==CHV.obj.opener&&void 0!==CHV.obj.opener.uploadPlugin[window.name]&&(r.plugin=1,document.referrer)&&(r.plugin=document.referrer),o?r.source=i:s.append("source",i,t.name),void 0!==CHV.obj.config.recaptcha&&(r.recaptcha=grecaptcha.getResponse()),void 0!==CHV.obj.config.location&&(r.url=CHV.obj.config.location),void 0!==CHV.obj.config.mode&&(r.mode=CHV.obj.config.mode),n&&$.each(t.formValues,function(e,t){r[e.replace(/image_/g,"")]=t}),$.each(r,function(e,t){if(null===t)return!0;s.append(e,t)}),this.files[l].xhr=new XMLHttpRequest,a.removeClass("waiting"),$(".block.edit, .queue-item-button.edit",a).remove(),o?(this.queueSize(),this.queueProgress({loaded:1,total:1},l),this.itemLoading(a)):this.files[l].xhr.upload.onprogress=function(e){e.lengthComputable&&(CHV.fn.uploader.queueProgress(e,l),percentComplete=parseInt(e.loaded/e.total*100),$(CHV.fn.uploader.selectors.item_progress_percent,a).text(percentComplete),$(CHV.fn.uploader.selectors.item_progress_bar,a).width(100-percentComplete+"%"),100==percentComplete)&&($(CHV.fn.uploader.selectors.item_progress_percent,a).text(""),CHV.fn.uploader.itemLoading(a))},this.files[l].xhr.onreadystatechange=function(){var t=!1;if(4==this.readyState&&void 0!==CHV.fn.uploader.files[l].xhr&&0!==CHV.fn.uploader.files[l].xhr.status){e.uploadProcessedIds.push(l),--e.uploadThreads,$(".loading-indicator",a).remove(),a.removeClass("waiting uploading");try{void 0!==(i="json"!==this.responseType?JSON.parse(this.response):this.response)&&200==this.status?($("[data-group=image-link]",a).attr("href",i.image.url_viewer),0<a.find(".preview").find(".icon-eye-slash").length&&loadImage(i.image.display_url,function(e){var t,o,i,n;"error"!==e.type&&(a.find(".preview").append(e),($img=a.find(".preview").find("img,canvas")).attr("class","canvas"),queue_item_h=a.height(),queue_item_w=a.width(),o=(e=parseInt($img.attr("width"))||$img.width())/(t=parseInt($img.attr("height"))||$img.height()),$img.hide(),(t<e||e==t)&&(i=t<queue_item_h?t:queue_item_h,t<e)&&$img.height(i).width(i*o),(e<t||e==t)&&(n=e<queue_item_w?e:queue_item_w,e<t)&&$img.width(n).height(n/o),e==t&&$img.height(i).width(n),$img.css({marginTop:-$img.height()/2,marginLeft:-$img.width()/2}).show(),a.find(".preview").find(".icon-eye-slash").remove(),CHV.fn.uploader.boxSizer())})):("PDOException"==i.error.context&&(i.error.message="Database error"),i.error.message=PF.fn.htmlEncode(CHV.fn.uploader.files[l].name.truncate_middle())+" - "+i.error.message),CHV.fn.uploader.results[200==this.status?"success":"error"][l]=i,200!==this.status&&(t=!0)}catch(e){var t=!0,o=void 0===i?{status:500,statusText:"Internal server error"}:{status:400,statusText:i.error.message},i={status_code:o.status,error:{message:PF.fn.htmlEncode(CHV.fn.uploader.files[l].name.truncate_middle())+" - Server error ("+o.statusText+")",code:o.status,context:"XMLHttpRequest"},status_txt:o.statusText},o=Object.size(CHV.fn.uploader.results.error)+1;CHV.fn.uploader.results.error[o]=i}a.addClass(t?"failed":"completed"),void 0!==i.error&&void 0!==i.error.message&&(a.attr("rel","tooltip").data("tiptip","top").attr("title",i.error.message),PF.fn.bindtipTip(a)),e.uploadThreads<2&&d&&(CHV.fn.uploader.upload(a.next()),$(CHV.fn.uploader.selectors.root).addClass("queueHasResults")),e.uploadProcessedIds.length==Object.size(e.files)&&CHV.fn.uploader.displayResults(),$(".done",a).fadeOut()}},this.files[l].xhr.open("POST",PF.obj.config.json_api,!0),this.files[l].xhr.setRequestHeader("Accept","application/json"),this.files[l].xhr.send(s))))},itemLoading:function(e){PF.fn.loading.inline($(".progress",e),{color:"#FFF",size:"normal",center:!0,position:"absolute",shadow:!0}),$("[data-action=cancel], [data-action=edit]",e).hide()},displayResults:function(){CHV.fn.uploader.isUploading=!1;for(var e,t=["error","mixed","success"],o={},i=0;i<t.length;i++)o[t[i]]="[data-group=upload-result][data-result=%RESULT%]".replace("%RESULT%",t[i]);if(0<Object.size(this.results.error)){var n=[];for(i in this.results.error)"object"==typeof this.results.error[i]&&(n[i]=this.results.error[i].error.message);0<n.length&&$(this.selectors.failed_result).html("<li>"+n.join("</li><li>")+"</li>")}else $(o.error,this.selectors.root).hide();if($("[data-text=queue-progress]",this.selectors.root).text(100),$("[data-group=uploading]",this.selectors.root).hide(),$(this.selectors.root).removeClass("queueUploading queueHasResults").addClass("queueCompleted"),$(this.selectors.queue).addClass(this.selectors.queue_complete.substring(1)),0<Object.size(this.results.success)&&$("[data-group=upload-result] textarea",this.selectors.root).exists()&&(CHV.fn.fillEmbedCodes(this.results.success,CHV.fn.uploader.selectors.root,"val"),void 0!==CHV.obj.config.location)&&-1!==window.name.indexOf("imgbb_")&&0<(d=CHV.obj.config.hotlink?$("textarea[name=bbcode-embed-medium]",CHV.fn.uploader.selectors.root):$("textarea[name=bbcode-embed-thumbnail]",CHV.fn.uploader.selectors.root)).length&&""!=d.val()&&(d=5<(d.val().match(/ /g)||[]).length?encodeURIComponent("\n"+d.val().replace(new RegExp("\n","g")," ").replace(new RegExp("  ","g")," ").replace(new RegExp("`","g")," ")+"\n"):encodeURIComponent("\n"+d.val().replace(new RegExp(" ","g"),"\n").replace(new RegExp("\n","g"),"\n\n").replace(new RegExp("\n\n\n","g"),"\n\n").replace(new RegExp("`","g")," ")+"\n"),a=window.navigator.userAgent,e=CHV.obj.config.location+"#"+window.name,0<a.indexOf("MSIE ")||0<a.indexOf("Trident/")||0<a.indexOf("Edge/")?e=CHV.obj.config.location+"#"+d:window.name=d,"undefined"!=typeof localStorage&&localStorage.setItem("code",d),window.location.href=e),0<Object.size(this.results.success)&&0<Object.size(this.results.error)?$(o.mixed+", "+o.success,this.selectors.root).show():0<Object.size(this.results.success)?$(o.success,this.selectors.root).show():0<Object.size(this.results.error)&&$(o.error,this.selectors.root).show(),$(o.success,this.selectors.root).is(":visible")&&($(o.success,this.selectors.root).find("[data-group^=user], [data-group=guest]").hide(),$(o.success,this.selectors.root).find("[data-group="+(PF.fn.is_user_logged()?"user":"guest")+"]").show(),0<Object.size(this.results.success))){var a=Object.keys(this.results.success)[0];if(void 0!==this.results.success[a].image.album){var s,r=[];for(s in this.results.success){var l=this.results.success[s].image;l.album&&l.album.id_encoded&&-1==r.indexOf(l.album.id_encoded)&&r.push(l.album.id_encoded)}var d={link:null,text:null};r.length<=1?(d.link=this.results.success[a].image.album.url,d.text=this.results.success[a].image.album.name):(d.link=this.results.success[a].image.user.url_albums,d.text=PF.fn._s("%s's Albums",this.results.success[a].image.user.name_short_html)),$("[data-text=upload-target]",this.selectors.root).text(d.text),$("[data-link=upload-target]",this.selectors.root).attr("href",d.link),PF.fn.is_user_logged()&&$("[data-group=user-"+(0<r.length?"album":"stream")+"]",this.selectors.root).show()}}this.boxSizer(),this.queueStatus="done",window.opener&&"/upload"==window.location.pathname&&""==window.location.search.substr(1)&&void 0!==CHV.obj.opener.uploadPlugin[window.name]?($('[data-action="copy"]',this.selectors.root).remove(),CHV.obj.opener.uploadPlugin[window.name].hasOwnProperty("autoInsert")&&CHV.obj.opener.uploadPlugin[window.name].autoInsert&&(e=$(':input[name="'+CHV.obj.opener.uploadPlugin[window.name].autoInsert+'"]',CHV.fn.uploader.selectors.root).val())&&(window.opener.postMessage({id:window.name,message:e},"*"),window.close())):$('[data-action="openerPostMessage"]',this.selectors.root).remove()}},$.extend(CHV.fn.uploader,$.extend(!0,{},CHV.obj.uploaderReset)),CHV.fn.fillEmbedCodes=function(e,s,r){void 0===r&&(r="val");var t=getCookie("USER_SELECTED_EMBED");"undefined"!==t&&0<$('#form-embed-toggle-combo div[data-combo-value="'+t+'"]',s).length&&($("#form-embed-toggle",s).find("option").attr("selected",!1),$('#form-embed-toggle option[value="'+t+'"]',s).attr("selected","selected"),$("#form-embed-toggle-combo div[data-combo-value]",s).addClass("soft-hidden"),$('#form-embed-toggle-combo div[data-combo-value="'+t+'"]',s).removeClass("soft-hidden")),$.each(e,function(e,t){if(void 0!==t){var o="id_encoded"in t?t:t.image;if(!o.medium){o.medium={};for(var i=["filename","name","width","height","extension","size","size_formatted","url"],n=0;n<i.length;n++)o.medium[i[n]]=o[i[n]]}var a=Object.flatten(o);$.each(CHV.obj.embed_tpl,function(e,t){$.each(t.options,function(e,t){var o,e=$("textarea[name="+e+"]",s),i=t.template;for(o in a)a.hasOwnProperty(o)&&(i=i.replace(new RegExp("%"+o.toUpperCase()+"%","g"),PF.fn.htmlEncode(PF.fn.htmlEncode(a[o]))));e[r](e.val()+i+("thumb"==e.data("size")?" ":"\n"))})})}}),$.each(CHV.obj.embed_tpl,function(e,i){$.each(i.options,function(e,t){var o,e=$("textarea[name="+e+"]",s);void 0!==i.backlink?(o=i.backlink,void 0!==CHV.obj.config.location?-1!==window.name.indexOf("imgbb_")&&(o=o.replace(new RegExp(" ","g"),"`")):"thumb"==e.data("size")&&(o=""),e[r]($.trim(e.val())+o)):e[r]($.trim(e.val()))})})},CHV.fn.resource_privacy_toggle=function(e){e=(CHV.obj.resource.privacy=e)||"public",$("[data-content=privacy-private]").hide(),"public"!==e&&$("[data-content=privacy-private]").show()},CHV.fn.submit_create_album=function(){var e=$(PF.obj.modal.selectors.root);return""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):(PF.obj.modal.form_data={action:"create-album",type:"album",album:{parent_id:$("[name=form-album-parent-id]",e).val(),name:$("[name=form-album-name]",e).val(),description:$("[name=form-album-description]",e).val(),privacy:$("[name=form-privacy]",e).val(),password:"password"==$("[name=form-privacy]",e).val()?$("[name=form-album-password]",e).val():null,new:!0}},!0)},CHV.fn.complete_create_album={success:function(e){e=e.responseJSON.album;window.location=e.url},error:function(e){e=e.responseJSON;PF.fn.growl.call(PF.fn._s(e.error.message))}},CHV.fn.submit_upload_edit=function(){var e=$(PF.obj.modal.selectors.root),t=!1;return $("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):($("[data-content=form-new-album]",e).is(":visible")&&(t=!0),PF.obj.modal.form_data={action:t?"create-album":"move",type:"images",album:{ids:$.map(CHV.fn.uploader.results.success,function(e){return e.image.id_encoded}),new:t}},t?(PF.obj.modal.form_data.album.name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.album.description=$("[name=form-album-description]",e).val(),PF.obj.modal.form_data.album.privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.album.privacy&&(PF.obj.modal.form_data.album.password=$("[name=form-album-password]",e).val())):PF.obj.modal.form_data.album.id=$("[name=form-album-id]",e).val(),!0)},CHV.fn.complete_upload_edit={success:function(e){e=e.responseJSON.album;window.location=e.url},error:function(e){e=e.responseJSON;PF.fn.growl.call(PF.fn._s(e.error.message))}},CHV.fn.before_image_edit=function(){var e=$("[data-ajax-deferred='CHV.fn.complete_image_edit']");$("[data-content=form-new-album]",e).hide(),$("#move-existing-album",e).show()},CHV.fn.submit_image_edit=function(){var e=$(PF.obj.modal.selectors.root),t=!1;return $("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):($("[data-content=form-new-album]",e).is(":visible")&&(t=!0),PF.obj.modal.form_data={action:"edit",edit:"image",editing:{id:CHV.obj.resource.id,title:$("[name=form-image-title]",e).val()||null,description:$("[name=form-image-description]",e).val()||null,new_album:t}},t?(PF.obj.modal.form_data.editing.album_privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.album_privacy&&(PF.obj.modal.form_data.editing.album_password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.editing.album_name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.album_description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.editing.album_id=$("[name=form-album-id]",e).val(),!0)},CHV.fn.complete_image_edit={success:function(e){var i=e.responseJSON.image,o=(i.album.id_encoded||(i.album.id_encoded=""),CHV.obj.image_viewer.album.id_encoded!==i.album.id_encoded&&(CHV.obj.image_viewer.album.id_encoded=i.album.id_encoded,e={html:i.album.slice&&i.album.slice.html?i.album.slice.html:null,prev:i.album.slice&&i.album.slice.prev?i.album.slice.prev:null,next:i.album.slice&&i.album.slice.next?i.album.slice.next:null},$("[data-content=album-slice]").html(e.html),$("[data-content=album-panel-title]")[e.html?"show":"hide"](),$("a[data-action=prev]").attr("href",e.prev),$("a[data-action=next]").attr("href",e.next),$("a[data-action]",".image-viewer-navigation").each(function(){$(this)[void 0===$(this).attr("href")?"addClass":"removeClass"]("hidden")})),CHV.fn.resource_privacy_toggle(i.album.privacy),$.each(["description","title"],function(e,t){var o=$("[data-text=image-"+t+"]");o.html(PF.fn.nl2br(PF.fn.htmlEncode(i[t]))),""!==o.html()&&o.show()}),CHV.fn.common.updateDoctitle(i.title),PF.fn.growl.expirable(PF.fn._s("Image edited successfully.")),CHV.fn.list_editor.addAlbumtoModals(i.album),$("[data-submit-fn='CHV.fn.submit_image_edit']"));$.each(["description","name","password"],function(e,t){t=$("[name=form-album-"+t+"]",o);t.is("textarea")?t.val("").html(""):t.val("").attr("value","")}),$("[name=form-privacy] option",o).each(function(){$(this).removeAttr("selected")}),$("[data-combo-value=password]",o).hide(),$("[name=form-album-id]",o).find("option").removeAttr("selected"),$("[name=form-album-id]",o).find('[value="'+i.album.id_encoded+'"]').attr("selected",!0)}},CHV.fn.before_album_edit=function(e){$("[data-action=album-switch]","[data-before-fn='CHV.fn.before_album_edit']").remove()},CHV.fn.submit_album_edit=function(){var e=$(PF.obj.modal.selectors.root);return $("[name=form-album-name]",e).val()?(PF.obj.modal.form_data={action:"edit",edit:"album",editing:{id:CHV.obj.resource.id,name:$("[name=form-album-name]",e).val(),privacy:$("[name=form-privacy]",e).val(),description:$("[name=form-album-description]",e).val()}},"password"==PF.obj.modal.form_data.editing.privacy&&(PF.obj.modal.form_data.editing.password=$("[name=form-album-password]",e).val()),!0):(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1)},CHV.fn.complete_album_edit={success:function(e){var t=e.responseJSON.album,o=($("[data-text=album-name]").html(PF.fn.htmlEncode(t.name)),$("[data-text=album-description]").html(PF.fn.htmlEncode(t.description)),CHV.fn.resource_privacy_toggle(t.privacy),CHV.obj.resource.type);CHV.obj.resource.type=null,CHV.fn.list_editor.updateItem($(PF.obj.listing.selectors.list_item,PF.obj.listing.selectors.content_listing_visible),e.responseJSON),CHV.obj.resource.type=o,$("[data-modal]").each(function(){$('option[value="'+t.id_encoded+'"]',this).text(t.name+("public"!==t.privacy?" ("+PF.fn._s("private")+")":""))}),CHV.fn.common.updateDoctitle(t.name),PF.fn.growl.expirable(PF.fn._s("Album edited successfully."))}},CHV.fn.common={validateForm:function(e){void 0===e&&(e=PF.obj.modal.selectors.root);var o=!0;return $.each($(":input:visible",e),function(e,t){""==$(this).val()&&$(this).attr("required")&&($(this).highlight(),o=!1)}),!!o||(PF.fn.growl.call(PF.fn._s("Please fill all the required fields.")),!1)},updateDoctitle:function(e){void 0!==CHV.obj.page_info&&(CHV.obj.page_info.pre_doctitle=e,CHV.obj.page_info.doctitle=CHV.obj.page_info.pre_doctitle+CHV.obj.page_info.pos_doctitle,document.title=CHV.obj.page_info.doctitle)}},CHV.fn.submit_resource_delete=function(){return PF.obj.modal.form_data={action:"delete",delete:CHV.obj.resource.type,from:"resource",owner:void 0!==CHV.obj.resource.user?CHV.obj.resource.user.id:null,deleting:CHV.obj.resource},!0},CHV.fn.complete_resource_delete={success:function(e){e.responseJSON;$("body").fadeOut("normal",function(){var e="album"==CHV.obj.resource.type||"image"==CHV.obj.resource.type?CHV.obj.resource.parent_url:(CHV.obj.resource.user||CHV.obj.resource).url;void 0!==e&&(window.location=e+"?deleted")})}},CHV.fn.list_editor={blink:function(e){e.addClass("ui-selecting"),setTimeout(function(){e.removeClass("ui-selecting")},200)},selectionCount:function(){$(PF.obj.listing.selectors.content_listing).each(function(){var e=$("[data-content=pop-selection]","[data-content=list-selection][data-tab="+$(this).attr("id")+"]"),t=$(PF.obj.listing.selectors.list_item+".selected",this).length;all_count=$(PF.obj.listing.selectors.list_item,this).length,e[0<t?"removeClass":"addClass"]("disabled"),$("[data-text=selection-count]",e).text(0<t?t:""),$(this).is(":visible")&&CHV.fn.list_editor.listMassActionSet(all_count==t?"clear":"select")})},removeFromList:function(i,n){var a,s,e,r;void 0!==i&&(i=i instanceof jQuery==0?$(i):i,a=$(PF.obj.listing.selectors.content_listing_visible),s=i.length,i.fadeOut("fast"),e=i.first().data("type"),r=parseInt($("[data-text="+e+"-count]").text())-s,CHV.fn.list_editor.updateUserCounters(i.first().data("type"),s,"-"),i.promise().done(function(){$("body").removeClass(CHV.fn.listingViewer.selectors.bodyShown.substr(1));var e,t,o={};i.each(function(){$("[data-id="+$(this).data("id")+"]").each(function(){var e=$(this).closest(PF.obj.listing.selectors.content_listing).attr("id");o[e]||(o[e]=0),o[e]+=1})}),1==s?$("[data-id="+$(this).data("id")+"]").remove():i.each(function(){$("[data-id="+$(this).data("id")+"]").remove()}),PF.fn.listing.columnizerQueue(),PF.fn.listing.refresh(),CHV.fn.list_editor.selectionCount(),void 0!==n&&"string"==typeof n&&PF.fn.growl.expirable(n),0==(r=$(PF.obj.listing.selectors.content_listing_pagination,a).exists()||0!=$(PF.obj.listing.selectors.list_item,a).length?r:0)?(a.html(PF.obj.listing.template.empty),$(PF.obj.listing.selectors.content_listing+":not("+PF.obj.listing.selectors.content_listing_visible+")").data({empty:null,load:"ajax"}),$("[data-content=list-selection][data-tab="+a.attr("id")+"]").addClass("disabled")):0==$(PF.obj.listing.selectors.list_item,a).length&&($(PF.obj.listing.selectors.pad_content).height(0),$("[data-action=load-more]",a).exists()?($(PF.obj.listing.selectors.content_listing_visible).data("page",0),$("[data-action=load-more]",a).click(),PF.obj.listing.recolumnize=!0):(e=$("[data-pagination=next]",a)).exists()&&(e=e.attr("href"),"page"in(t=PF.fn.deparam(e))&&1<t.page&&(e=e.changeURLParameterValue("page",t.page-1)),window.location=e))}))},deleteFromList:function(e){void 0===t&&(t=!0);var t,e=e instanceof jQuery==0?$(e):e;this.removeFromList(e,t?PF.fn._s("The content has been deleted."):null)},moveFromList:function(e,t){void 0===t&&(t=!0),e=e instanceof jQuery==0?$(e):e;this.removeFromList(e,t?PF.fn._s("The content has been moved."):null)},toggleSelectItem:function(e,t){"boolean"!=typeof t&&(t=!e.hasClass("selected"));var o,i,e=$(".viewer").is(":visible")?$("[data-type=image][data-id="+e.attr("data-id")+"]"):e,n=$("[data-action=select] .btn-icon",e),t=t?(e.addClass("selected"),o=n.data("icon-selected"),i=n.data("icon-unselected"),PF.fn._s("Unselect")):(e.removeClass("selected"),o=n.data("icon-unselected"),i=n.data("icon-selected"),PF.fn._s("Select"));n.removeClass(i).addClass(o),$("[data-action=select] .label",e).text(t),CHV.fn.list_editor.selectionCount()},selectItem:function(e){this.toggleSelectItem(e,!0)},unselectItem:function(e){this.toggleSelectItem(e,!1)},clearSelection:function(e){e=$(PF.obj.listing.selectors.list_item+".selected",PF.obj.listing.selectors[e?"content_listing":"content_listing_visible"]);this.unselectItem(e),this.listMassActionSet("select")},listMassActionSet:function(e){var t=$("[data-action=list-"+("select"==e?"clear":"select")+"-all]:visible"),o=t.data("text-"+e+"-all");t.text(o).attr("data-action","list-"+e+"-all")},updateItem:function(e,t,o,i){var n=(e=e instanceof jQuery==0?$(e):e).data("type"),a="image"==n?t.album:t;this.addAlbumtoModals(a),$('option[value="'+a.id_encoded+'"]',"[name=form-album-id]").html(PF.fn.htmlEncode(a.name_with_privacy_readable_html)),"edit"!=(o=void 0===o?"edit":o)&&"move"!=o||("move"==o&&"album"==CHV.obj.resource.type?CHV.fn.list_editor.moveFromList(e,i):(e.attr("data-description",t.description),"image"==n?(void 0!==t.title&&(e.attr("data-title",t.title),e.find("[title]").attr("title",t.title),$("[data-text=image-title]",e).text(PF.fn.htmlEncode(t.title))),void 0!==t.title_truncated&&$("[data-text=image-title-truncated]",e).html(PF.fn.htmlEncode(t.title_truncated)),e.attr({"data-album-id":a.id_encoded}),$("[data-content=album-link]",e).attr("href",a.url)):e.attr({"data-privacy":a.privacy,"data-password":a.password,"data-name":a.name}),e.attr("data-privacy",a.privacy),$("[data-text=album-name]",e).html(PF.fn.htmlEncode(a.name)),PF.fn.growl.expirable("edit"==o?PF.fn._s("The content has been edited."):PF.fn._s("The content has been moved."))))},addAlbumtoModals:function(e){var t=!1;$("[name=form-album-id]","[data-modal]").each(function(){e.id_encoded&&!$('option[value="'+e.id_encoded+'"]',this).exists()&&($(this).append('<option value="'+e.id_encoded+'">'+e.name_with_privacy_readable_html+"</option>"),t=!0)}),t&&CHV.fn.list_editor.updateUserCounters("album",1,"+")},updateAlbum:function(e){$("[data-id="+e.id_encoded+"]").each(function(){""!==e.html&&($(this).after(e.html),$(this).remove())})},updateUserCounters:function(e,t,o){void 0===o&&(o="+");var i,n=$("[data-text="+e+"-count]"),e=$("[data-text="+e+"-label]"),t=parseInt(t),a=parseInt(n.html());switch(o){case"+":i=a+t;break;case"-":i=a-t;break;case"=":i=t}var o=i-a,s=$("[data-text=total-"+n.data("text")+"]"),r=$("[data-text="+s.data("text")+"-label]"),o=parseInt(s.html())+o;n.text(i),s.text(o),e.text(e.data(1==i?"label-single":"label-plural")),r.text(e.data(1==o?"label-single":"label-plural"))},updateMoveItemLists:function(o,e,t){var i;CHV.fn.list_editor.clearSelection(),/image/.test(e)?"image"==e?CHV.fn.list_editor.updateItem("[data-type=image][data-id="+t.data("id")+"]",o.image,"move"):(t.each(function(){CHV.fn.list_editor.updateItem("[data-type=image][data-id="+$(this).data("id")+"]",o,"move",!1)}),PF.fn.growl.expirable(PF.fn._s("The content has been moved."))):(CHV.fn.list_editor.moveFromList(t,!1),PF.fn.growl.expirable(PF.fn._s("The content has been moved.")),o.album&&((void 0!==o.albums_old?"true"==o.request.album.new:"true"==o.request.editing.new_album)?(CHV.fn.list_editor.addAlbumtoModals(o.album),i=parseInt($("[data-text=album-count]").text())-1,$(PF.obj.listing.selectors.pad_content).each(function(){var e,t=$(this).find(PF.obj.listing.selectors.list_item).length;0==t||"date_desc"!=(e=PF.fn.deparam($(this).closest(PF.obj.listing.selectors.content_listing).data("params"))).sort&&i!=t||$(this)["date_desc"==e.sort?"prepend":"append"](o.album.html)})):CHV.fn.list_editor.updateAlbum(o.album)),PF.fn.listing.columnizerQueue(),PF.fn.listing.refresh(0))}};