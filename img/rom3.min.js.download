"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,p,i=[],s=!0,d=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);s=!0);}catch(e){d=!0,o=e}finally{try{if(!s&&null!=n.return&&(p=n.return(),Object(p)!==p))return}finally{if(d)throw o}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}!function(l){var e,c="https://devnull.perfops.net",n="https://rum-cdn.perfops.net/providers",r=3e5,p=3,i="test.resolver.perfops.net",s=3e5,o=2e4,d=6e4,a=3,u=15,h=6e4,f=3,b="desktop",m=Date.now(),g=E(16),t=3e3,j=[137],v=-1!==function(){}.toString().indexOf("minified")?{logInfo:console.log,logError:console.error}:{logInfo:function(){},logError:function(){}},w=v.logInfo,U=v.logError,y=window.rum?window.rum.key:void 0;function x(e,t,n){b=n,f=Math.min(Math.max(function(e,t){return void 0!==window.rum&&void 0!==window.rum.config&&window.rum.config[t].repeats||e}(e,n),a),u),h=Math.min(Math.max(function(e,t){return void 0!==window.rum&&void 0!==window.rum.config&&window.rum.config[t].interval||e}(t,n),o),d)}function k(e){return Math.max(0,Number(e.toFixed(2)))}function S(n,e){var t=1<arguments.length&&void 0!==e?e:{},r=t.cb,c=void 0===r?function(){}:r,p=t.data,o=t.method,i=void 0===o?"GET":o,s=t.timeout,d=void 0===s?3e3:s,a=t.headers,u=void 0===a?{}:a;return new l(function(e,t){var o=new XMLHttpRequest;o.onload=function(){return e(o)},o.ontimeout=function(){t("timeout")},o.onerror=function(){var e="Unknown error happen when fetching ".concat(n);0!==o.status&&(e="Error happen when fetching ".concat(n,". Status ").concat(o.status,". Response: ").concat(o.statusText)),t(new Error(e))},o.open(i,n),u&&Object.entries(u).forEach(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];o.setRequestHeader(n,r)}),o.timeout=d,c(o),o.send(p)})}function A(e){return j.includes(e.id)?h:t}function E(e){for(var t="abcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++){var o=Math.floor(Math.random()*t.length);n+=t.charAt(o)}return n}function T(e){var t=e.interval?1e3*parseInt(e.interval):h;x(e.repeats?parseInt(e.repeats):f,t,e.mobile?"mobile":"desktop")}function q(){var e=0,t=function(){(function(){var r="perfops-rum-clientdns",e=JSON.parse(window.localStorage.getItem(r));if(e&&e.expiry>Date.now())return l.resolve(e.data);for(var o=[],t=0;t<p;t++){var n="https://"+E(16)+"."+i;o.push(S(n))}return new l(function(t,n){l.all(o).then(function(e){var n=[];e.forEach(function(e){var t=JSON.parse(e.response);n.includes(t.resolver)||null===t.resolver||n.push(t.resolver)}),window.localStorage.setItem(r,JSON.stringify({data:n,expiry:Date.now()+s})),t(n)}).catch(function(e){n(e)})})})().then(function(o){(function(){var t="perfops-rum-resources",e=JSON.parse(window.localStorage.getItem(t));return e&&e.expiry>Date.now()?(e.config&&T(e.config),l.resolve(e.data)):S(n,{headers:{"X-Partner-Id":y||"perfops","X-Partner-Hostname":window.location.hostname||"unknown"}}).then(function(e){return JSON.parse(e.response)}).then(function(e){if(!e||!e.data)throw new Error("Empty response.data");return window.localStorage.setItem(t,JSON.stringify({data:e.data,config:e.config,expiry:Date.now()+r})),e.config&&T(e.config),e.data}).catch(function(){return[{id:2,cdnUrl:"https://ovh-cdn.perfops.io/500b-bench.jpg",p:0},{id:140,cdnUrl:"https://afdcdnperf-e8aeffg7frd0a3c0.z01.azurefd.net/500b-bench.jpg",p:0},{id:145,cdnUrl:"https://googlecdn.org/500b-google-bench.jpg",p:0},{id:148,cdnUrl:"https://eo-perfops12.qcloudteo.com/500b-bench.jpg",p:0},{id:110,cdnUrl:"https://test-perfops.wedos.delivery/500b-bench.jpg",p:0},{id:118,cdnUrl:"https://eo-perfops2.qcloudteo.com/500b-bench.jpg",p:0},{id:92,cdnUrl:"https://perfops.byte-test.com/500b-bench.jpg",p:1},{id:136,cdnUrl:"https://perfops.edge.run/500b-bench.jpg",p:0},{id:120,cdnUrl:"https://eo-perfops4.qcloudteo.com/500b-bench.jpg",p:0},{id:129,cdnUrl:"https://eo-perfops8.qcloudteo.com/500b-bench.jpg",p:0},{id:147,cdnUrl:"https://eo-perfops11.qcloudteo.com/500b-bench.jpg",p:0},{id:105,cdnUrl:"https://akamai-cdn.perfops.io/500b-bench.jpg",p:0},{id:117,cdnUrl:"https://eo-perfops1.qcloudteo.com/500b-bench.jpg",p:0},{id:149,cdnUrl:"https://perfopsamd.akamaized.net/500b-bench.jpg",p:0},{id:123,cdnUrl:"https://cdnperf.vergecloud.com/500b-bench.jpg",p:1},{id:146,cdnUrl:"https://rum-cust.perfops.cdb.cdn.orange.com/500b-bench.jpg",p:0},{id:7,cdnUrl:"https://cpt96125.shopvoxpopulus.com/pics/500b-bench.jpg",p:1},{id:142,cdnUrl:"https://perfops1.byteperf.com/500b-bench.jpg",p:0},{id:143,cdnUrl:"https://perfops2.byteperf.com/500b-bench.jpg",p:0},{id:126,cdnUrl:"https://eo-perfops5.qcloudteo.com/500b-bench.jpg",p:0},{id:12,cdnUrl:"https://cdn.jsdelivr.net/gh/jimaek/js-test@1.1/500b-bench.jpg",p:1},{id:128,cdnUrl:"https://eo-perfops7.qcloudteo.com/500b-bench.jpg",p:0},{id:134,cdnUrl:"https://perfopsrumapi.akamaized.net/500b-bench.jpg",p:0},{id:130,cdnUrl:"https://eo-perfops9.qcloudteo.com/500b-bench.jpg",p:0},{id:139,cdnUrl:"https://perfops-bench.sos-ch-gva-2.exoscale-cdn.com/500b-bench.jpg",p:1},{id:72,cdnUrl:"https://rum-mkt.perfops.cdb.cdn.orange.com/500b-bench.jpg",p:0},{id:137,cdnUrl:"https://d161f70cbh7kx6.cloudfront.net/500b-bench.jpg",p:0},{id:106,cdnUrl:"https://djlzvy5xcvhxt.cloudfront.net/500b-bench.jpg",p:1},{id:9,cdnUrl:"https://1596384882.rsc.cdn77.org/500b-bench.jpg",p:1},{id:131,cdnUrl:"https://eo-static-perfops2.qcloudcdn.com/500b-bench.jpg",p:0},{id:97,cdnUrl:"https://medianova-cdnvperf.mncdn.com/500b-bench.jpg",p:0},{id:101,cdnUrl:"https://eo-static-perfops.qcloudcdn.com/500b-bench.jpg",p:0},{id:4,cdnUrl:"https://perfops-static.freetls.fastly.net/500b-bench.jpg",p:1},{id:3,cdnUrl:"https://perfops.cloudflareperf.com/500b-cf-bench.jpg",p:1},{id:15,cdnUrl:"https://cdnperf-rum.cdnetworks.net/500b-bench.jpg",p:1},{id:144,cdnUrl:"https://perfops3.byteperf.com/500b-bench.jpg",p:0},{id:138,cdnUrl:"https://cdn.perftest.f5-cloud-demo.com/500b-bench.jpg",p:0},{id:141,cdnUrl:"https://perfops3.byte-test.com/500b-bench.jpg",p:0},{id:108,cdnUrl:"https://perf-test.sufycdn.com/500b-bench.jpg",p:1},{id:85,cdnUrl:"https://proxy.canary.scrubbingcenter.com/test_image.png",p:0},{id:104,cdnUrl:"https://25748s.ha.azioncdn.net/500b-bench.jpg",p:0},{id:133,cdnUrl:"https://eo-perfops10.qcloudteo.com/500b-bench.jpg",p:0},{id:84,cdnUrl:"https://ultrawaf.canary.scrubbingcenter.com/test_image.png",p:0},{id:83,cdnUrl:"https://medianova-cdnperf.mncdn.com/500b-bench.jpg",p:1},{id:35,cdnUrl:"https://test-perfops.blazingcdn.com/500b-bench.jpg",p:1},{id:40,cdnUrl:"https://perfops.swiftycdn.net/500b-sw-bench.jpg",p:0},{id:109,cdnUrl:"https://cdn23602612.ahacdn.me/500b-bench.jpg",p:1},{id:132,cdnUrl:"https://eo-static-perfops3.qcloudcdn.com/500b-bench.jpg",p:0},{id:10,cdnUrl:"https://perfopsrum.akamaized.net/500b-bench.jpg",p:1},{id:94,cdnUrl:"https://rum.perfops.cdb.cdn.orange.com/500b-bench.jpg",p:0},{id:121,cdnUrl:"https://eo-static-perfops1.qcloudcdn.com/500b-bench.jpg",p:0},{id:8,cdnUrl:"https://perfops.gcorelabs.com/500b-bench.jpg",p:1},{id:98,cdnUrl:"https://perfops2.byte-test.com/500b-bench.jpg",p:0},{id:119,cdnUrl:"https://eo-perfops3.qcloudteo.com/500b-bench.jpg",p:0},{id:11,cdnUrl:"https://perfops1.b-cdn.net/500b-bunny-bench.jpg",p:1},{id:74,cdnUrl:"https://test-perfops.haproxy.com/500b-bench.jpg",p:0},{id:87,cdnUrl:"https://test-perfops.ldgslb.com/500b-bench.jpg",p:1},{id:127,cdnUrl:"https://eo-perfops6.qcloudteo.com/500b-bench.jpg",p:0},{id:5,cdnUrl:"https://d3888oxgux3fey.cloudfront.net/500b-bench.jpg",p:1},{id:102,cdnUrl:"https://perf.qinglanbaseunicast.com/500b-bench.jpg",p:0},{id:114,cdnUrl:"https://perfopsrum-eip.akamaized.net/500b-bench.jpg",p:0},{id:20,cdnUrl:"https://cdnperf.cachefly.net/500b-bench.jpg",p:1}]})})().then(function(e){var t={ua:navigator.userAgent,hostname:window.location.hostname,client:y,clientdns:o,platform:b,timeElapsed:0,sessionId:"",version:8},n=[];performance.clearResourceTimings();function r(){var e=n.splice(0,n.length);return function(e){var t=0;return e.forEach(function(e){e.up||t++}),t<e.length}(e)?function(e,t){return e.timeElapsed=Math.round((Date.now()-m)/1e3),e.sessionId=g,S("".concat(c,"/rum/v1"),{data:JSON.stringify({metadata:e,data:t}),method:"POST"}).catch(U)}(t,e):e}return function(e,r){return e.reduce(function(e,n){return e.then(function(t){return r(n).then(function(e){return t.push(e),t})})},l.resolve([]))}(e,function(t){return function(e){var c="".concat(e.cdnUrl,"?t=").concat(Date.now()),t=new URL(c).hostname,p={id:e.id,domain:t,online:navigator&&void 0!==navigator.onLine?Number(navigator.onLine):-1};return S(c,{timeout:A(e)}).then(function(e){var t=performance.getEntriesByName(c)[0],n=k(t.domainLookupEnd-t.domainLookupStart),r=k(t.connectEnd-t.connectStart),o=0<r?k(t.connectEnd-t.secureConnectionStart):0;return 200<=e.status&&e.status<300&&(p=Object.assign({},p,{up:1,status:e.status,time:Number((t.responseEnd-t.requestStart).toFixed(2)),dnsLookupTime:n,tcpTime:r,sslTime:o,headers:e.getAllResponseHeaders(),httpVersion:t.nextHopProtocol})),300<=e.status&&e.status<=500&&(p=Object.assign({},p,{up:0,status:e.status,dnsLookupTime:n,tcpTime:r,sslTime:o,headers:e.getAllResponseHeaders(),httpVersion:t.nextHopProtocol})),p}).catch(function(){return Object.assign({},p,{up:0,status:0})})}(t).then(function(e){return function(e,t){return!(e.time<3||e.time>A(t))&&(2<=n.push(e)?r():void 0)}(e,t)})}).then(r)}).then(w,U).then(function(){(e+=1)<f&&setTimeout(t,h)})})};setTimeout(t,3e3)}x(h,f,"desktop"),e=function(){var e=["bot","headless","google","baidu","bing","msn","duckduckbot","teoma","slurp","yandex","phantomjs","pingdom","ahrefsbot"].join("|");if(new RegExp(e,"i").test(window.navigator.userAgent))console.warn("PerfOps RUM not launching due to suspicious userAgent:",window.navigator.userAgent);else if(void 0!==window.performance){if(performance.onresourcetimingbufferfull=function(){w("clear performance resource buffer"),performance.clearResourceTimings()},"function"==typeof l)return q();!function(e,t){var n=document.createElement("script"),r=!1;n.onreadystatechange=n.onload=function(){r||t(),r=!0},n.setAttribute("src",e),document.body.appendChild(n)}("https://cdn.perfops.net/npm/es6-promise-4.2.4/dist/es6-promise.min.js",function(){l=window.ES6Promise,q()})}},"complete"===document.readyState?e():window.addEventListener("load",e)}(window.Promise);